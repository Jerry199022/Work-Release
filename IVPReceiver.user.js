// ==UserScript==
// @name         通用接收器
// @namespace    Universal Receiver
// @version      V21
// @description  同時支持 IVP 內部系統與 UPS 官網的自動查詢接收器。修復後台UPS官網因自身腳本崩潰導致按鈕無法點擊的問題(V21: 強制解鎖模式)。
// @author       Jerry Law
// @match        https://ivp.inside.ups.com/internal-visibility-portal*
// @match        https://www.ups.com/track*
// @grant        none
// @run-at       document-idle
// @updateURL    https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// @downloadURL  https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// ==/UserScript==

function _0x4b0d(_0x264608,_0x2e6a94){const _0x448d71=_0x448d();return _0x4b0d=function(_0x4b0dfd,_0xec2345){_0x4b0dfd=_0x4b0dfd-0x1b9;let _0x50d996=_0x448d71[_0x4b0dfd];if(_0x4b0d['yhaQbT']===undefined){var _0x10fe30=function(_0x36eab4){const _0x10bc32='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x24aac2='',_0x1d5979='';for(let _0x5759d3=0x0,_0x4328c1,_0x597a5d,_0x45c8da=0x0;_0x597a5d=_0x36eab4['charAt'](_0x45c8da++);~_0x597a5d&&(_0x4328c1=_0x5759d3%0x4?_0x4328c1*0x40+_0x597a5d:_0x597a5d,_0x5759d3++%0x4)?_0x24aac2+=String['fromCharCode'](0xff&_0x4328c1>>(-0x2*_0x5759d3&0x6)):0x0){_0x597a5d=_0x10bc32['indexOf'](_0x597a5d);}for(let _0x1ebaba=0x0,_0x3a96a1=_0x24aac2['length'];_0x1ebaba<_0x3a96a1;_0x1ebaba++){_0x1d5979+='%'+('00'+_0x24aac2['charCodeAt'](_0x1ebaba)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x1d5979);};_0x4b0d['uyhtjC']=_0x10fe30,_0x264608=arguments,_0x4b0d['yhaQbT']=!![];}const _0x1de5ce=_0x448d71[0x0],_0x58a8b5=_0x4b0dfd+_0x1de5ce,_0x4231b5=_0x264608[_0x58a8b5];return!_0x4231b5?(_0x50d996=_0x4b0d['uyhtjC'](_0x50d996),_0x264608[_0x58a8b5]=_0x50d996):_0x50d996=_0x4231b5,_0x50d996;},_0x4b0d(_0x264608,_0x2e6a94);}(function(_0x16e719,_0xbf82b6){const _0x1f1f50={_0x34e390:0x1ef,_0x4337fe:0x1f3,_0x5dcd3a:0x1e1,_0x228ad0:0x1ff,_0x34b302:0x1be,_0x35d1dc:0x1e9,_0x4f8cf3:0x1ce,_0x2f566e:0x1e6,_0x8ccebe:0x1c2},_0x38a2a6=_0x4b0d,_0x583434=_0x16e719();while(!![]){try{const _0x4eedc5=parseInt(_0x38a2a6(_0x1f1f50._0x34e390))/0x1+-parseInt(_0x38a2a6(_0x1f1f50._0x4337fe))/0x2+parseInt(_0x38a2a6(0x1da))/0x3*(-parseInt(_0x38a2a6(_0x1f1f50._0x5dcd3a))/0x4)+parseInt(_0x38a2a6(0x1dc))/0x5*(parseInt(_0x38a2a6(0x205))/0x6)+-parseInt(_0x38a2a6(_0x1f1f50._0x228ad0))/0x7*(parseInt(_0x38a2a6(_0x1f1f50._0x34b302))/0x8)+-parseInt(_0x38a2a6(_0x1f1f50._0x35d1dc))/0x9*(-parseInt(_0x38a2a6(_0x1f1f50._0x4f8cf3))/0xa)+parseInt(_0x38a2a6(_0x1f1f50._0x2f566e))/0xb*(parseInt(_0x38a2a6(_0x1f1f50._0x8ccebe))/0xc);if(_0x4eedc5===_0xbf82b6)break;else _0x583434['push'](_0x583434['shift']());}catch(_0x2d6e6e){_0x583434['push'](_0x583434['shift']());}}}(_0x448d,0xc8d15),(function(){'use strict';const _0x3fa0e5={_0x37d4f2:0x1f8,_0x43e920:0x1df,_0x3bc705:0x1bb,_0x1f8a77:0x1c9,_0x331759:0x1eb},_0xb35ed4={_0x1b1735:0x1e2,_0x44d13f:0x1e8,_0x4d6d7c:0x204,_0x2b8a04:0x204,_0x51ff43:0x1d3},_0x924c67={_0x279d77:0x1c6,_0x40eee2:0x1ec,_0x169f9b:0x1ed},_0x471037={_0x5462d0:0x1f4,_0x1e34b9:0x1bc,_0x1f6dfa:0x1ca,_0x43e277:0x1ba,_0xb3d746:0x207,_0x16bfff:0x1f1,_0x2d55c0:0x203},_0x4dc80b={_0x42b96d:0x1d1,_0x4cfdd3:0x1fc,_0x395e41:0x206,_0xc376f0:0x1de,_0xb6375f:0x1cb,_0x571d89:0x1b9},_0x920094={_0x1eb6a4:0x1ed,_0x1a5473:0x1f9,_0x46e32d:0x1fa,_0x16b65a:0x1db},_0x58b9d2={_0x41355a:0x1cd,_0x4b1e95:0x1cd,_0x11b1f5:0x1d9,_0x3e44d6:0x1c1,_0x4bb868:0x1cf,_0x4324b0:0x1d2,_0x5232c8:0x1d6,_0x37a0d5:0x1c1},_0x5c1ea6=_0x4b0d;const _0x36eab4=window[_0x5c1ea6(_0x3fa0e5._0x37d4f2)][_0x5c1ea6(0x1c0)],_0x10bc32=_0x36eab4['includes'](_0x5c1ea6(_0x3fa0e5._0x43e920)),_0x24aac2=_0x36eab4[_0x5c1ea6(_0x3fa0e5._0x3bc705)](_0x5c1ea6(_0x3fa0e5._0x1f8a77)),_0x1d5979='https://upsdrive.lightning.force.com';console[_0x5c1ea6(0x1f4)]('[Universal\x20Receiver\x20V21]\x20啟動於:\x20'+_0x36eab4+'\x20(強制解鎖模式)');let _0x5759d3=0x0;const _0x4328c1=_0x22de0d=>new Promise(_0x5735bd=>setTimeout(_0x5735bd,_0x22de0d));function _0x597a5d(_0x474d4e,_0x533a1e=document[_0x5c1ea6(0x1f1)],_0x1a3546=0x1388){const _0x21ca74={_0x46e22:0x1f7,_0xd80fcb:0x1e5};return new Promise((_0x387d53,_0x1019b9)=>{const _0x43e27c={_0x5c50de:0x1fd,_0x50b22a:0x1f2},_0x3b12b5={_0x3bbfa6:0x1fd},_0x1b238d=_0x4b0d,_0x1092a8=_0x533a1e[_0x1b238d(_0x21ca74._0x46e22)](_0x474d4e);if(_0x1092a8)return _0x387d53(_0x1092a8);const _0x3e85f8=new MutationObserver(()=>{const _0x169b43=_0x1b238d,_0x1f9b9e=_0x533a1e[_0x169b43(0x1f7)](_0x474d4e);_0x1f9b9e&&(_0x3e85f8[_0x169b43(_0x3b12b5._0x3bbfa6)](),_0x387d53(_0x1f9b9e));});_0x3e85f8[_0x1b238d(_0x21ca74._0xd80fcb)](_0x533a1e,{'childList':!![],'subtree':!![]}),setTimeout(()=>{const _0x16c989=_0x1b238d;_0x3e85f8[_0x16c989(_0x43e27c._0x5c50de)](),_0x1019b9(new Error(_0x16c989(_0x43e27c._0x50b22a)+_0x474d4e+_0x16c989(0x1e4)));},_0x1a3546);});}function _0x45c8da(_0x3a0439,_0x27a57d){const _0x23fdc7=_0x5c1ea6;if(!_0x3a0439)return;const _0x30d234=document['hidden'];if(!_0x30d234)try{_0x3a0439[_0x23fdc7(0x1fb)]();}catch(_0x414a68){}try{const _0x58c4a2=Object['getOwnPropertyDescriptor'](window[_0x23fdc7(0x1e7)][_0x23fdc7(0x1ee)],_0x23fdc7(_0x58b9d2._0x41355a))[_0x23fdc7(0x1d4)];_0x58c4a2[_0x23fdc7(0x1ea)](_0x3a0439,_0x27a57d);}catch(_0x3ac26f){_0x3a0439[_0x23fdc7(_0x58b9d2._0x4b1e95)]=_0x27a57d;}if(_0x3a0439[_0x23fdc7(0x1cd)]!==_0x27a57d)_0x3a0439['value']=_0x27a57d;if(_0x30d234)_0x3a0439[_0x23fdc7(0x1f6)](new Event('input',{'bubbles':!![]})),_0x3a0439[_0x23fdc7(0x1f6)](new Event(_0x23fdc7(0x1bf),{'bubbles':!![]})),_0x3a0439['dispatchEvent'](new Event(_0x23fdc7(0x1c3),{'bubbles':!![]}));else{const _0x6712d3=[new KeyboardEvent(_0x23fdc7(_0x58b9d2._0x11b1f5),{'bubbles':!![],'key':_0x23fdc7(_0x58b9d2._0x3e44d6)}),new KeyboardEvent(_0x23fdc7(_0x58b9d2._0x4bb868),{'bubbles':!![],'key':_0x23fdc7(0x1c1)}),new Event(_0x23fdc7(_0x58b9d2._0x4324b0),{'bubbles':!![]}),new Event(_0x23fdc7(0x1bf),{'bubbles':!![]}),new KeyboardEvent(_0x23fdc7(_0x58b9d2._0x5232c8),{'bubbles':!![],'key':_0x23fdc7(_0x58b9d2._0x37a0d5)}),new Event(_0x23fdc7(0x1c3),{'bubbles':!![]})];_0x6712d3[_0x23fdc7(0x1d7)](_0x2b11a6=>_0x3a0439[_0x23fdc7(0x1f6)](_0x2b11a6));}}function _0x1ebaba(_0xe5c75){const _0x2ec0c8=_0x5c1ea6;if(!_0xe5c75)return;_0xe5c75[_0x2ec0c8(0x1f5)](_0x2ec0c8(_0x920094._0x1eb6a4)),_0xe5c75[_0x2ec0c8(_0x920094._0x1a5473)][_0x2ec0c8(_0x920094._0x46e32d)]('disabled'),_0xe5c75[_0x2ec0c8(0x1f0)](_0x2ec0c8(0x1e0),'false'),_0xe5c75[_0x2ec0c8(_0x920094._0x16b65a)]['border']='2px\x20solid\x20red',_0xe5c75['click']();}function _0x3a96a1(){const _0x59dcb5=_0x5c1ea6;try{const _0x2ef861=new Blob(['setInterval(()\x20=>\x20self.postMessage(\x27tick\x27),\x20250);'],{'type':'application/javascript'}),_0x415514=new Worker(URL['createObjectURL'](_0x2ef861));_0x415514[_0x59dcb5(0x1d0)]=()=>{};}catch(_0x3d5153){console['error'](_0x59dcb5(0x1c4),_0x3d5153);}}function _0x1b91dd(_0x9516c8){const _0x14fa45=_0x5c1ea6;if(!_0x9516c8)return![];let _0x9d48ec=null;if(_0x10bc32)_0x9d48ec=document[_0x14fa45(0x1f7)](_0x14fa45(_0x4dc80b._0x42b96d));else{if(_0x24aac2)_0x9d48ec=document[_0x14fa45(_0x4dc80b._0x4cfdd3)](_0x14fa45(_0x4dc80b._0x395e41));}if(_0x9d48ec){const _0x33f832=_0x9d48ec[_0x14fa45(_0x4dc80b._0xc376f0)][_0x14fa45(0x1c5)]()[_0x14fa45(_0x4dc80b._0xb6375f)](/\s/g,''),_0x29d148=_0x9516c8[_0x14fa45(_0x4dc80b._0xb6375f)](/\s/g,'');if(_0x33f832[_0x14fa45(_0x4dc80b._0x571d89)]()===_0x29d148[_0x14fa45(0x1b9)]())return!![];}return![];}async function _0x1bd1fd(_0x467d5d){const _0x4b6ed6=_0x5c1ea6;console[_0x4b6ed6(_0x471037._0x5462d0)]('[UPS\x20Web]\x20執行查詢:\x20'+_0x467d5d+'\x20(Hidden:\x20'+document['hidden']+')');const _0x8ef4b6=[{'name':_0x4b6ed6(0x1d8),'inputId':_0x4b6ed6(0x1dd),'btnId':'stApp_trackAgain_getTrack'},{'name':_0x4b6ed6(_0x471037._0x1e34b9),'inputId':'stApp_trackingNumber','btnId':_0x4b6ed6(0x202)}];try{const _0x5d779f=document['querySelector'](_0x4b6ed6(_0x471037._0x1f6dfa));_0x5d779f&&(_0x5d779f['click'](),await _0x4328c1(0x12c));let _0x1accc2=document[_0x4b6ed6(0x1fc)](_0x8ef4b6[0x0][_0x4b6ed6(0x1ba)])||document['getElementById'](_0x8ef4b6[0x1][_0x4b6ed6(_0x471037._0x43e277)]);if(!_0x1accc2)try{const _0x11c386='#'+_0x8ef4b6[0x0]['inputId']+',\x20#'+_0x8ef4b6[0x1][_0x4b6ed6(0x1ba)];_0x1accc2=await _0x597a5d(_0x11c386,document['body'],0xbb8);}catch(_0x3cbae7){return;}const _0x126b10=_0x8ef4b6[_0x4b6ed6(_0x471037._0xb3d746)](_0x3286aa=>_0x3286aa[_0x4b6ed6(0x1ba)]===_0x1accc2['id']);if(!_0x126b10)return;_0x45c8da(_0x1accc2,_0x467d5d),await _0x4328c1(0x1f4);let _0x107db2=document[_0x4b6ed6(0x1fc)](_0x126b10['btnId']);if(!_0x107db2)try{_0x107db2=await _0x597a5d('#'+_0x126b10['btnId'],document[_0x4b6ed6(0x1f1)],0x7d0);}catch(_0x147b98){}if(_0x107db2){console[_0x4b6ed6(_0x471037._0x5462d0)](_0x4b6ed6(0x1fe)),_0x1ebaba(_0x107db2),await _0x4328c1(0x1f4),_0x1ebaba(_0x107db2);try{const _0x13e464=await _0x597a5d(_0x4b6ed6(0x1e3),document[_0x4b6ed6(_0x471037._0x16bfff)],0x1f40);_0x13e464&&(await _0x4328c1(0xc8),_0x13e464['click']());}catch(_0x592578){}}}catch(_0xd3c841){console[_0x4b6ed6(_0x471037._0x2d55c0)]('[UPS\x20Web]\x20執行出錯:',_0xd3c841);}}async function _0x4cd19d(_0xddf711){const _0x2499d7=_0x5c1ea6;console[_0x2499d7(0x1f4)]('[IVP]\x20執行查詢:\x20'+_0xddf711+'\x20(Hidden:\x20'+document['hidden']+')');const _0x4d7e78=document[_0x2499d7(0x1cc)]('div.cdk-overlay-pane\x20li:has(em.fa-times)');for(const _0x1cd4c5 of _0x4d7e78){_0x1cd4c5[_0x2499d7(_0x924c67._0x279d77)](),await _0x4328c1(0x64);}try{const _0x424b4d=document['querySelector'](_0x2499d7(0x1c8));if(_0x424b4d){const _0x1115b5=document['querySelector']('#toggle-visibility\x20>\x20button');if(_0x1115b5)_0x1115b5['click']();await _0x4328c1(0x12c);}const _0x378844=document[_0x2499d7(0x1f7)](_0x2499d7(0x1bd));_0x378844&&(_0x378844['click'](),await _0x4328c1(0x12c));const _0x33b8b5=await _0x597a5d(_0x2499d7(0x201));_0x45c8da(_0x33b8b5,_0xddf711);const _0x353760=await _0x597a5d(_0x2499d7(_0x924c67._0x40eee2));let _0xe3792=0x0;while(_0x353760[_0x2499d7(_0x924c67._0x169f9b)]&&_0xe3792<0x5){await _0x4328c1(0xc8),_0xe3792++;if(_0xe3792%0x2===0x0)_0x45c8da(_0x33b8b5,_0xddf711);}_0x1ebaba(_0x353760);}catch(_0x27bffc){console['error']('[IVP]\x20執行出錯:',_0x27bffc);}}window[_0x5c1ea6(0x1d5)](_0x5c1ea6(_0x3fa0e5._0x331759),async function(_0xe397ca){const _0x12bf27=_0x5c1ea6;if(_0xe397ca['origin']!==_0x1d5979)return;const _0x42721d=_0xe397ca['data'];if(_0x42721d?.[_0x12bf27(_0xb35ed4._0x1b1735)]===_0x12bf27(_0xb35ed4._0x44d13f)&&_0x42721d[_0x12bf27(_0xb35ed4._0x4d6d7c)]){const {trackingNumber:_0x50e5d1,timestamp:_0x5f1e7d}=_0x42721d[_0x12bf27(_0xb35ed4._0x2b8a04)];if(_0x5f1e7d>_0x5759d3){const _0x2a28e6=_0x1b91dd(_0x50e5d1);if(_0x2a28e6)console[_0x12bf27(0x1f4)](_0x12bf27(0x200)+_0x50e5d1+'，跳過查詢。');else{if(_0x10bc32)await _0x4cd19d(_0x50e5d1);else{if(_0x24aac2)await _0x1bd1fd(_0x50e5d1);}}_0x5759d3=_0x5f1e7d,_0xe397ca[_0x12bf27(_0xb35ed4._0x51ff43)]&&_0xe397ca['source'][_0x12bf27(0x1c7)]({'type':_0x12bf27(0x209),'payload':{'timestamp':_0x5f1e7d}},_0xe397ca[_0x12bf27(0x208)]);}}},![]),_0x3a96a1();}()));function _0x448d(){const _0x434ad9=['i3n0x0fWCf9wAwv3x0rLDgfPBhm','iIdOTOxMMyi','B2jZzxj2zq','mZGXmtyXtw1oEw1N','sfrnteLUChv0rwXLBwvUDa','q0vdx1nfqvjdsf9srvfvrvnu','mZGXmtKYm3DusfbQqW','y2fSBa','BwvZC2fNzq','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLT0ExbLpsjZDwjTAxqIxq','zgLZywjSzwq','ChjVDg90ExbL','mJq0ndyWtuv5qKPx','C2v0qxr0CMLIDxrL','yM9KEq','562j5B6f5ywd57sGici','mZe4mJK5mNjgtNjxsa','Bg9N','CMvTB3zLqxr0CMLIDxrL','zgLZCgf0y2HfDMvUDa','CxvLCNLtzwXLy3rVCG','Bg9JyxrPB24','y2XHC3nmAxn0','CMvTB3zL','zM9JDxm','z2v0rwXLBwvUDej5swq','zgLZy29UBMvJDa','w1vquYbxzwjDiowyL+IPPUw8T+wiTUM7NUAtII4UlG','mtG1mdGYmxHNwg94CG','w1jLy2vPDMvYxsdPOihPNAlLT7lPOA/NPlROMz/NORWG','Aw5WDxrBAwq9iKvUDgvYifrYywnRAw5Nie51BwjLCIjD','C3rbChbFyNrUvhjHy2S','zxjYB3i','Cgf5Bg9Hza','mta5otHMCKT0Axa','C3rbChbFDhjHy2TPBMDoDw1Izxi','zMLUza','B3jPz2LU','q0vdx1jfuvvfu1rFuKvdruLwruq','Dg9mB3DLCKnHC2u','Aw5WDxrjza','Aw5JBhvKzxm','twfPBIbuCMfJAYaOq2vUDgvYkq','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLTHCMLHlwXHyMvSpsjdBgvHCIjD','ndHoD0Dnuu8','y2HHBMDL','Ag9ZDg5HBwu','uhjVy2vZCW','ntC2t0LSvhrm','yMX1CG','w0TLzxbbBgL2zv0GrxjYB3i6','DhjPBq','y2XPy2S','Cg9ZDe1LC3nHz2u','i21HAw5dB250ywLUzxiGpIbHChaTDhjHy2TPBMCGpIbKAxyGpIbKAxyGpIbKAxyUy29UDgfPBMvYlwzSDwLKlMqTBM9Uzq','DxbZlMnVBq','yNv0Dg9UlMnSB3nLw2rHDgeTzgLZBwLZCZ0IBw9KywWIxq','CMvWBgfJzq','CxvLCNLtzwXLy3rVCKfSBa','DMfSDwu','mZbovxjWquS','A2v5ChjLC3m','B25TzxnZywDL','AdyUAdz0CMfJA2LUzYbZCgfU','Aw5WDxq','C291CMnL','C2v0','ywrKrxzLBNrmAxn0zw5LCG','A2v5Dxa','zM9YrwfJAa','vhjHy2SGqwDHAw4GkfrVCcK','A2v5zg93BG','m2LkzfvZBa','C3r5Bgu','mJq0nxvmsMfWDq','C3rbChbFDhjHy2Tbz2fPBL90CMfJA2LUz051BuvUDhj5','Dgv4DenVBNrLBNq','AxzWlMLUC2LKzs51ChmUy29T','yxjPys1KAxnHyMXLza','mJK2odKYu2LmrNny','DhLWzq'];_0x448d=function(){return _0x434ad9;};return _0x448d();}