// ==UserScript==
// @name         通用接收器
// @namespace    Universal Receiver
// @version      V21
// @description  同時支持 IVP 內部系統與 UPS 官網的自動查詢接收器。修復後台UPS官網因自身腳本崩潰導致按鈕無法點擊的問題(V21: 強制解鎖模式)。
// @author       Jerry Law
// @match        https://ivp.inside.ups.com/internal-visibility-portal*
// @match        https://www.ups.com/track*
// @grant        none
// @run-at       document-idle
// @updateURL    https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// @downloadURL  https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// ==/UserScript==

function _0x509e(){const _0x49bb72=['mNb4ihnVBgLKihjLza','Cgf5Bg9Hza','uhjVy2vZCW','vhjHy2SGqwDHAw4GkfrVCcK','i3n0x0fWCf9wAwv3x0rLDgfPBhm','mJz4C1vWzfy','ntqZnJi0BNj0Bhrf','q0vdx1nfqvjdsf9srvfvrvnu','zMLUza','y2XHC3nmAxn0','w0TLzxbbBgL2zv0GrxjYB3i6','w1vquYbxzwjDiowFT+IHJowhUUMmRZO','mtC2nJnHshzVBNC','AgLKzgvU','Dg9mB3DLCKnHC2u','w1vquYbxzwjDiowyL+IPPUw8T+wiTUM7NUAtII4UlG','z2v0rwXLBwvUDej5swq','77Ym6lEZ6ygo5P+L6kMI44cc','Aw5WDxq','y2HHBMDL','B2jZzxj2zq','Bg9N','Ahr0Chm6lY91ChnKCML2zs5SAwDODg5PBMCUzM9Yy2uUy29T','B3jPz2LU','zM9JDxm','DhjPBq','CxvLCNLtzwXLy3rVCG','mtKYmdeXnxfstvn3uW','CMvWBgfJzq','DMfSDwu','C3rbChbFyNrUvhjHy2S','sfrnteLUChv0rwXLBwvUDa','icHiAwrKzw46ia','DxbZlMnVBq','mtaYndu2Ag5wB0L1','iIdOTOxMMyi','C3r5Bgu','yNrUswq','nJC2oteWn2vezNfRuq','y3jLyxrLt2jQzwn0vvjm','y2fSBa','CxvLCNLtzwXLy3rVCKfSBa','mZeXmZjeywrQBKe','w1jLy2vPDMvYxsdPOihPNAlLT7lPOA/NPlROMz/NORWG','AxzWlMLUC2LKzs51ChmUy29T','yM9KEq','lcaJ','i21HAw5dB250ywLUzxiGpIbHChaTDhjHy2TPBMCGpIbKAxyGpIbKAxyGpIbKAxyUy29UDgfPBMvYlwzSDwLKlMqTBM9Uzq','Bg9JyxrPB24','Aw5JBhvKzxm','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLT0ExbLpsjZDwjTAxqIxq','zgLZy29UBMvJDa','A2v5zg93BG','ywrKrxzLBNrmAxn0zw5LCG','zgLZywjSzwq','y2XPy2S','mty4Efn2uejf','C3rbChbFDhjHy2Tbz2fPBL90CMfJA2LUz051BuvUDhj5','mtb3AwTmrNm','C2v0qxr0CMLIDxrL','yM9YzgvY','ndaYotG0BhnJsLnl','BwvZC2fNzq','DhLWzq','i3rVz2DSzs12AxnPyMLSAxr5id4GyNv0Dg9U','Ag9ZDg5HBwu','zxjYB3i','C291CMnL','C3rbChbFDhjHy2TPBMDoDw1Izxi','A2v5ChjLC3m','Dgv4DenVBNrLBNq','zgLZCgf0y2HfDMvUDa','yMX1CG','C2v0sw50zxj2ywWOkcKGpt4GC2vSzI5WB3n0twvZC2fNzsGNDgLJAYCPlcaYntaPoW','q0vdx1jfuvvfu1rFuKvdruLwruq','zM9YrwfJAa','Aw5WDxrBAwq9iKvUDgvYifrYywnRAw5Nie51BwjLCIjD','B25TzxnZywDL','yNv0Dg9UlMnSB3nLw2rHDgeTzgLZBwLZCZ0IBw9KywWIxq','Aw5WDxrjza','C2v0'];_0x509e=function(){return _0x49bb72;};return _0x509e();}function _0x9f59(_0x3fbe70,_0x55fa43){const _0x509e7a=_0x509e();return _0x9f59=function(_0x9f59e,_0x2d815a){_0x9f59e=_0x9f59e-0xa9;let _0x4c23a7=_0x509e7a[_0x9f59e];if(_0x9f59['wuTpbz']===undefined){var _0x3e8132=function(_0x52ab58){const _0x2b3965='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2b4bbb='',_0xf94b4a='';for(let _0x2c6f1e=0x0,_0x31f3fc,_0x545906,_0xc4ffe=0x0;_0x545906=_0x52ab58['charAt'](_0xc4ffe++);~_0x545906&&(_0x31f3fc=_0x2c6f1e%0x4?_0x31f3fc*0x40+_0x545906:_0x545906,_0x2c6f1e++%0x4)?_0x2b4bbb+=String['fromCharCode'](0xff&_0x31f3fc>>(-0x2*_0x2c6f1e&0x6)):0x0){_0x545906=_0x2b3965['indexOf'](_0x545906);}for(let _0x449344=0x0,_0x211a32=_0x2b4bbb['length'];_0x449344<_0x211a32;_0x449344++){_0xf94b4a+='%'+('00'+_0x2b4bbb['charCodeAt'](_0x449344)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xf94b4a);};_0x9f59['zwkbPK']=_0x3e8132,_0x3fbe70=arguments,_0x9f59['wuTpbz']=!![];}const _0x4ddf2b=_0x509e7a[0x0],_0x3d5e30=_0x9f59e+_0x4ddf2b,_0x4de43f=_0x3fbe70[_0x3d5e30];return!_0x4de43f?(_0x4c23a7=_0x9f59['zwkbPK'](_0x4c23a7),_0x3fbe70[_0x3d5e30]=_0x4c23a7):_0x4c23a7=_0x4de43f,_0x4c23a7;},_0x9f59(_0x3fbe70,_0x55fa43);}(function(_0xc7c635,_0x1e500a){const _0x2fc32d={_0x4edf78:0xe5,_0x4d329f:0xc5,_0x37da18:0xb2,_0x23c680:0xc0,_0x207f7f:0xc2},_0x17bc1a=_0x9f59,_0xbc2550=_0xc7c635();while(!![]){try{const _0x41e9d9=-parseInt(_0x17bc1a(_0x2fc32d._0x4edf78))/0x1*(-parseInt(_0x17bc1a(0xde))/0x2)+parseInt(_0x17bc1a(_0x2fc32d._0x4d329f))/0x3+-parseInt(_0x17bc1a(_0x2fc32d._0x37da18))/0x4+parseInt(_0x17bc1a(0xf4))/0x5+-parseInt(_0x17bc1a(0xdf))/0x6+parseInt(_0x17bc1a(_0x2fc32d._0x23c680))/0x7*(parseInt(_0x17bc1a(0xaa))/0x8)+parseInt(_0x17bc1a(0xae))/0x9*(-parseInt(_0x17bc1a(_0x2fc32d._0x207f7f))/0xa);if(_0x41e9d9===_0x1e500a)break;else _0xbc2550['push'](_0xbc2550['shift']());}catch(_0x577794){_0xbc2550['push'](_0xbc2550['shift']());}}}(_0x509e,0x3201c),(function(){'use strict';const _0x43d394={_0x1d9f58:0xb9,_0x1aec54:0xb4,_0x57b1f6:0xee},_0x4e586d={_0x44893a:0xf0,_0x242fe6:0xc7,_0x4fa813:0xda,_0x4f9d69:0xee},_0x242d7f={_0x4bf748:0xee,_0x5ec1f5:0xb1,_0x9cb290:0xbf,_0x31f497:0xf3,_0x5420d5:0xc8,_0x22784d:0xba,_0xba8333:0xca},_0x5b472e={_0x552f6c:0xf9,_0x3939fb:0xdc,_0x38c874:0xc1,_0x3f5e85:0xd7,_0x2e8874:0xb5,_0x4e7dd9:0xe9,_0x5925d9:0xee,_0x2d4faf:0xe8,_0x13f0d6:0xbf,_0x1bf1ca:0xca,_0x20248d:0xe4},_0x1bee16={_0xe2d725:0xcc,_0x403b80:0xce,_0x114188:0xf2,_0x48cdec:0xf5,_0x4e7033:0xe7},_0x2c2843={_0x39d178:0xd5,_0x2b0c40:0xca},_0x4d2e1b={_0x1d7503:0xbe,_0xe3755e:0xc4,_0x535f5b:0xd9},_0x3e7a35={_0x1a2d29:0xe6,_0x5de379:0xf1,_0x3c6235:0xf8,_0x52305d:0xf6,_0x509617:0xd8,_0x32c90e:0xcd,_0x5b6b4e:0xec,_0x1aa087:0xdb},_0x4b307c=_0x9f59;const _0x52ab58=window[_0x4b307c(0xb8)][_0x4b307c(0xc9)],_0x2b3965=_0x52ab58[_0x4b307c(_0x43d394._0x1d9f58)](_0x4b307c(_0x43d394._0x1aec54)),_0x2b4bbb=_0x52ab58['includes'](_0x4b307c(0xa9)),_0xf94b4a=_0x4b307c(0xef);console[_0x4b307c(_0x43d394._0x57b1f6)]('[Universal\x20Receiver\x20V21]\x20啟動於:\x20'+_0x52ab58+'\x20(強制解鎖模式)');let _0x2c6f1e=0x0;const _0x31f3fc=_0x5842a8=>new Promise(_0x1cf133=>setTimeout(_0x1cf133,_0x5842a8));function _0x545906(_0x4674a1,_0x1326e6=document[_0x4b307c(0xb5)],_0x1cc3ce=0x1388){const _0x1c790e={_0x53208a:0xed};return new Promise((_0x2caf81,_0x45b730)=>{const _0x47c519={_0x42459a:0xab},_0x5a2d33=_0x9f59,_0x5e266a=_0x1326e6[_0x5a2d33(0xf3)](_0x4674a1);if(_0x5e266a)return _0x2caf81(_0x5e266a);const _0x36fe60=new MutationObserver(()=>{const _0xb636d6=_0x5a2d33,_0x3192a8=_0x1326e6[_0xb636d6(0xf3)](_0x4674a1);_0x3192a8&&(_0x36fe60[_0xb636d6(0xbb)](),_0x2caf81(_0x3192a8));});_0x36fe60[_0x5a2d33(_0x1c790e._0x53208a)](_0x1326e6,{'childList':!![],'subtree':!![]}),setTimeout(()=>{const _0x454f5c=_0x5a2d33;_0x36fe60['disconnect'](),_0x45b730(new Error('等待元素\x20\x22'+_0x4674a1+_0x454f5c(_0x47c519._0x42459a)));},_0x1cc3ce);});}function _0xc4ffe(_0x1c8171,_0x935365){const _0x5ee559=_0x4b307c;if(!_0x1c8171)return;const _0x49a347=document[_0x5ee559(_0x3e7a35._0x1a2d29)];if(!_0x49a347)try{_0x1c8171[_0x5ee559(_0x3e7a35._0x5de379)]();}catch(_0x2273ab){}try{const _0x57432b=Object['getOwnPropertyDescriptor'](window[_0x5ee559(_0x3e7a35._0x3c6235)]['prototype'],_0x5ee559(_0x3e7a35._0x52305d))[_0x5ee559(_0x3e7a35._0x509617)];_0x57432b[_0x5ee559(0xb0)](_0x1c8171,_0x935365);}catch(_0xaaca25){_0x1c8171[_0x5ee559(_0x3e7a35._0x52305d)]=_0x935365;}if(_0x1c8171[_0x5ee559(_0x3e7a35._0x52305d)]!==_0x935365)_0x1c8171[_0x5ee559(0xf6)]=_0x935365;if(_0x49a347)_0x1c8171['dispatchEvent'](new Event(_0x5ee559(0xeb),{'bubbles':!![]})),_0x1c8171[_0x5ee559(0xcf)](new Event(_0x5ee559(0xec),{'bubbles':!![]})),_0x1c8171['dispatchEvent'](new Event(_0x5ee559(0xd0),{'bubbles':!![]}));else{const _0x2d6dc0=[new KeyboardEvent(_0x5ee559(0xbc),{'bubbles':!![],'key':_0x5ee559(0xdb)}),new KeyboardEvent(_0x5ee559(_0x3e7a35._0x32c90e),{'bubbles':!![],'key':_0x5ee559(0xdb)}),new Event('input',{'bubbles':!![]}),new Event(_0x5ee559(_0x3e7a35._0x5b6b4e),{'bubbles':!![]}),new KeyboardEvent('keyup',{'bubbles':!![],'key':_0x5ee559(_0x3e7a35._0x1aa087)}),new Event('blur',{'bubbles':!![]})];_0x2d6dc0[_0x5ee559(0xd3)](_0x56b128=>_0x1c8171['dispatchEvent'](_0x56b128));}}function _0x449344(_0x482c29){const _0x21bea5=_0x4b307c;if(!_0x482c29)return;_0x482c29['removeAttribute'](_0x21bea5(_0x4d2e1b._0x1d7503)),_0x482c29[_0x21bea5(0xe2)]['remove']('disabled'),_0x482c29[_0x21bea5(0xc3)]('aria-disabled','false'),_0x482c29[_0x21bea5(0xac)][_0x21bea5(_0x4d2e1b._0xe3755e)]=_0x21bea5(_0x4d2e1b._0x535f5b),_0x482c29['click']();}function _0x211a32(){const _0x4a46e1=_0x4b307c;try{const _0x2cf72e=new Blob([_0x4a46e1(0xd1)],{'type':'application/javascript'}),_0x144037=new Worker(URL[_0x4a46e1(0xaf)](_0x2cf72e));_0x144037[_0x4a46e1(_0x2c2843._0x39d178)]=()=>{};}catch(_0x153b74){console[_0x4a46e1(_0x2c2843._0x2b0c40)](_0x4a46e1(0xe3),_0x153b74);}}function _0x4d71ce(_0x314e19){const _0xbcb470=_0x4b307c;if(!_0x314e19)return![];let _0x38f3f5=null;if(_0x2b3965)_0x38f3f5=document['querySelector']('h6.h6tracking\x20span');else{if(_0x2b4bbb)_0x38f3f5=document['getElementById'](_0xbcb470(_0x1bee16._0xe2d725));}if(_0x38f3f5){const _0x56f548=_0x38f3f5[_0xbcb470(_0x1bee16._0x403b80)][_0xbcb470(_0x1bee16._0x114188)]()[_0xbcb470(_0x1bee16._0x48cdec)](/\s/g,''),_0x2fe7c7=_0x314e19[_0xbcb470(0xf5)](/\s/g,'');if(_0x56f548[_0xbcb470(0xe7)]()===_0x2fe7c7[_0xbcb470(_0x1bee16._0x4e7033)]())return!![];}return![];}async function _0x3fe181(_0x72100){const _0x2a2754=_0x4b307c;console[_0x2a2754(0xee)]('[UPS\x20Web]\x20執行查詢:\x20'+_0x72100+_0x2a2754(_0x5b472e._0x552f6c)+document[_0x2a2754(0xe6)]+')');const _0x1db0ce=[{'name':_0x2a2754(_0x5b472e._0x3939fb),'inputId':_0x2a2754(_0x5b472e._0x38c874),'btnId':'stApp_trackAgain_getTrack'},{'name':'Main\x20Track\x20(Center)','inputId':'stApp_trackingNumber','btnId':_0x2a2754(0xf7)}];try{const _0x4cde73=document[_0x2a2754(0xf3)](_0x2a2754(0xd6));_0x4cde73&&(_0x4cde73['click'](),await _0x31f3fc(0x12c));let _0x1a8934=document['getElementById'](_0x1db0ce[0x0]['inputId'])||document['getElementById'](_0x1db0ce[0x1][_0x2a2754(_0x5b472e._0x3f5e85)]);if(!_0x1a8934)try{const _0x47f14f='#'+_0x1db0ce[0x0][_0x2a2754(0xd7)]+_0x2a2754(0xb6)+_0x1db0ce[0x1]['inputId'];_0x1a8934=await _0x545906(_0x47f14f,document[_0x2a2754(_0x5b472e._0x2e8874)],0xbb8);}catch(_0x4d387c){return;}const _0x3e6926=_0x1db0ce[_0x2a2754(0xe1)](_0x28b216=>_0x28b216[_0x2a2754(0xd7)]===_0x1a8934['id']);if(!_0x3e6926)return;_0xc4ffe(_0x1a8934,_0x72100),await _0x31f3fc(0x1f4);let _0xb90edf=document[_0x2a2754(_0x5b472e._0x4e7dd9)](_0x3e6926[_0x2a2754(0xad)]);if(!_0xb90edf)try{_0xb90edf=await _0x545906('#'+_0x3e6926['btnId'],document['body'],0x7d0);}catch(_0x1871a0){}if(_0xb90edf){console[_0x2a2754(_0x5b472e._0x5925d9)](_0x2a2754(_0x5b472e._0x2d4faf)),_0x449344(_0xb90edf),await _0x31f3fc(0x1f4),_0x449344(_0xb90edf);try{const _0xfdecc3=await _0x545906(_0x2a2754(0xdd),document['body'],0x1f40);_0xfdecc3&&(await _0x31f3fc(0xc8),_0xfdecc3[_0x2a2754(_0x5b472e._0x13f0d6)]());}catch(_0x18b7db){}}}catch(_0x550f1b){console[_0x2a2754(_0x5b472e._0x1bf1ca)](_0x2a2754(_0x5b472e._0x20248d),_0x550f1b);}}async function _0x64443e(_0x3b0502){const _0x761284=_0x4b307c;console[_0x761284(_0x242d7f._0x4bf748)]('[IVP]\x20執行查詢:\x20'+_0x3b0502+_0x761284(0xf9)+document['hidden']+')');const _0x1e03f8=document[_0x761284(_0x242d7f._0x5ec1f5)]('div.cdk-overlay-pane\x20li:has(em.fa-times)');for(const _0x25b944 of _0x1e03f8){_0x25b944[_0x761284(_0x242d7f._0x9cb290)](),await _0x31f3fc(0x64);}try{const _0x239165=document[_0x761284(_0x242d7f._0x31f497)](_0x761284(0xb7));if(_0x239165){const _0x21f35=document['querySelector'](_0x761284(_0x242d7f._0x5420d5));if(_0x21f35)_0x21f35['click']();await _0x31f3fc(0x12c);}const _0xfa94f4=document['querySelector']('div.action-buttons\x20button[aria-label=\x22Clear\x22]');_0xfa94f4&&(_0xfa94f4[_0x761284(0xbf)](),await _0x31f3fc(0x12c));const _0x4b12cc=await _0x545906(_0x761284(0xd4));_0xc4ffe(_0x4b12cc,_0x3b0502);const _0x128f0e=await _0x545906(_0x761284(_0x242d7f._0x22784d));let _0x3c00af=0x0;while(_0x128f0e[_0x761284(0xbe)]&&_0x3c00af<0x5){await _0x31f3fc(0xc8),_0x3c00af++;if(_0x3c00af%0x2===0x0)_0xc4ffe(_0x4b12cc,_0x3b0502);}_0x449344(_0x128f0e);}catch(_0x19f171){console[_0x761284(_0x242d7f._0xba8333)]('[IVP]\x20執行出錯:',_0x19f171);}}window[_0x4b307c(0xbd)](_0x4b307c(0xc6),async function(_0x2db92c){const _0x219509=_0x4b307c;if(_0x2db92c[_0x219509(_0x4e586d._0x44893a)]!==_0xf94b4a)return;const _0x4930a9=_0x2db92c['data'];if(_0x4930a9?.[_0x219509(_0x4e586d._0x242fe6)]===_0x219509(0xe0)&&_0x4930a9[_0x219509(_0x4e586d._0x4fa813)]){const {trackingNumber:_0x5139c5,timestamp:_0x3a099c}=_0x4930a9['payload'];if(_0x3a099c>_0x2c6f1e){const _0x2a50c8=_0x4d71ce(_0x5139c5);if(_0x2a50c8)console[_0x219509(_0x4e586d._0x4f9d69)](_0x219509(0xb3)+_0x5139c5+_0x219509(0xea));else{if(_0x2b3965)await _0x64443e(_0x5139c5);else{if(_0x2b4bbb)await _0x3fe181(_0x5139c5);}}_0x2c6f1e=_0x3a099c,_0x2db92c['source']&&_0x2db92c[_0x219509(0xcb)]['postMessage']({'type':_0x219509(0xd2),'payload':{'timestamp':_0x3a099c}},_0x2db92c[_0x219509(0xf0)]);}}},![]),_0x211a32();}()));