// ==UserScript==
// @name         通用接收器
// @namespace    Universal Receiver
// @version      V21
// @description  同時支持 IVP 內部系統與 UPS 官網的自動查詢接收器。修復後台UPS官網因自身腳本崩潰導致按鈕無法點擊的問題(V21: 強制解鎖模式)。
// @author       Jerry Law
// @match        https://ivp.inside.ups.com/internal-visibility-portal*
// @match        https://www.ups.com/track*
// @grant        none
// @run-at       document-idle
// @updateURL    https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// @downloadURL  https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// ==/UserScript==

function _0x1070(_0x1a3098,_0x52eebc){const _0x578c3f=_0x578c();return _0x1070=function(_0x1070f3,_0x3e2f2a){_0x1070f3=_0x1070f3-0x1cb;let _0x551311=_0x578c3f[_0x1070f3];if(_0x1070['NUlHLT']===undefined){var _0x53cc0f=function(_0x38d438){const _0x256b8a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x475a34='',_0x192ec8='';for(let _0x450d59=0x0,_0x380f5b,_0x51b687,_0x168c21=0x0;_0x51b687=_0x38d438['charAt'](_0x168c21++);~_0x51b687&&(_0x380f5b=_0x450d59%0x4?_0x380f5b*0x40+_0x51b687:_0x51b687,_0x450d59++%0x4)?_0x475a34+=String['fromCharCode'](0xff&_0x380f5b>>(-0x2*_0x450d59&0x6)):0x0){_0x51b687=_0x256b8a['indexOf'](_0x51b687);}for(let _0x4bb113=0x0,_0x5603c0=_0x475a34['length'];_0x4bb113<_0x5603c0;_0x4bb113++){_0x192ec8+='%'+('00'+_0x475a34['charCodeAt'](_0x4bb113)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x192ec8);};_0x1070['zxtMHu']=_0x53cc0f,_0x1a3098=arguments,_0x1070['NUlHLT']=!![];}const _0x3fd718=_0x578c3f[0x0],_0x2668e0=_0x1070f3+_0x3fd718,_0x564877=_0x1a3098[_0x2668e0];return!_0x564877?(_0x551311=_0x1070['zxtMHu'](_0x551311),_0x1a3098[_0x2668e0]=_0x551311):_0x551311=_0x564877,_0x551311;},_0x1070(_0x1a3098,_0x52eebc);}function _0x578c(){const _0x471c70=['zMLUza','Ahr0Chm6lY91ChnKCML2zs5SAwDODg5PBMCUzM9Yy2uUy29T','Aw5JBhvKzxm','A2v5Dxa','nZGWwvv3vhfi','nJe4nta1EhjNyMrU','DMfSDwu','mtG2ngf6AvnMva','CMvTB3zLqxr0CMLIDxrL','BwvZC2fNzq','zM9JDxm','C2v0sw50zxj2ywWOkcKGpt4GC2vSzI5WB3n0twvZC2fNzsGNDgLJAYCPlcaYntaPoW','CxvLCNLtzwXLy3rVCKfSBa','twfPBIbuCMfJAYaOq2vUDgvYkq','CMvWBgfJzq','Dgv4DenVBNrLBNq','CMvTB3zL','DxbZlMnVBq','B3jPz2LU','zgLZCgf0y2HfDMvUDa','DhjPBq','mZCXv3fSB2zM','zMfSC2u','C3rbChbFDhjHy2TPBMDoDw1Izxi','mNb4ihnVBgLKihjLza','y2fSBa','w0Lwuf0G5z+36kgm5P+L6kMIoIa','C291CMnL','w1vquYbxzwjDiowyL+IPPUw8T+wiTUM7NUAtII4UlG','iIdOTOxMMyi','w0Lwuf0G5z+36kgm5yE66yYVoG','yNrUswq','yxjPys1KAxnHyMXLza','mtaZmJnhtvrTqNO','C3r5Bgu','yMX1CG','mJm5odHOy3jxweC','C3rbChbFDhjHy2Tbz2fPBL9NzxruCMfJAW','zxjYB3i','lcaJ','C2v0','ywrKrxzLBNrmAxn0zw5LCG','Aw5WDxrBAwq9iKvUDgvYifrYywnRAw5Nie51BwjLCIjD','w1jLy2vPDMvYxsdPOihPNAlLT7lPOA/NPlROMz/NORWG','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLTHCMLHlwXHyMvSpsjdBgvHCIjD','yM9KEq','zgLZywjSzwq','AgLKzgvU','Bg9N','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLT0ExbLpsjZDwjTAxqIxq','z2v0rwXLBwvUDej5swq','AdyUAdz0CMfJA2LUzYbZCgfU','y2XPy2S','mJq4rwz4zurf','A2v5ChjLC3m','Aw5WDxrjza','uhjVy2vZCW','mtiZntmZmtLttLnLCuS','mJa3m1jUrwXlqG','ndK0nJC3nMzUDvbMwG','CxvLCNLtzwXLy3rVCG','B2jZzxj2zq','y3jLyxrLt2jQzwn0vvjm','A2v5zg93BG','C2v0qxr0CMLIDxrL','y2XHC3nmAxn0','zgLZy29UBMvJDa','sfrnteLUChv0rwXLBwvUDa','q0vdx1jfuvvfu1rFuKvdruLwruq','y2HHBMDL','icJLVlFLIlBOP6pPJPBMQkhLVi8P','nJiZmhnSCLz6BW','Ag9ZDg5HBwu','z2v0t3DUuhjVCgvYDhLezxnJCMLWDg9Y','zM9YrwfJAa','i3n0x0fWCf9wAwv3x0rLDgfPBhm','i3rVz2DSzs12AxnPyMLSAxr5id4GyNv0Dg9U','562j5B6f5ywd57sGici','Dg9mB3DLCKnHC2u','yNv0Dg9UlMnSB3nLw2rHDgeTzgLZBwLZCZ0IBw9KywWIxq'];_0x578c=function(){return _0x471c70;};return _0x578c();}(function(_0x2abb1f,_0x21af17){const _0x5cceed={_0x458eb3:0x209,_0xc92091:0x204,_0x2ae11e:0x1d3,_0xa57515:0x1e4,_0x58af0b:0x20a,_0x195b65:0x1f0,_0x4c1cca:0x216,_0x3454cf:0x208},_0x5ba877=_0x1070,_0xbde222=_0x2abb1f();while(!![]){try{const _0x42749f=parseInt(_0x5ba877(0x1d4))/0x1+parseInt(_0x5ba877(0x1d6))/0x2*(parseInt(_0x5ba877(_0x5cceed._0x458eb3))/0x3)+-parseInt(_0x5ba877(_0x5cceed._0xc92091))/0x4*(parseInt(_0x5ba877(_0x5cceed._0x2ae11e))/0x5)+-parseInt(_0x5ba877(0x1f3))/0x6*(-parseInt(_0x5ba877(_0x5cceed._0xa57515))/0x7)+-parseInt(_0x5ba877(_0x5cceed._0x58af0b))/0x8+-parseInt(_0x5ba877(_0x5cceed._0x195b65))/0x9*(-parseInt(_0x5ba877(_0x5cceed._0x4c1cca))/0xa)+-parseInt(_0x5ba877(_0x5cceed._0x3454cf))/0xb;if(_0x42749f===_0x21af17)break;else _0xbde222['push'](_0xbde222['shift']());}catch(_0xd2d990){_0xbde222['push'](_0xbde222['shift']());}}}(_0x578c,0x6aeb8),(function(){'use strict';const _0x229e54={_0x147af2:0x1d1,_0x26869d:0x1d0,_0x12d989:0x1ff,_0x1f9c43:0x215},_0x5b5f02={_0x292032:0x1fa,_0x557bba:0x1ea,_0x2a5be6:0x213,_0x423607:0x1e1},_0x2e6ee3={_0x375551:0x1e9,_0x4f6a99:0x1fe,_0x31c779:0x1cb,_0x181769:0x203,_0xdcc93d:0x20b,_0x42f933:0x1fb,_0x425dbe:0x1f9,_0x13c72e:0x1f5},_0x3fbc33={_0x4de7a7:0x1ff,_0x2151ca:0x1f4,_0x4be97b:0x1dc,_0x116162:0x1ce,_0x4aaef7:0x203,_0x3dff36:0x206,_0x2dd375:0x201,_0x3f9b1e:0x1fc,_0x4a70cd:0x1fc,_0x5da6a4:0x1f5},_0xf3eeaf={_0x20eadd:0x201,_0x847e14:0x1dd,_0x5f1dd8:0x1cd,_0x362884:0x1cd},_0x3f667b={_0x56f345:0x1da,_0x5c8934:0x20d},_0x3e5c49={_0xf26b51:0x1d7,_0x4a223d:0x210,_0x5b25e2:0x1df,_0x5f9d7b:0x1fd,_0x5346da:0x20f,_0x5f427:0x1ef,_0xfb2b47:0x1f1,_0x25202b:0x1e7},_0xafe26c={_0x53396e:0x1d9,_0x5ce7f9:0x218,_0x87f9c3:0x212,_0x3b8bef:0x1d5,_0x5ce6fe:0x1d5,_0x44105f:0x1f2,_0xae3a2d:0x20e,_0x4f7256:0x205,_0x15f07d:0x1d2},_0x268ca7=_0x1070;const _0x38d438=window['location'][_0x268ca7(0x217)],_0x256b8a=_0x38d438[_0x268ca7(0x1d1)]('ivp.inside.ups.com'),_0x475a34=_0x38d438[_0x268ca7(_0x229e54._0x147af2)](_0x268ca7(0x1e0)),_0x192ec8=_0x268ca7(_0x229e54._0x26869d);console[_0x268ca7(_0x229e54._0x12d989)]('[Universal\x20Receiver\x20V21]\x20啟動於:\x20'+_0x38d438+_0x268ca7(_0x229e54._0x1f9c43));let _0x450d59=0x0;const _0x380f5b=_0x416572=>new Promise(_0x549e8c=>setTimeout(_0x549e8c,_0x416572));function _0x51b687(_0x472056,_0x1ae6d6=document[_0x268ca7(0x1fc)],_0x283138=0x1388){const _0x95b7b3={_0x591940:0x1ec};return new Promise((_0x1f33f6,_0x26abc7)=>{const _0xcb4de4=_0x1070,_0xfa3258=_0x1ae6d6[_0xcb4de4(0x20b)](_0x472056);if(_0xfa3258)return _0x1f33f6(_0xfa3258);const _0x314a38=new MutationObserver(()=>{const _0xa1d6ca=_0xcb4de4,_0x1c2453=_0x1ae6d6[_0xa1d6ca(0x20b)](_0x472056);_0x1c2453&&(_0x314a38['disconnect'](),_0x1f33f6(_0x1c2453));});_0x314a38[_0xcb4de4(0x20c)](_0x1ae6d6,{'childList':!![],'subtree':!![]}),setTimeout(()=>{const _0x26bcaa=_0xcb4de4;_0x314a38[_0x26bcaa(0x211)](),_0x26abc7(new Error(_0x26bcaa(0x1cc)+_0x472056+_0x26bcaa(_0x95b7b3._0x591940)));},_0x283138);});}function _0x168c21(_0x332514,_0x9457ff){const _0x139273=_0x268ca7;if(!_0x332514)return;const _0x27f9a7=document[_0x139273(0x1fe)];if(!_0x27f9a7)try{_0x332514[_0x139273(_0xafe26c._0x53396e)]();}catch(_0xe87df0){}try{const _0x27afb9=Object[_0x139273(_0xafe26c._0x5ce7f9)](window[_0x139273(_0xafe26c._0x87f9c3)]['prototype'],_0x139273(_0xafe26c._0x3b8bef))[_0x139273(0x1f7)];_0x27afb9[_0x139273(0x1e8)](_0x332514,_0x9457ff);}catch(_0x4261b6){_0x332514['value']=_0x9457ff;}if(_0x332514[_0x139273(_0xafe26c._0x5ce6fe)]!==_0x9457ff)_0x332514['value']=_0x9457ff;if(_0x27f9a7)_0x332514['dispatchEvent'](new Event('input',{'bubbles':!![]})),_0x332514['dispatchEvent'](new Event(_0x139273(0x214),{'bubbles':!![]})),_0x332514[_0x139273(0x1e2)](new Event(_0x139273(_0xafe26c._0x44105f),{'bubbles':!![]}));else{const _0x52a7e6=[new KeyboardEvent(_0x139273(_0xafe26c._0xae3a2d),{'bubbles':!![],'key':_0x139273(0x207)}),new KeyboardEvent(_0x139273(_0xafe26c._0x4f7256),{'bubbles':!![],'key':'Process'}),new Event('input',{'bubbles':!![]}),new Event('change',{'bubbles':!![]}),new KeyboardEvent(_0x139273(_0xafe26c._0x15f07d),{'bubbles':!![],'key':_0x139273(0x207)}),new Event(_0x139273(_0xafe26c._0x44105f),{'bubbles':!![]})];_0x52a7e6[_0x139273(0x219)](_0x2bcec1=>_0x332514['dispatchEvent'](_0x2bcec1));}}function _0x4bb113(_0x12be37){const _0x1497f6=_0x268ca7;if(!_0x12be37)return;_0x12be37[_0x1497f6(_0x3e5c49._0xf26b51)]('disabled'),_0x12be37[_0x1497f6(_0x3e5c49._0x4a223d)][_0x1497f6(_0x3e5c49._0x5b25e2)](_0x1497f6(_0x3e5c49._0x5f9d7b)),_0x12be37[_0x1497f6(_0x3e5c49._0x5346da)](_0x1497f6(_0x3e5c49._0x5f427),_0x1497f6(0x1e5)),_0x12be37[_0x1497f6(_0x3e5c49._0xfb2b47)]['border']=_0x1497f6(_0x3e5c49._0x25202b),_0x12be37['click']();}function _0x5603c0(){const _0x3ee60b=_0x268ca7;try{const _0x1f2f80=new Blob([_0x3ee60b(_0x3f667b._0x56f345)],{'type':'application/javascript'}),_0x2e3ec0=new Worker(URL[_0x3ee60b(_0x3f667b._0x5c8934)](_0x1f2f80));_0x2e3ec0['onmessage']=()=>{};}catch(_0x517861){console['error']('[KeepAlive]\x20Error:',_0x517861);}}function _0x1f0c68(_0x55beef){const _0x404f7d=_0x268ca7;if(!_0x55beef)return![];let _0x133179=null;if(_0x256b8a)_0x133179=document[_0x404f7d(0x20b)](_0x404f7d(0x202));else{if(_0x475a34)_0x133179=document[_0x404f7d(_0xf3eeaf._0x20eadd)]('stApp_trackingNumber');}if(_0x133179){const _0x28c4d7=_0x133179[_0x404f7d(0x1de)][_0x404f7d(0x1e3)]()[_0x404f7d(_0xf3eeaf._0x847e14)](/\s/g,''),_0x4db24d=_0x55beef[_0x404f7d(_0xf3eeaf._0x847e14)](/\s/g,'');if(_0x28c4d7[_0x404f7d(_0xf3eeaf._0x5f1dd8)]()===_0x4db24d[_0x404f7d(_0xf3eeaf._0x362884)]())return!![];}return![];}async function _0x511262(_0x108a57){const _0x532df1=_0x268ca7;console[_0x532df1(_0x3fbc33._0x4de7a7)]('[UPS\x20Web]\x20執行查詢:\x20'+_0x108a57+'\x20(Hidden:\x20'+document['hidden']+')');const _0x2e106c=[{'name':'Track\x20Again\x20(Top)','inputId':'stApp_trackAgain_trackingNumEntry','btnId':_0x532df1(_0x3fbc33._0x2151ca)},{'name':_0x532df1(_0x3fbc33._0x4be97b),'inputId':_0x532df1(0x1e6),'btnId':'stApp_btnTrack'}];try{const _0xf9e0bf=document['querySelector'](_0x532df1(_0x3fbc33._0x116162));_0xf9e0bf&&(_0xf9e0bf[_0x532df1(_0x3fbc33._0x4aaef7)](),await _0x380f5b(0x12c));let _0x253503=document[_0x532df1(0x201)](_0x2e106c[0x0][_0x532df1(_0x3fbc33._0x3dff36)])||document[_0x532df1(_0x3fbc33._0x2dd375)](_0x2e106c[0x1][_0x532df1(0x206)]);if(!_0x253503)try{const _0xace852='#'+_0x2e106c[0x0][_0x532df1(_0x3fbc33._0x3dff36)]+_0x532df1(0x1f6)+_0x2e106c[0x1][_0x532df1(0x206)];_0x253503=await _0x51b687(_0xace852,document[_0x532df1(_0x3fbc33._0x3f9b1e)],0xbb8);}catch(_0x4aea74){return;}const _0x189681=_0x2e106c[_0x532df1(0x1cf)](_0x425842=>_0x425842['inputId']===_0x253503['id']);if(!_0x189681)return;_0x168c21(_0x253503,_0x108a57),await _0x380f5b(0x1f4);let _0x12946a=document[_0x532df1(0x201)](_0x189681['btnId']);if(!_0x12946a)try{_0x12946a=await _0x51b687('#'+_0x189681[_0x532df1(0x1ee)],document[_0x532df1(0x1fc)],0x7d0);}catch(_0x510c6e){}if(_0x12946a){console[_0x532df1(0x1ff)](_0x532df1(0x1eb)),_0x4bb113(_0x12946a),await _0x380f5b(0x1f4),_0x4bb113(_0x12946a);try{const _0x3ce850=await _0x51b687(_0x532df1(0x21a),document[_0x532df1(_0x3fbc33._0x4a70cd)],0x1f40);_0x3ce850&&(await _0x380f5b(0xc8),_0x3ce850[_0x532df1(_0x3fbc33._0x4aaef7)]());}catch(_0x43f7c8){}}}catch(_0x4226c6){console[_0x532df1(_0x3fbc33._0x5da6a4)]('[UPS\x20Web]\x20執行出錯:',_0x4226c6);}}async function _0x1b5c91(_0x5eade3){const _0x5debb7=_0x268ca7;console[_0x5debb7(0x1ff)](_0x5debb7(_0x2e6ee3._0x375551)+_0x5eade3+'\x20(Hidden:\x20'+document[_0x5debb7(_0x2e6ee3._0x4f6a99)]+')');const _0x26310d=document[_0x5debb7(0x1db)]('div.cdk-overlay-pane\x20li:has(em.fa-times)');for(const _0x547983 of _0x26310d){_0x547983[_0x5debb7(0x203)](),await _0x380f5b(0x64);}try{const _0x277102=document[_0x5debb7(0x20b)]('#mainContainer\x20>\x20app-tracking\x20>\x20div\x20>\x20div\x20>\x20div.container-fluid.d-none');if(_0x277102){const _0x5a84a6=document['querySelector'](_0x5debb7(_0x2e6ee3._0x31c779));if(_0x5a84a6)_0x5a84a6[_0x5debb7(_0x2e6ee3._0x181769)]();await _0x380f5b(0x12c);}const _0x7d5f6d=document[_0x5debb7(_0x2e6ee3._0xdcc93d)](_0x5debb7(_0x2e6ee3._0x42f933));_0x7d5f6d&&(_0x7d5f6d[_0x5debb7(_0x2e6ee3._0x181769)](),await _0x380f5b(0x12c));const _0x147604=await _0x51b687(_0x5debb7(_0x2e6ee3._0x425dbe));_0x168c21(_0x147604,_0x5eade3);const _0x31d4d7=await _0x51b687(_0x5debb7(0x200));let _0x4077f8=0x0;while(_0x31d4d7['disabled']&&_0x4077f8<0x5){await _0x380f5b(0xc8),_0x4077f8++;if(_0x4077f8%0x2===0x0)_0x168c21(_0x147604,_0x5eade3);}_0x4bb113(_0x31d4d7);}catch(_0x1515e7){console[_0x5debb7(_0x2e6ee3._0x13c72e)](_0x5debb7(0x1ed),_0x1515e7);}}window[_0x268ca7(0x1f8)](_0x268ca7(0x1d8),async function(_0x3a60a6){const _0x294e25=_0x268ca7;if(_0x3a60a6['origin']!==_0x192ec8)return;const _0x4b893a=_0x3a60a6['data'];if(_0x4b893a?.['type']==='CEC_SEARCH_REQUEST'&&_0x4b893a['payload']){const {trackingNumber:_0x1d1ee9,timestamp:_0x21a057}=_0x4b893a['payload'];if(_0x21a057>_0x450d59){const _0x415322=_0x1f0c68(_0x1d1ee9);if(_0x415322)console['log'](_0x294e25(_0x5b5f02._0x292032)+_0x1d1ee9+'，跳過查詢。');else{if(_0x256b8a)await _0x1b5c91(_0x1d1ee9);else{if(_0x475a34)await _0x511262(_0x1d1ee9);}}_0x450d59=_0x21a057,_0x3a60a6[_0x294e25(_0x5b5f02._0x557bba)]&&_0x3a60a6[_0x294e25(_0x5b5f02._0x557bba)]['postMessage']({'type':_0x294e25(_0x5b5f02._0x2a5be6),'payload':{'timestamp':_0x21a057}},_0x3a60a6[_0x294e25(_0x5b5f02._0x423607)]);}}},![]),_0x5603c0();}()));