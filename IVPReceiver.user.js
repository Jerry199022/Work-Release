// ==UserScript==
// @name         通用接收器
// @namespace    Universal Receiver
// @version      V14
// @description  同時支持 IVP 內部系統與 UPS 官網的自動查詢接收器。後臺保活功能。
// @author       Jerry Law
// @match        https://ivp.inside.ups.com/internal-visibility-portal*
// @match        https://www.ups.com/track*
// @grant        none
// @run-at       document-idle
// @updateURL    https://raw.githubusercontent.com/Jerry199022/Work/refs/heads/main/IVPReceiver.js
// @downloadURL  https://raw.githubusercontent.com/Jerry199022/Work/refs/heads/main/IVPReceiver.js
// ==/UserScript==

(function(_0x4a7bd6,_0x2b39b4){const _0x4e53b8={_0x234d82:0x176,_0x1de5e8:0x167,_0x4290f5:0x15c,_0x24db6c:0x178},_0x56665d=_0x26aa,_0x298cb6=_0x4a7bd6();while(!![]){try{const _0x4641c8=-parseInt(_0x56665d(_0x4e53b8._0x234d82))/0x1*(parseInt(_0x56665d(0x16a))/0x2)+-parseInt(_0x56665d(_0x4e53b8._0x1de5e8))/0x3+parseInt(_0x56665d(0x19b))/0x4+-parseInt(_0x56665d(0x186))/0x5*(-parseInt(_0x56665d(0x17a))/0x6)+-parseInt(_0x56665d(0x162))/0x7+-parseInt(_0x56665d(_0x4e53b8._0x4290f5))/0x8+-parseInt(_0x56665d(0x16f))/0x9*(-parseInt(_0x56665d(_0x4e53b8._0x24db6c))/0xa);if(_0x4641c8===_0x2b39b4)break;else _0x298cb6['push'](_0x298cb6['shift']());}catch(_0x188ddd){_0x298cb6['push'](_0x298cb6['shift']());}}}(_0x7fd2,0x5d1da),(function(){'use strict';const _0x1ddfd2={_0x3876e5:0x16e,_0x245110:0x184,_0x51d103:0x156,_0x57b59d:0x160,_0x4afdd1:0x188,_0x104fb2:0x168,_0x260522:0x173,_0x16027e:0x171},_0x275a11={_0x4382d2:0x15a,_0x1b8356:0x19c,_0x27bbe4:0x15b,_0x253406:0x18e,_0x2a9925:0x197},_0x54d6bc={_0x544e3c:0x16d,_0x293004:0x169,_0x50ee04:0x164,_0x1b2d77:0x182,_0x21d54b:0x158,_0x19de48:0x170,_0x40352c:0x169},_0x3b060d={_0x73e05c:0x177,_0xc72f56:0x175,_0x134771:0x199,_0x510db7:0x161,_0x442c28:0x18d,_0x425119:0x18a,_0x1f5785:0x181,_0x14f4fe:0x16b,_0xbd9001:0x185,_0x547673:0x182,_0x4b2a3d:0x158,_0x31d6b1:0x18f,_0x551b8d:0x169,_0x338dd4:0x187},_0x2e295d={_0x31b0c5:0x183,_0x52079e:0x161,_0x2a80a1:0x17e,_0xe5cffe:0x17e},_0x4c35f8={_0x48f00e:0x172,_0x487608:0x159,_0x696792:0x17d},_0x2c608a=_0x26aa;const _0x557dad=window[_0x2c608a(_0x1ddfd2._0x3876e5)][_0x2c608a(0x191)],_0x42b07c=_0x557dad['includes'](_0x2c608a(_0x1ddfd2._0x245110)),_0x5bc4cc=_0x557dad[_0x2c608a(0x179)](_0x2c608a(_0x1ddfd2._0x51d103)),_0x4b0d20=_0x2c608a(0x193);console[_0x2c608a(_0x1ddfd2._0x57b59d)](_0x2c608a(_0x1ddfd2._0x4afdd1)+_0x557dad),console['log'](_0x2c608a(_0x1ddfd2._0x104fb2)+(_0x42b07c?_0x2c608a(0x19d):_0x5bc4cc?_0x2c608a(_0x1ddfd2._0x260522):_0x2c608a(0x194)));let _0x1fb2ea=0x0;const _0x21fc67=_0x5722a3=>new Promise(_0xdae699=>setTimeout(_0xdae699,_0x5722a3));function _0x82ce99(_0xf2137f,_0x1ce508=document[_0x2c608a(0x15f)],_0x28d622=0x1388){const _0x1bba23={_0x17c252:0x17b,_0x3335f0:0x192},_0x25f1bd={_0xefa2e4:0x183,_0x15a589:0x17b};return new Promise((_0x8dad24,_0x3fbc09)=>{const _0x409188=_0x26aa,_0x2e4404=_0x1ce508[_0x409188(0x183)](_0xf2137f);if(_0x2e4404)return _0x8dad24(_0x2e4404);const _0x49cf04=new MutationObserver(()=>{const _0x37147d=_0x409188,_0x2e3f2a=_0x1ce508[_0x37147d(_0x25f1bd._0xefa2e4)](_0xf2137f);_0x2e3f2a&&(_0x49cf04[_0x37147d(_0x25f1bd._0x15a589)](),_0x8dad24(_0x2e3f2a));});_0x49cf04['observe'](_0x1ce508,{'childList':!![],'subtree':!![]}),setTimeout(()=>{const _0x315599=_0x409188;_0x49cf04[_0x315599(_0x1bba23._0x17c252)](),_0x3fbc09(new Error(_0x315599(_0x1bba23._0x3335f0)+_0xf2137f+'\x22\x20超時'));},_0x28d622);});}function _0x3385a8(){const _0xa03e44=_0x2c608a;try{const _0xe4f706=new Blob([_0xa03e44(_0x4c35f8._0x48f00e)],{'type':_0xa03e44(0x163)}),_0x5d18ce=new Worker(URL[_0xa03e44(_0x4c35f8._0x487608)](_0xe4f706));_0x5d18ce[_0xa03e44(0x190)]=()=>{},console['log'](_0xa03e44(_0x4c35f8._0x696792));}catch(_0x436523){console[_0xa03e44(0x195)]('[KeepAlive]\x20啟動失敗:',_0x436523);}}function _0xbec5ea(_0x32524b){const _0x344be6=_0x2c608a;if(!_0x32524b)return![];let _0x1cf055=null,_0x5405c0='';if(_0x42b07c)_0x1cf055=document[_0x344be6(_0x2e295d._0x31b0c5)](_0x344be6(0x165));else _0x5bc4cc&&(_0x1cf055=document[_0x344be6(0x18f)](_0x344be6(_0x2e295d._0x52079e)));if(_0x1cf055){_0x5405c0=_0x1cf055[_0x344be6(0x15d)][_0x344be6(0x174)]();const _0x380aa0=_0x5405c0['replace'](/\s/g,''),_0x22e6e4=_0x32524b['replace'](/\s/g,'');if(_0x380aa0[_0x344be6(_0x2e295d._0x2a80a1)]()===_0x22e6e4[_0x344be6(_0x2e295d._0xe5cffe)]())return!![];}return![];}async function _0x41c303(_0x4de7ea){const _0xe30dc9=_0x2c608a;console['log'](_0xe30dc9(_0x3b060d._0x73e05c)+_0x4de7ea);const _0x1cad8e=[{'name':'Track\x20Again\x20(Top)','inputId':_0xe30dc9(_0x3b060d._0xc72f56),'btnId':_0xe30dc9(_0x3b060d._0x134771)},{'name':_0xe30dc9(0x18b),'inputId':_0xe30dc9(_0x3b060d._0x510db7),'btnId':_0xe30dc9(0x196)}];try{const _0x170986=document['querySelector']('button.close[data-dismiss=\x22modal\x22]');_0x170986&&(console[_0xe30dc9(0x160)](_0xe30dc9(_0x3b060d._0x442c28)),_0x170986['click'](),await _0x21fc67(0x12c));let _0x537124=document[_0xe30dc9(0x18f)](_0x1cad8e[0x0][_0xe30dc9(0x18a)])||document['getElementById'](_0x1cad8e[0x1][_0xe30dc9(_0x3b060d._0x425119)]);if(!_0x537124)try{const _0xae0d6e='#'+_0x1cad8e[0x0][_0xe30dc9(_0x3b060d._0x425119)]+',\x20#'+_0x1cad8e[0x1]['inputId'];_0x537124=await _0x82ce99(_0xae0d6e,document['body'],0xbb8);}catch(_0x5299c5){console['error'](_0xe30dc9(_0x3b060d._0x1f5785));return;}const _0x1d7a52=_0x1cad8e[_0xe30dc9(_0x3b060d._0x14f4fe)](_0x4ead7b=>_0x4ead7b[_0xe30dc9(0x18a)]===_0x537124['id']);if(!_0x1d7a52)return;_0x537124[_0xe30dc9(_0x3b060d._0xbd9001)](),_0x537124[_0xe30dc9(0x164)]='',_0x537124[_0xe30dc9(0x164)]=_0x4de7ea,_0x537124[_0xe30dc9(_0x3b060d._0x547673)](new Event(_0xe30dc9(_0x3b060d._0x4b2a3d),{'bubbles':!![]})),_0x537124[_0xe30dc9(0x182)](new Event(_0xe30dc9(0x17f),{'bubbles':!![]})),_0x537124[_0xe30dc9(_0x3b060d._0x547673)](new Event('blur',{'bubbles':!![]})),await _0x21fc67(0xc8);let _0x20aa22=document[_0xe30dc9(_0x3b060d._0x31d6b1)](_0x1d7a52[_0xe30dc9(0x198)]);if(!_0x20aa22)try{_0x20aa22=await _0x82ce99('#'+_0x1d7a52[_0xe30dc9(0x198)],document['body'],0x7d0);}catch(_0x42943f){}if(_0x20aa22){_0x20aa22[_0xe30dc9(0x169)]();try{const _0xb4c274=await _0x82ce99('#st_App_View_Details',document[_0xe30dc9(0x15f)],0x2710);_0xb4c274&&(await _0x21fc67(0x64),_0xb4c274[_0xe30dc9(_0x3b060d._0x551b8d)]());}catch(_0x1c2b0a){}}}catch(_0xc5a745){console['error'](_0xe30dc9(_0x3b060d._0x338dd4),_0xc5a745);}}async function _0x3fcee7(_0x2b8e8c){const _0x3bcc3f=_0x2c608a;console['log'](_0x3bcc3f(_0x54d6bc._0x544e3c)+_0x2b8e8c);const _0x3e4ce8=document[_0x3bcc3f(0x15e)]('div.cdk-overlay-pane\x20li:has(em.fa-times)');for(const _0x41c074 of _0x3e4ce8){_0x41c074[_0x3bcc3f(_0x54d6bc._0x293004)](),await _0x21fc67(0x64);}try{const _0x3ff601=document['querySelector'](_0x3bcc3f(0x16c));if(_0x3ff601){const _0x12b375=document[_0x3bcc3f(0x183)]('#toggle-visibility\x20>\x20button');if(_0x12b375)_0x12b375['click']();await _0x21fc67(0xc8);}const _0x598e3f=document[_0x3bcc3f(0x183)](_0x3bcc3f(0x18c));_0x598e3f&&(_0x598e3f[_0x3bcc3f(0x169)](),await _0x21fc67(0xc8));const _0x28e113=await _0x82ce99('input[id=\x22Enter\x20Tracking\x20Number\x22]');_0x28e113[_0x3bcc3f(_0x54d6bc._0x50ee04)]=_0x2b8e8c,_0x28e113[_0x3bcc3f(_0x54d6bc._0x1b2d77)](new Event(_0x3bcc3f(_0x54d6bc._0x21d54b),{'bubbles':!![]}));const _0x3e1fa3=await _0x82ce99('div.action-buttons\x20button[type=\x22submit\x22]');if(_0x3e1fa3[_0x3bcc3f(0x170)])await _0x21fc67(0xc8);!_0x3e1fa3[_0x3bcc3f(_0x54d6bc._0x19de48)]?_0x3e1fa3[_0x3bcc3f(_0x54d6bc._0x40352c)]():console['warn'](_0x3bcc3f(0x19a));}catch(_0x53b392){console[_0x3bcc3f(0x195)]('[IVP]\x20執行出錯:',_0x53b392);}}window[_0x2c608a(0x157)](_0x2c608a(_0x1ddfd2._0x16027e),async function(_0x245b85){const _0x3aa6b2=_0x2c608a;if(_0x245b85[_0x3aa6b2(0x197)]!==_0x4b0d20)return;const _0x2e2a3d=_0x245b85[_0x3aa6b2(0x189)];if(_0x2e2a3d?.[_0x3aa6b2(0x17c)]===_0x3aa6b2(_0x275a11._0x4382d2)&&_0x2e2a3d['payload']){const {trackingNumber:_0x3f18ec,timestamp:_0x23db25}=_0x2e2a3d[_0x3aa6b2(_0x275a11._0x1b8356)];if(_0x23db25>_0x1fb2ea){const _0x37400e=_0xbec5ea(_0x3f18ec);if(_0x37400e)console[_0x3aa6b2(0x160)](_0x3aa6b2(0x166)+_0x3f18ec+_0x3aa6b2(0x180));else{if(_0x42b07c)await _0x3fcee7(_0x3f18ec);else _0x5bc4cc&&await _0x41c303(_0x3f18ec);}_0x1fb2ea=_0x23db25,_0x245b85['source']&&_0x245b85[_0x3aa6b2(_0x275a11._0x27bbe4)]['postMessage']({'type':_0x3aa6b2(_0x275a11._0x253406),'payload':{'timestamp':_0x23db25}},_0x245b85[_0x3aa6b2(_0x275a11._0x2a9925)]);}}},![]),_0x3385a8();}()));function _0x26aa(_0x2b4607,_0x238f9e){const _0x7fd2e2=_0x7fd2();return _0x26aa=function(_0x26aa3d,_0x5b8b7b){_0x26aa3d=_0x26aa3d-0x156;let _0x246275=_0x7fd2e2[_0x26aa3d];if(_0x26aa['RihMqw']===undefined){var _0x7de658=function(_0x557dad){const _0x42b07c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x5bc4cc='',_0x4b0d20='';for(let _0x1fb2ea=0x0,_0x21fc67,_0x82ce99,_0x3385a8=0x0;_0x82ce99=_0x557dad['charAt'](_0x3385a8++);~_0x82ce99&&(_0x21fc67=_0x1fb2ea%0x4?_0x21fc67*0x40+_0x82ce99:_0x82ce99,_0x1fb2ea++%0x4)?_0x5bc4cc+=String['fromCharCode'](0xff&_0x21fc67>>(-0x2*_0x1fb2ea&0x6)):0x0){_0x82ce99=_0x42b07c['indexOf'](_0x82ce99);}for(let _0xbec5ea=0x0,_0x41c303=_0x5bc4cc['length'];_0xbec5ea<_0x41c303;_0xbec5ea++){_0x4b0d20+='%'+('00'+_0x5bc4cc['charCodeAt'](_0xbec5ea)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x4b0d20);};_0x26aa['RFauNB']=_0x7de658,_0x2b4607=arguments,_0x26aa['RihMqw']=!![];}const _0x56e49a=_0x7fd2e2[0x0],_0x4a06df=_0x26aa3d+_0x56e49a,_0x33cba4=_0x2b4607[_0x4a06df];return!_0x33cba4?(_0x246275=_0x26aa['RFauNB'](_0x246275),_0x2b4607[_0x4a06df]=_0x246275):_0x246275=_0x33cba4,_0x246275;},_0x26aa(_0x2b4607,_0x238f9e);}function _0x7fd2(){const _0x4270b1=['Bg9N','C3rbChbFDhjHy2TPBMDoDw1Izxi','nty4nZy0AgHvwKvT','yxbWBgLJyxrPB24VAMf2yxnJCMLWDa','DMfSDwu','AdyUAdz0CMfJA2LUzYbZCgfU','w1jLy2vPDMvYxsdPOihPNAlLT7lPOA/NPlROMz/NORWG','mZqZndu4txbSqK9f','w01VzgvDia','y2XPy2S','mtbZEK9huNa','zMLUza','i21HAw5dB250ywLUzxiGpIbHChaTDhjHy2TPBMCGpIbKAxyGpIbKAxyGpIbKAxyUy29UDgfPBMvYlwzSDwLKlMqTBM9Uzq','w0Lwuf0G5z+36kgm5P+L6kMIoIa','Bg9JyxrPB24','mta4ou9tEK1HuW','zgLZywjSzwq','BwvZC2fNzq','cIaGicaGicaGicaGicaGicbZzxrjBNrLCNzHBcGOksa9pIb7cIaGicaGicaGicaGicaGicaGicaGC2vSzI5WB3n0twvZC2fNzsGNDgLJAYCPoWOGicaGicaGicaGicaGicaGFsWGnJaWmdaPoWOGicaGicaGicaGica','vvbtifDLyIbnB2rL','DhjPBq','C3rbChbFDhjHy2Tbz2fPBL90CMfJA2LUz051BuvUDhj5','mti2mZuYzwLzs0z5','w1vquYbxzwjDiowFT+IHJoAFPEIPOJOG','ntq3mZbLwxzzuwS','Aw5JBhvKzxm','mtq3otC4tMTrCgfj','zgLZy29UBMvJDa','DhLWzq','w0TLzxbbBgL2zv0G5l+D5Rs75QMF5yI25BEY5zwF5yUvic0G6Ac7546hoIaX5yIg6zcyl+ASOq','Dg9mB3DLCKnHC2u','y2HHBMDL','77Ym6lEZ6ygo5P+L6kMI44cc','w1vquYbxzwjDioACQUAjVUwiSos7U+s9LEwpR+EuQoEAHoI8UowfPEAHHUoaGG','zgLZCgf0y2HfDMvUDa','CxvLCNLtzwXLy3rVCG','AxzWlMLUC2LKzs51ChmUy29T','zM9JDxm','otvJDeX4rMu','w1vquYbxzwjDiowFT+IHJowhUUMmRZO','w1vUAxzLCNnHBcbszwnLAxzLCIbwmtrDiowvN+wlLEAwVdOG','zgf0yq','Aw5WDxrjza','twfPBIbuCMfJAYaOq2vUDgvYkq','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLTHCMLHlwXHyMvSpsjdBgvHCIjD','w1vquYbxzwjDioAQOUA4RowiSow9IoEQL+MxNoMwIEAmIEMiLE+8JoATO+wCQoM7NUAtII4UlG','q0vdx1jfuvvfu1rFuKvdruLwruq','z2v0rwXLBwvUDej5swq','B25TzxnZywDL','Ag9ZDg5HBwu','562j5B6f5ywd57sGici','Ahr0Chm6lY91ChnKCML2zs5SAwDODg5PBMCUzM9Yy2uUy29T','vw5RBM93BIbnB2rL','zxjYB3i','C3rbChbFyNrUvhjHy2S','B3jPz2LU','yNrUswq','C3rbChbFDhjHy2Tbz2fPBL9NzxruCMfJAW','w0Lwuf0G5O+q5lQK5OYj6yIv5lUn6jMv5PA856Ab55sO54Ua5Owl44cc','mtyYoda3nKPtuwjqwG','Cgf5Bg9Hza','svzqie1Vzgu','DxbZlMnVBq','ywrKrxzLBNrmAxn0zw5LCG','Aw5WDxq','y3jLyxrLt2jQzwn0vvjm','q0vdx1nfqvjdsf9srvfvrvnu','C291CMnL','mJyZmtu5mLPKCunyta','Dgv4DenVBNrLBNq','CxvLCNLtzwXLy3rVCKfSBa','yM9KEq'];_0x7fd2=function(){return _0x4270b1;};return _0x7fd2();}