// ==UserScript==
// @name         通用接收器
// @namespace    Universal Receiver
// @version      V21
// @description  同時支持 IVP 內部系統與 UPS 官網的自動查詢接收器。修復後台UPS官網因自身腳本崩潰導致按鈕無法點擊的問題(V21: 強制解鎖模式)。
// @author       Jerry Law
// @match        https://ivp.inside.ups.com/internal-visibility-portal*
// @match        https://www.ups.com/track*
// @grant        none
// @run-at       document-idle
// @updateURL    https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// @downloadURL  https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// ==/UserScript==

(function(_0x4d0fcb,_0x141950){const _0x1439b4={_0x2bb179:0x1f4,_0x3943f3:0x1d5,_0x3a7094:0x1f1,_0xe7d582:0x1c7,_0x326eb5:0x1d7,_0x41f36f:0x1f7,_0x528f99:0x1ca,_0x52792a:0x205},_0x36fe1d=_0x5204,_0x5df128=_0x4d0fcb();while(!![]){try{const _0x391072=parseInt(_0x36fe1d(0x210))/0x1+-parseInt(_0x36fe1d(_0x1439b4._0x2bb179))/0x2*(-parseInt(_0x36fe1d(_0x1439b4._0x3943f3))/0x3)+-parseInt(_0x36fe1d(_0x1439b4._0x3a7094))/0x4*(parseInt(_0x36fe1d(_0x1439b4._0xe7d582))/0x5)+parseInt(_0x36fe1d(0x203))/0x6*(-parseInt(_0x36fe1d(0x1c8))/0x7)+parseInt(_0x36fe1d(0x1c9))/0x8*(parseInt(_0x36fe1d(_0x1439b4._0x326eb5))/0x9)+-parseInt(_0x36fe1d(_0x1439b4._0x41f36f))/0xa*(-parseInt(_0x36fe1d(_0x1439b4._0x528f99))/0xb)+-parseInt(_0x36fe1d(_0x1439b4._0x52792a))/0xc;if(_0x391072===_0x141950)break;else _0x5df128['push'](_0x5df128['shift']());}catch(_0x5a8fde){_0x5df128['push'](_0x5df128['shift']());}}}(_0x331e,0x7f99b),(function(){'use strict';const _0x587468={_0x13e2ec:0x1d1,_0x4de37b:0x1c3,_0x168ca2:0x1c4,_0x1b7271:0x1cf},_0x1083e2={_0x1aa9e1:0x204,_0x1e5560:0x1cb,_0x1ec12d:0x1cf,_0x4cf0bb:0x206,_0x2ac6a2:0x20b,_0x5140a0:0x1e8},_0x10cb6a={_0x37cb78:0x1cf,_0x5b88c5:0x1db,_0x7b045e:0x202,_0x3df35e:0x1f2,_0x3a9f29:0x20e,_0x5e5091:0x1f8,_0x499801:0x20f},_0x2881bc={_0x26faf4:0x1d4,_0x3d7411:0x1d2,_0x1a53d2:0x1e0,_0x162a96:0x1f2,_0x4a0060:0x1f9,_0x43926e:0x1d0,_0x2367af:0x1d0,_0x5be5ed:0x1d0,_0xbd8ae0:0x1d9,_0x35759a:0x1ef,_0x2e3b93:0x1f5},_0x8c4ccd={_0x53d243:0x20a,_0x5ad1bd:0x1e7,_0x5c5a0f:0x1e7},_0x4074d5={_0x2f6de0:0x201,_0x305029:0x208,_0x5a1508:0x20c},_0x788370={_0x4c173e:0x209,_0x2603d7:0x1d8,_0x362328:0x1eb},_0xf85b56={_0x4086f2:0x1fd,_0xda404:0x1ec,_0x10bb12:0x1e5,_0xb65744:0x1e6,_0x4379a4:0x1ce,_0x10e109:0x1da,_0x2026e0:0x1dd,_0x287cce:0x200,_0x3bf8c5:0x1fe,_0x4b1b79:0x1da},_0x27a229={_0x4dbe7d:0x1df},_0x45baad=_0x5204;const _0x45b308=window[_0x45baad(_0x587468._0x13e2ec)]['hostname'],_0x48dc23=_0x45b308[_0x45baad(_0x587468._0x4de37b)]('ivp.inside.ups.com'),_0x27682a=_0x45b308[_0x45baad(0x1c3)](_0x45baad(0x1ee)),_0x14c8c0=_0x45baad(_0x587468._0x168ca2);console[_0x45baad(_0x587468._0x1b7271)](_0x45baad(0x1ff)+_0x45b308+'\x20(強制解鎖模式)');let _0x15496c=0x0;const _0x536218=_0x4b1254=>new Promise(_0x2e460c=>setTimeout(_0x2e460c,_0x4b1254));function _0x282b6e(_0x1d2403,_0x10629a=document[_0x45baad(0x1d9)],_0x59362e=0x1388){return new Promise((_0x3faba8,_0x13ef99)=>{const _0x1ad637={_0x2ca0ce:0x1fc,_0x465360:0x1e3},_0x2ac11c=_0x5204,_0x366690=_0x10629a[_0x2ac11c(0x202)](_0x1d2403);if(_0x366690)return _0x3faba8(_0x366690);const _0x845116=new MutationObserver(()=>{const _0x33eb51=_0x2ac11c,_0x53ce84=_0x10629a['querySelector'](_0x1d2403);_0x53ce84&&(_0x845116[_0x33eb51(0x1fc)](),_0x3faba8(_0x53ce84));});_0x845116[_0x2ac11c(_0x27a229._0x4dbe7d)](_0x10629a,{'childList':!![],'subtree':!![]}),setTimeout(()=>{const _0x5d67d2=_0x2ac11c;_0x845116[_0x5d67d2(_0x1ad637._0x2ca0ce)](),_0x13ef99(new Error(_0x5d67d2(_0x1ad637._0x465360)+_0x1d2403+_0x5d67d2(0x1f0)));},_0x59362e);});}function _0x3f3453(_0x1a0add,_0x77bfef){const _0xbd760=_0x45baad;if(!_0x1a0add)return;const _0x33ce93=document['hidden'];if(!_0x33ce93)try{_0x1a0add[_0xbd760(0x1c5)]();}catch(_0xf93fbe){}try{const _0x56078c=Object[_0xbd760(_0xf85b56._0x4086f2)](window[_0xbd760(_0xf85b56._0xda404)][_0xbd760(_0xf85b56._0x10bb12)],_0xbd760(_0xf85b56._0xb65744))[_0xbd760(0x1e9)];_0x56078c[_0xbd760(0x1fa)](_0x1a0add,_0x77bfef);}catch(_0x1cc580){_0x1a0add[_0xbd760(_0xf85b56._0xb65744)]=_0x77bfef;}if(_0x1a0add['value']!==_0x77bfef)_0x1a0add[_0xbd760(0x1e6)]=_0x77bfef;if(_0x33ce93)_0x1a0add[_0xbd760(0x1ce)](new Event('input',{'bubbles':!![]})),_0x1a0add[_0xbd760(_0xf85b56._0x4379a4)](new Event('change',{'bubbles':!![]})),_0x1a0add['dispatchEvent'](new Event(_0xbd760(_0xf85b56._0x10e109),{'bubbles':!![]}));else{const _0x2c0911=[new KeyboardEvent(_0xbd760(0x207),{'bubbles':!![],'key':'Process'}),new KeyboardEvent('keypress',{'bubbles':!![],'key':_0xbd760(_0xf85b56._0x2026e0)}),new Event(_0xbd760(_0xf85b56._0x287cce),{'bubbles':!![]}),new Event(_0xbd760(_0xf85b56._0x3bf8c5),{'bubbles':!![]}),new KeyboardEvent(_0xbd760(0x1cc),{'bubbles':!![],'key':_0xbd760(0x1dd)}),new Event(_0xbd760(_0xf85b56._0x4b1b79),{'bubbles':!![]})];_0x2c0911[_0xbd760(0x1cd)](_0x434fcf=>_0x1a0add[_0xbd760(0x1ce)](_0x434fcf));}}function _0x3a65f8(_0x536f84){const _0x1004d8=_0x45baad;if(!_0x536f84)return;_0x536f84[_0x1004d8(0x1de)](_0x1004d8(_0x788370._0x4c173e)),_0x536f84['classList']['remove'](_0x1004d8(0x209)),_0x536f84['setAttribute'](_0x1004d8(_0x788370._0x2603d7),_0x1004d8(0x1f6)),_0x536f84['style'][_0x1004d8(0x1e4)]=_0x1004d8(_0x788370._0x362328),_0x536f84['click']();}function _0x5c910d(){const _0x2bd322=_0x45baad;try{const _0x521fc3=new Blob([_0x2bd322(0x1d3)],{'type':_0x2bd322(_0x4074d5._0x2f6de0)}),_0x4e3a27=new Worker(URL[_0x2bd322(_0x4074d5._0x305029)](_0x521fc3));_0x4e3a27['onmessage']=()=>{};}catch(_0x590154){console['error'](_0x2bd322(_0x4074d5._0x5a1508),_0x590154);}}function _0x294e94(_0x1f43d3){const _0x2e6526=_0x45baad;if(!_0x1f43d3)return![];let _0x598e42=null;if(_0x48dc23)_0x598e42=document[_0x2e6526(0x202)](_0x2e6526(0x1d6));else{if(_0x27682a)_0x598e42=document[_0x2e6526(0x1f9)](_0x2e6526(_0x8c4ccd._0x53d243));}if(_0x598e42){const _0x415094=_0x598e42[_0x2e6526(0x211)]['trim']()[_0x2e6526(_0x8c4ccd._0x5ad1bd)](/\s/g,''),_0x3c1af2=_0x1f43d3[_0x2e6526(_0x8c4ccd._0x5c5a0f)](/\s/g,'');if(_0x415094[_0x2e6526(0x20d)]()===_0x3c1af2['toLowerCase']())return!![];}return![];}async function _0x2a514e(_0x2559c2){const _0x40a733=_0x45baad;console[_0x40a733(0x1cf)]('[UPS\x20Web]\x20執行查詢:\x20'+_0x2559c2+_0x40a733(_0x2881bc._0x26faf4)+document['hidden']+')');const _0x1243aa=[{'name':'Track\x20Again\x20(Top)','inputId':'stApp_trackAgain_trackingNumEntry','btnId':_0x40a733(0x1f3)},{'name':_0x40a733(_0x2881bc._0x3d7411),'inputId':_0x40a733(0x20a),'btnId':_0x40a733(_0x2881bc._0x1a53d2)}];try{const _0x23a681=document[_0x40a733(0x202)](_0x40a733(0x1ea));_0x23a681&&(_0x23a681[_0x40a733(_0x2881bc._0x162a96)](),await _0x536218(0x12c));let _0x380701=document[_0x40a733(_0x2881bc._0x4a0060)](_0x1243aa[0x0][_0x40a733(_0x2881bc._0x43926e)])||document[_0x40a733(0x1f9)](_0x1243aa[0x1]['inputId']);if(!_0x380701)try{const _0x2e431e='#'+_0x1243aa[0x0][_0x40a733(_0x2881bc._0x2367af)]+',\x20#'+_0x1243aa[0x1][_0x40a733(_0x2881bc._0x5be5ed)];_0x380701=await _0x282b6e(_0x2e431e,document[_0x40a733(_0x2881bc._0xbd8ae0)],0xbb8);}catch(_0x546e12){return;}const _0x334227=_0x1243aa['find'](_0x3eaaf0=>_0x3eaaf0[_0x40a733(0x1d0)]===_0x380701['id']);if(!_0x334227)return;_0x3f3453(_0x380701,_0x2559c2),await _0x536218(0x1f4);let _0x4993fe=document[_0x40a733(_0x2881bc._0x4a0060)](_0x334227[_0x40a733(_0x2881bc._0x35759a)]);if(!_0x4993fe)try{_0x4993fe=await _0x282b6e('#'+_0x334227['btnId'],document[_0x40a733(0x1d9)],0x7d0);}catch(_0x1ae2f8){}if(_0x4993fe){console[_0x40a733(0x1cf)](_0x40a733(0x1ed)),_0x3a65f8(_0x4993fe),await _0x536218(0x1f4),_0x3a65f8(_0x4993fe);try{const _0x12261f=await _0x282b6e(_0x40a733(_0x2881bc._0x2e3b93),document[_0x40a733(0x1d9)],0x1f40);_0x12261f&&(await _0x536218(0xc8),_0x12261f[_0x40a733(0x1f2)]());}catch(_0x16c5d8){}}}catch(_0x22cd9d){console['error']('[UPS\x20Web]\x20執行出錯:',_0x22cd9d);}}async function _0x56952a(_0x4ad280){const _0x1d0a3a=_0x45baad;console[_0x1d0a3a(_0x10cb6a._0x37cb78)]('[IVP]\x20執行查詢:\x20'+_0x4ad280+'\x20(Hidden:\x20'+document[_0x1d0a3a(0x1c6)]+')');const _0x2fdb09=document[_0x1d0a3a(0x1fb)](_0x1d0a3a(_0x10cb6a._0x5b88c5));for(const _0x31cae9 of _0x2fdb09){_0x31cae9[_0x1d0a3a(0x1f2)](),await _0x536218(0x64);}try{const _0x242839=document['querySelector']('#mainContainer\x20>\x20app-tracking\x20>\x20div\x20>\x20div\x20>\x20div.container-fluid.d-none');if(_0x242839){const _0x361725=document[_0x1d0a3a(_0x10cb6a._0x7b045e)](_0x1d0a3a(0x212));if(_0x361725)_0x361725[_0x1d0a3a(_0x10cb6a._0x3df35e)]();await _0x536218(0x12c);}const _0x5b399c=document[_0x1d0a3a(_0x10cb6a._0x7b045e)](_0x1d0a3a(_0x10cb6a._0x3a9f29));_0x5b399c&&(_0x5b399c[_0x1d0a3a(_0x10cb6a._0x3df35e)](),await _0x536218(0x12c));const _0x21d794=await _0x282b6e(_0x1d0a3a(0x1dc));_0x3f3453(_0x21d794,_0x4ad280);const _0x5687e3=await _0x282b6e(_0x1d0a3a(_0x10cb6a._0x5e5091));let _0x24acb9=0x0;while(_0x5687e3['disabled']&&_0x24acb9<0x5){await _0x536218(0xc8),_0x24acb9++;if(_0x24acb9%0x2===0x0)_0x3f3453(_0x21d794,_0x4ad280);}_0x3a65f8(_0x5687e3);}catch(_0x4a2ab3){console[_0x1d0a3a(_0x10cb6a._0x499801)]('[IVP]\x20執行出錯:',_0x4a2ab3);}}window[_0x45baad(0x1e1)]('message',async function(_0x3b11e3){const _0x156ba3=_0x45baad;if(_0x3b11e3['origin']!==_0x14c8c0)return;const _0xdfe271=_0x3b11e3[_0x156ba3(0x1e2)];if(_0xdfe271?.[_0x156ba3(_0x1083e2._0x1aa9e1)]==='CEC_SEARCH_REQUEST'&&_0xdfe271[_0x156ba3(_0x1083e2._0x1e5560)]){const {trackingNumber:_0x35cbbc,timestamp:_0x3e949c}=_0xdfe271[_0x156ba3(_0x1083e2._0x1e5560)];if(_0x3e949c>_0x15496c){const _0x5ed0a7=_0x294e94(_0x35cbbc);if(_0x5ed0a7)console[_0x156ba3(_0x1083e2._0x1ec12d)]('[Receiver]\x20頁面已顯示號碼\x20'+_0x35cbbc+_0x156ba3(_0x1083e2._0x4cf0bb));else{if(_0x48dc23)await _0x56952a(_0x35cbbc);else{if(_0x27682a)await _0x2a514e(_0x35cbbc);}}_0x15496c=_0x3e949c,_0x3b11e3[_0x156ba3(0x20b)]&&_0x3b11e3[_0x156ba3(_0x1083e2._0x2ac6a2)]['postMessage']({'type':_0x156ba3(_0x1083e2._0x5140a0),'payload':{'timestamp':_0x3e949c}},_0x3b11e3['origin']);}}},![]),_0x5c910d();}()));function _0x5204(_0x1853eb,_0x1e8be4){const _0x331e1c=_0x331e();return _0x5204=function(_0x520439,_0x54ff51){_0x520439=_0x520439-0x1c3;let _0x52ace1=_0x331e1c[_0x520439];if(_0x5204['XYXFYs']===undefined){var _0x5ba12d=function(_0x45b308){const _0x48dc23='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x27682a='',_0x14c8c0='';for(let _0x15496c=0x0,_0x536218,_0x282b6e,_0x3f3453=0x0;_0x282b6e=_0x45b308['charAt'](_0x3f3453++);~_0x282b6e&&(_0x536218=_0x15496c%0x4?_0x536218*0x40+_0x282b6e:_0x282b6e,_0x15496c++%0x4)?_0x27682a+=String['fromCharCode'](0xff&_0x536218>>(-0x2*_0x15496c&0x6)):0x0){_0x282b6e=_0x48dc23['indexOf'](_0x282b6e);}for(let _0x3a65f8=0x0,_0x5c910d=_0x27682a['length'];_0x3a65f8<_0x5c910d;_0x3a65f8++){_0x14c8c0+='%'+('00'+_0x27682a['charCodeAt'](_0x3a65f8)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x14c8c0);};_0x5204['HSFDPo']=_0x5ba12d,_0x1853eb=arguments,_0x5204['XYXFYs']=!![];}const _0x4f6335=_0x331e1c[0x0],_0x578569=_0x520439+_0x4f6335,_0x15ac2e=_0x1853eb[_0x578569];return!_0x15ac2e?(_0x52ace1=_0x5204['HSFDPo'](_0x52ace1),_0x1853eb[_0x578569]=_0x52ace1):_0x52ace1=_0x15ac2e,_0x52ace1;},_0x5204(_0x1853eb,_0x1e8be4);}function _0x331e(){const _0x4a250f=['Bg9JyxrPB24','twfPBIbuCMfJAYaOq2vUDgvYkq','C2v0sw50zxj2ywWOkcKGpt4GC2vSzI5WB3n0twvZC2fNzsGNDgLJAYCPlcaYntaPoW','icHiAwrKzw46ia','mtiZotz2D25kr0C','AdyUAdz0CMfJA2LUzYbZCgfU','mJDwuhLgyKi','yxjPys1KAxnHyMXLza','yM9KEq','yMX1CG','zgL2lMnKAY1VDMvYBgf5lxbHBMuGBgK6AgfZkgvTlMzHlxrPBwvZkq','Aw5WDxrBAwq9iKvUDgvYifrYywnRAw5Nie51BwjLCIjD','uhjVy2vZCW','CMvTB3zLqxr0CMLIDxrL','B2jZzxj2zq','C3rbChbFyNrUvhjHy2S','ywrKrxzLBNrmAxn0zw5LCG','zgf0yq','562j5B6f5ywd57sGici','yM9YzgvY','ChjVDg90ExbL','DMfSDwu','CMvWBgfJzq','q0vdx1jfuvvfu1rFuKvdruLwruq','C2v0','yNv0Dg9UlMnSB3nLw2rHDgeTzgLZBwLZCZ0IBw9KywWIxq','mNb4ihnVBgLKihjLza','sfrnteLUChv0rwXLBwvUDa','w1vquYbxzwjDiowyL+IPPUw8T+wiTUM7NUAtII4UlG','DxbZlMnVBq','yNrUswq','iIdOTOxMMyi','mte4mJHkD1rlthO','y2XPy2S','C3rbChbFDhjHy2Tbz2fPBL9NzxruCMfJAW','mJiWs2nNvuP5','i3n0x0fWCf9wAwv3x0rLDgfPBhm','zMfSC2u','mti4otbOEhvhvKi','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLT0ExbLpsjZDwjTAxqIxq','z2v0rwXLBwvUDej5swq','y2fSBa','CxvLCNLtzwXLy3rVCKfSBa','zgLZy29UBMvJDa','z2v0t3DUuhjVCgvYDhLezxnJCMLWDg9Y','y2HHBMDL','w1vUAxzLCNnHBcbszwnLAxzLCIbwmJfDiowvN+wlLEAwVdOG','Aw5WDxq','yxbWBgLJyxrPB24VAMf2yxnJCMLWDa','CxvLCNLtzwXLy3rVCG','mZq2mMPSAu5MyW','DhLWzq','mti0mZa5mdHJBfLhC1K','77Ym6lEZ6ygo5P+L6kMI44cc','A2v5zg93BG','y3jLyxrLt2jQzwn0vvjm','zgLZywjSzwq','C3rbChbFDhjHy2TPBMDoDw1Izxi','C291CMnL','w0TLzxbbBgL2zv0GrxjYB3i6','Dg9mB3DLCKnHC2u','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLTHCMLHlwXHyMvSpsjdBgvHCIjD','zxjYB3i','ndK3nduYBMzXB1zw','Dgv4DenVBNrLBNq','i3rVz2DSzs12AxnPyMLSAxr5id4GyNv0Dg9U','Aw5JBhvKzxm','Ahr0Chm6lY91ChnKCML2zs5SAwDODg5PBMCUzM9Yy2uUy29T','zM9JDxm','AgLKzgvU','odq1yxzoEKXO','mtm3ovv0yKHjrW','ntK2mJq4z2jRCuXm','oduWm29rDhPOAq','Cgf5Bg9Hza','A2v5Dxa','zM9YrwfJAa','zgLZCgf0y2HfDMvUDa','Bg9N','Aw5WDxrjza'];_0x331e=function(){return _0x4a250f;};return _0x331e();}