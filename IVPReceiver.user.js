// ==UserScript==
// @name         通用接收器
// @namespace    Universal Receiver
// @version      V21
// @description  同時支持 IVP 內部系統與 UPS 官網的自動查詢接收器。修復後台UPS官網因自身腳本崩潰導致按鈕無法點擊的問題(V21: 強制解鎖模式)。
// @author       Jerry Law
// @match        https://ivp.inside.ups.com/internal-visibility-portal*
// @match        https://www.ups.com/track*
// @grant        none
// @run-at       document-idle
// @updateURL    https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// @downloadURL  https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// ==/UserScript==

function _0x5e50(_0x40bbb6,_0x57013d){const _0x2e4377=_0x2e43();return _0x5e50=function(_0x5e5056,_0x752c98){_0x5e5056=_0x5e5056-0x1cf;let _0x5150c2=_0x2e4377[_0x5e5056];if(_0x5e50['SkupTX']===undefined){var _0x455612=function(_0x2b8cae){const _0x121996='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x328073='',_0x3dcf97='';for(let _0x55b3bc=0x0,_0x124ad1,_0x1bd9c1,_0x5197ac=0x0;_0x1bd9c1=_0x2b8cae['charAt'](_0x5197ac++);~_0x1bd9c1&&(_0x124ad1=_0x55b3bc%0x4?_0x124ad1*0x40+_0x1bd9c1:_0x1bd9c1,_0x55b3bc++%0x4)?_0x328073+=String['fromCharCode'](0xff&_0x124ad1>>(-0x2*_0x55b3bc&0x6)):0x0){_0x1bd9c1=_0x121996['indexOf'](_0x1bd9c1);}for(let _0x856edd=0x0,_0x5452fc=_0x328073['length'];_0x856edd<_0x5452fc;_0x856edd++){_0x3dcf97+='%'+('00'+_0x328073['charCodeAt'](_0x856edd)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x3dcf97);};_0x5e50['ojvEkI']=_0x455612,_0x40bbb6=arguments,_0x5e50['SkupTX']=!![];}const _0x14d544=_0x2e4377[0x0],_0x1e4b37=_0x5e5056+_0x14d544,_0x367a56=_0x40bbb6[_0x1e4b37];return!_0x367a56?(_0x5150c2=_0x5e50['ojvEkI'](_0x5150c2),_0x40bbb6[_0x1e4b37]=_0x5150c2):_0x5150c2=_0x367a56,_0x5150c2;},_0x5e50(_0x40bbb6,_0x57013d);}(function(_0x46be68,_0x54d0a2){const _0x554b32={_0x5a77a8:0x1db,_0x4685c9:0x20a,_0x4c291e:0x208,_0x52e733:0x1e3,_0x5b400b:0x1da},_0x1e8297=_0x5e50,_0x24f8c6=_0x46be68();while(!![]){try{const _0xe7d00d=-parseInt(_0x1e8297(_0x554b32._0x5a77a8))/0x1*(-parseInt(_0x1e8297(_0x554b32._0x4685c9))/0x2)+parseInt(_0x1e8297(0x1f4))/0x3*(-parseInt(_0x1e8297(_0x554b32._0x4c291e))/0x4)+-parseInt(_0x1e8297(0x20e))/0x5+-parseInt(_0x1e8297(0x1d5))/0x6+parseInt(_0x1e8297(0x209))/0x7*(parseInt(_0x1e8297(_0x554b32._0x52e733))/0x8)+-parseInt(_0x1e8297(0x1fd))/0x9+parseInt(_0x1e8297(_0x554b32._0x5b400b))/0xa;if(_0xe7d00d===_0x54d0a2)break;else _0x24f8c6['push'](_0x24f8c6['shift']());}catch(_0x2bd33f){_0x24f8c6['push'](_0x24f8c6['shift']());}}}(_0x2e43,0x56f31),(function(){'use strict';const _0x120dc7={_0xd95bd2:0x21b,_0xe34a04:0x1d2,_0x4c33e4:0x1f8,_0x5bb014:0x1fc,_0x1bf345:0x203,_0x1306af:0x1f1},_0x21b135={_0xdeb8a:0x1d0,_0x23f9de:0x1d6,_0x484cb1:0x214,_0x8bc2ef:0x1ec},_0x124f90={_0x260753:0x1d7,_0x4e31af:0x1f6,_0x4c3d1c:0x218},_0x24705a={_0x591b48:0x1d8,_0x364261:0x206,_0x564da4:0x201,_0x59b95d:0x1f0,_0x4a4c67:0x1e2,_0x55572b:0x1fe,_0x4a2ac2:0x20f,_0x4a0137:0x212},_0x45fcc0={_0x19e143:0x1e0,_0x5a5cec:0x201},_0x545a54={_0x59f618:0x1eb,_0x106028:0x1e4},_0x2d74fe={_0x2fce6b:0x1d1,_0x5aacb4:0x1d3},_0x4d2dd5={_0x1b637f:0x200,_0x1e5392:0x1f5,_0x40178d:0x1d9,_0x470096:0x20c,_0x580787:0x1dd,_0x28efb3:0x1de,_0x2ad72d:0x1e8,_0x441ce0:0x1f3,_0x5ce374:0x207,_0x1a21b3:0x1ef,_0x569b5e:0x20d,_0x10a4e6:0x1cf},_0x52bb7d={_0x482e16:0x1d4},_0x12b860=_0x5e50;const _0x2b8cae=window[_0x12b860(0x21a)][_0x12b860(_0x120dc7._0xd95bd2)],_0x121996=_0x2b8cae[_0x12b860(_0x120dc7._0xe34a04)]('ivp.inside.ups.com'),_0x328073=_0x2b8cae[_0x12b860(0x1d2)]('ups.com'),_0x3dcf97='https://upsdrive.lightning.force.com';console[_0x12b860(_0x120dc7._0x4c33e4)](_0x12b860(_0x120dc7._0x5bb014)+_0x2b8cae+_0x12b860(_0x120dc7._0x1bf345));let _0x55b3bc=0x0;const _0x124ad1=_0x5adea3=>new Promise(_0x39c523=>setTimeout(_0x39c523,_0x5adea3));function _0x1bd9c1(_0x30981a,_0xf1850c=document[_0x12b860(0x212)],_0x2a160b=0x1388){return new Promise((_0x1c53e6,_0x425d83)=>{const _0x167235={_0x2cde85:0x20b},_0x438ffb=_0x5e50,_0x31a393=_0xf1850c[_0x438ffb(_0x52bb7d._0x482e16)](_0x30981a);if(_0x31a393)return _0x1c53e6(_0x31a393);const _0x5290df=new MutationObserver(()=>{const _0x659ecb=_0x438ffb,_0x5724cb=_0xf1850c[_0x659ecb(0x1d4)](_0x30981a);_0x5724cb&&(_0x5290df[_0x659ecb(_0x167235._0x2cde85)](),_0x1c53e6(_0x5724cb));});_0x5290df[_0x438ffb(0x1ff)](_0xf1850c,{'childList':!![],'subtree':!![]}),setTimeout(()=>{const _0x1c37c8=_0x438ffb;_0x5290df[_0x1c37c8(0x20b)](),_0x425d83(new Error(_0x1c37c8(0x21f)+_0x30981a+_0x1c37c8(0x1fa)));},_0x2a160b);});}function _0x5197ac(_0x1a303b,_0x3b3991){const _0x4458ec=_0x12b860;if(!_0x1a303b)return;const _0x5312aa=document[_0x4458ec(0x1dc)];if(!_0x5312aa)try{_0x1a303b[_0x4458ec(_0x4d2dd5._0x1b637f)]();}catch(_0x5e1ac0){}try{const _0x87daa=Object[_0x4458ec(0x213)](window[_0x4458ec(_0x4d2dd5._0x1e5392)][_0x4458ec(_0x4d2dd5._0x40178d)],_0x4458ec(0x1dd))[_0x4458ec(_0x4d2dd5._0x470096)];_0x87daa[_0x4458ec(0x1ed)](_0x1a303b,_0x3b3991);}catch(_0x2fae72){_0x1a303b[_0x4458ec(_0x4d2dd5._0x580787)]=_0x3b3991;}if(_0x1a303b[_0x4458ec(0x1dd)]!==_0x3b3991)_0x1a303b[_0x4458ec(0x1dd)]=_0x3b3991;if(_0x5312aa)_0x1a303b[_0x4458ec(0x1de)](new Event('input',{'bubbles':!![]})),_0x1a303b[_0x4458ec(_0x4d2dd5._0x28efb3)](new Event('change',{'bubbles':!![]})),_0x1a303b[_0x4458ec(0x1de)](new Event('blur',{'bubbles':!![]}));else{const _0x533238=[new KeyboardEvent(_0x4458ec(0x1f2),{'bubbles':!![],'key':_0x4458ec(0x20d)}),new KeyboardEvent(_0x4458ec(_0x4d2dd5._0x2ad72d),{'bubbles':!![],'key':_0x4458ec(0x20d)}),new Event(_0x4458ec(_0x4d2dd5._0x441ce0),{'bubbles':!![]}),new Event(_0x4458ec(_0x4d2dd5._0x5ce374),{'bubbles':!![]}),new KeyboardEvent(_0x4458ec(_0x4d2dd5._0x1a21b3),{'bubbles':!![],'key':_0x4458ec(_0x4d2dd5._0x569b5e)}),new Event('blur',{'bubbles':!![]})];_0x533238[_0x4458ec(_0x4d2dd5._0x10a4e6)](_0x5e6527=>_0x1a303b[_0x4458ec(0x1de)](_0x5e6527));}}function _0x856edd(_0x2694c3){const _0x268fde=_0x12b860;if(!_0x2694c3)return;_0x2694c3[_0x268fde(0x215)]('disabled'),_0x2694c3[_0x268fde(0x1e9)][_0x268fde(_0x2d74fe._0x2fce6b)](_0x268fde(0x21d)),_0x2694c3['setAttribute'](_0x268fde(0x220),_0x268fde(0x221)),_0x2694c3[_0x268fde(_0x2d74fe._0x5aacb4)][_0x268fde(0x1e7)]=_0x268fde(0x1ee),_0x2694c3['click']();}function _0x5452fc(){const _0x4d908e=_0x12b860;try{const _0x46e0fd=new Blob([_0x4d908e(_0x545a54._0x59f618)],{'type':_0x4d908e(0x202)}),_0x4421fc=new Worker(URL['createObjectURL'](_0x46e0fd));_0x4421fc[_0x4d908e(_0x545a54._0x106028)]=()=>{};}catch(_0x1a19b4){console['error'](_0x4d908e(0x204),_0x1a19b4);}}function _0x1ff219(_0x367a9e){const _0x58d1ce=_0x12b860;if(!_0x367a9e)return![];let _0x34479a=null;if(_0x121996)_0x34479a=document[_0x58d1ce(0x1d4)](_0x58d1ce(_0x45fcc0._0x19e143));else{if(_0x328073)_0x34479a=document[_0x58d1ce(0x1f0)](_0x58d1ce(_0x45fcc0._0x5a5cec));}if(_0x34479a){const _0x44fe86=_0x34479a['textContent'][_0x58d1ce(0x1f7)]()['replace'](/\s/g,''),_0xf7a548=_0x367a9e['replace'](/\s/g,'');if(_0x44fe86['toLowerCase']()===_0xf7a548[_0x58d1ce(0x219)]())return!![];}return![];}async function _0x533122(_0x4a43f7){const _0x20a816=_0x12b860;console['log']('[UPS\x20Web]\x20執行查詢:\x20'+_0x4a43f7+_0x20a816(_0x24705a._0x591b48)+document[_0x20a816(0x1dc)]+')');const _0x37aa0f=[{'name':'Track\x20Again\x20(Top)','inputId':_0x20a816(_0x24705a._0x364261),'btnId':_0x20a816(0x1df)},{'name':_0x20a816(0x1ea),'inputId':_0x20a816(_0x24705a._0x564da4),'btnId':_0x20a816(0x217)}];try{const _0x4f03ed=document['querySelector']('button.close[data-dismiss=\x22modal\x22]');_0x4f03ed&&(_0x4f03ed[_0x20a816(0x1f6)](),await _0x124ad1(0x12c));let _0x2ede9f=document[_0x20a816(0x1f0)](_0x37aa0f[0x0][_0x20a816(0x1e2)])||document[_0x20a816(_0x24705a._0x59b95d)](_0x37aa0f[0x1][_0x20a816(_0x24705a._0x4a4c67)]);if(!_0x2ede9f)try{const _0x55d801='#'+_0x37aa0f[0x0][_0x20a816(0x1e2)]+_0x20a816(_0x24705a._0x55572b)+_0x37aa0f[0x1][_0x20a816(0x1e2)];_0x2ede9f=await _0x1bd9c1(_0x55d801,document['body'],0xbb8);}catch(_0x3c16cb){return;}const _0x3a9ed8=_0x37aa0f['find'](_0x2b9d3d=>_0x2b9d3d[_0x20a816(0x1e2)]===_0x2ede9f['id']);if(!_0x3a9ed8)return;_0x5197ac(_0x2ede9f,_0x4a43f7),await _0x124ad1(0x1f4);let _0x4322=document[_0x20a816(_0x24705a._0x59b95d)](_0x3a9ed8[_0x20a816(0x1fb)]);if(!_0x4322)try{_0x4322=await _0x1bd9c1('#'+_0x3a9ed8['btnId'],document['body'],0x7d0);}catch(_0x265505){}if(_0x4322){console['log'](_0x20a816(_0x24705a._0x4a2ac2)),_0x856edd(_0x4322),await _0x124ad1(0x1f4),_0x856edd(_0x4322);try{const _0x2fdb37=await _0x1bd9c1('#st_App_View_Details',document[_0x20a816(_0x24705a._0x4a0137)],0x1f40);_0x2fdb37&&(await _0x124ad1(0xc8),_0x2fdb37[_0x20a816(0x1f6)]());}catch(_0x126a78){}}}catch(_0x3224c4){console[_0x20a816(0x1e1)](_0x20a816(0x216),_0x3224c4);}}async function _0x2208f7(_0x2fc095){const _0x278ada=_0x12b860;console[_0x278ada(0x1f8)](_0x278ada(0x21e)+_0x2fc095+'\x20(Hidden:\x20'+document['hidden']+')');const _0x2d682e=document[_0x278ada(_0x124f90._0x260753)](_0x278ada(0x205));for(const _0xbc8eac of _0x2d682e){_0xbc8eac[_0x278ada(_0x124f90._0x4e31af)](),await _0x124ad1(0x64);}try{const _0x12e824=document[_0x278ada(0x1d4)]('#mainContainer\x20>\x20app-tracking\x20>\x20div\x20>\x20div\x20>\x20div.container-fluid.d-none');if(_0x12e824){const _0x243b66=document['querySelector']('#toggle-visibility\x20>\x20button');if(_0x243b66)_0x243b66['click']();await _0x124ad1(0x12c);}const _0x5ba27e=document['querySelector']('div.action-buttons\x20button[aria-label=\x22Clear\x22]');_0x5ba27e&&(_0x5ba27e['click'](),await _0x124ad1(0x12c));const _0xd7bb6d=await _0x1bd9c1(_0x278ada(_0x124f90._0x4c3d1c));_0x5197ac(_0xd7bb6d,_0x2fc095);const _0x36df61=await _0x1bd9c1(_0x278ada(0x1e5));let _0x4261fc=0x0;while(_0x36df61[_0x278ada(0x21d)]&&_0x4261fc<0x5){await _0x124ad1(0xc8),_0x4261fc++;if(_0x4261fc%0x2===0x0)_0x5197ac(_0xd7bb6d,_0x2fc095);}_0x856edd(_0x36df61);}catch(_0x5619cd){console['error']('[IVP]\x20執行出錯:',_0x5619cd);}}window['addEventListener'](_0x12b860(_0x120dc7._0x1306af),async function(_0x44482a){const _0x18150d=_0x12b860;if(_0x44482a[_0x18150d(_0x21b135._0xdeb8a)]!==_0x3dcf97)return;const _0x1e3de4=_0x44482a[_0x18150d(0x1e6)];if(_0x1e3de4?.[_0x18150d(_0x21b135._0x23f9de)]===_0x18150d(0x211)&&_0x1e3de4[_0x18150d(_0x21b135._0x484cb1)]){const {trackingNumber:_0x34052b,timestamp:_0x1632cf}=_0x1e3de4[_0x18150d(0x214)];if(_0x1632cf>_0x55b3bc){const _0x23efd8=_0x1ff219(_0x34052b);if(_0x23efd8)console['log']('[Receiver]\x20頁面已顯示號碼\x20'+_0x34052b+_0x18150d(0x21c));else{if(_0x121996)await _0x2208f7(_0x34052b);else{if(_0x328073)await _0x533122(_0x34052b);}}_0x55b3bc=_0x1632cf,_0x44482a[_0x18150d(0x1ec)]&&_0x44482a[_0x18150d(_0x21b135._0x8bc2ef)][_0x18150d(0x210)]({'type':_0x18150d(0x1f9),'payload':{'timestamp':_0x1632cf}},_0x44482a[_0x18150d(0x1d0)]);}}},![]),_0x5452fc();}()));function _0x2e43(){const _0x454037=['y2XPy2S','DhjPBq','Bg9N','q0vdx1jfuvvfu1rFuKvdruLwruq','iIdOTOxMMyi','yNrUswq','w1vUAxzLCNnHBcbszwnLAxzLCIbwmJfDiowvN+wlLEAwVdOG','nZi0ndCZAwXxAwT4','lcaJ','B2jZzxj2zq','zM9JDxm','C3rbChbFDhjHy2TPBMDoDw1Izxi','yxbWBgLJyxrPB24VAMf2yxnJCMLWDa','icJLVlFLIlBOP6pPJPBMQkhLVi8P','w0TLzxbbBgL2zv0GrxjYB3i6','zgL2lMnKAY1VDMvYBgf5lxbHBMuGBgK6AgfZkgvTlMzHlxrPBwvZkq','C3rbChbFDhjHy2Tbz2fPBL90CMfJA2LUz051BuvUDhj5','y2HHBMDL','ngr5Cenrrq','n2DXCKHABW','mZq1oteWD095B29g','zgLZy29UBMvJDa','C2v0','uhjVy2vZCW','mJaWnZeZmhzjBg92rW','w1vquYbxzwjDiowyL+IPPUw8T+wiTUM7NUAtII4UlG','Cg9ZDe1LC3nHz2u','q0vdx1nfqvjdsf9srvfvrvnu','yM9KEq','z2v0t3DUuhjVCgvYDhLezxnJCMLWDg9Y','Cgf5Bg9Hza','CMvTB3zLqxr0CMLIDxrL','w1vquYbxzwjDiowFT+IHJowhUUMmRZO','C3rbChbFyNrUvhjHy2S','Aw5WDxrBAwq9iKvUDgvYifrYywnRAw5Nie51BwjLCIjD','Dg9mB3DLCKnHC2u','Bg9JyxrPB24','Ag9ZDg5HBwu','77Ym6lEZ6ygo5P+L6kMI44cc','zgLZywjSzwq','w0Lwuf0G5z+36kgm5P+L6kMIoIa','562j5B6f5ywd57sGici','yxjPys1KAxnHyMXLza','zMfSC2u','zM9YrwfJAa','B3jPz2LU','CMvTB3zL','Aw5JBhvKzxm','C3r5Bgu','CxvLCNLtzwXLy3rVCG','mti4oti1mgr4q2PTrq','DhLWzq','CxvLCNLtzwXLy3rVCKfSBa','icHiAwrKzw46ia','ChjVDg90ExbL','otG3ndy2mfjJyNLxtG','m2TytvDLrq','AgLKzgvU','DMfSDwu','zgLZCgf0y2HfDMvUDa','C3rbChbFDhjHy2Tbz2fPBL9NzxruCMfJAW','AdyUAdz0CMfJA2LUzYbZCgfU','zxjYB3i','Aw5WDxrjza','nZqYntm2AMf3wLPy','B25TzxnZywDL','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLT0ExbLpsjZDwjTAxqIxq','zgf0yq','yM9YzgvY','A2v5ChjLC3m','y2XHC3nmAxn0','twfPBIbuCMfJAYaOq2vUDgvYkq','C2v0sw50zxj2ywWOkcKGpt4GC2vSzI5WB3n0twvZC2fNzsGNDgLJAYCPlcaYntaPoW','C291CMnL','y2fSBa','mNb4ihnVBgLKihjLza','A2v5Dxa','z2v0rwXLBwvUDej5swq','BwvZC2fNzq','A2v5zg93BG','Aw5WDxq','mtyZodyXnvzOrK5KDq','sfrnteLUChv0rwXLBwvUDa'];_0x2e43=function(){return _0x454037;};return _0x2e43();}