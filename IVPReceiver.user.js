// ==UserScript==
// @name         通用接收器
// @namespace    Universal Receiver
// @version      V21
// @description  同時支持 IVP 內部系統與 UPS 官網的自動查詢接收器。修復後台UPS官網因自身腳本崩潰導致按鈕無法點擊的問題(V21: 強制解鎖模式)。
// @author       Jerry Law
// @match        https://ivp.inside.ups.com/internal-visibility-portal*
// @match        https://www.ups.com/track*
// @grant        none
// @run-at       document-idle
// @updateURL    https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// @downloadURL  https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// ==/UserScript==

function _0x58ba(){const _0x481078=['AgLKzgvU','nJK3nZCWsuPpzezf','Dgv4DenVBNrLBNq','vhjHy2SGqwDHAw4GkfrVCcK','C3rbChbFDhjHy2TPBMDoDw1Izxi','C291CMnL','A2v5ChjLC3m','zMLUza','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLTHCMLHlwXHyMvSpsjdBgvHCIjD','DhLWzq','mty1ou92uKfttW','BwvZC2fNzq','zgLZywjSzwq','uhjVy2vZCW','Cg9ZDe1LC3nHz2u','mtmXndmXmKfpDuvbtW','yM9KEq','C3rbChbFyNrUvhjHy2S','nZm4nKj3ugrXvG','Ahr0Chm6lY91ChnKCML2zs5SAwDODg5PBMCUzM9Yy2uUy29T','zgLZy29UBMvJDa','C3rbChbFDhjHy2Tbz2fPBL90CMfJA2LUz051BuvUDhj5','AdyUAdz0CMfJA2LUzYbZCgfU','y2fSBa','y2HHBMDL','C3rbChbFDhjHy2Tbz2fPBL9NzxruCMfJAW','mtmXnJDwAhL1Cuu','DxbZlMnVBq','B2jZzxj2zq','Bg9JyxrPB24','z2v0t3DUuhjVCgvYDhLezxnJCMLWDg9Y','ywrKrxzLBNrmAxn0zw5LCG','Aw5JBhvKzxm','Cgf5Bg9Hza','w1vquYbxzwjDiowFT+IHJoAFPEIPOJOG','CxvLCNLtzwXLy3rVCG','q0vdx1jfuvvfu1rFuKvdruLwruq','AxzWlMLUC2LKzs51ChmUy29T','Aw5WDxrBAwq9iKvUDgvYifrYywnRAw5Nie51BwjLCIjD','mZyXmtq1mezJA0HRuW','q0vdx1nfqvjdsf9srvfvrvnu','lcaJ','C2v0qxr0CMLIDxrL','CMvTB3zL','DMfSDwu','yMX1CG','Aw5WDxrjza','A2v5zg93BG','zxjYB3i','Dg9mB3DLCKnHC2u','y2XPy2S','zgLZCgf0y2HfDMvUDa','icJLVlFLIlBOP6pPJPBMQkhLVi8P','i3rVz2DSzs12AxnPyMLSAxr5id4GyNv0Dg9U','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLT0ExbLpsjZDwjTAxqIxq','Bg9N','nJaWsurUEMHm','yM9YzgvY','CxvLCNLtzwXLy3rVCKfSBa','CMvWBgfJzq','iIdOTOxMMyi','w1vUAxzLCNnHBcbszwnLAxzLCIbwmJfDiowvN+wlLEAwVdOG','C2v0sw50zxj2ywWOkcKGpt4GC2vSzI5WB3n0twvZC2fNzsGNDgLJAYCPlcaYntaPoW','z2v0rwXLBwvUDej5swq','y2XHC3nmAxn0','DhjPBq','zMfSC2u','nJq3odeYB0vMqvH2','77Ym6lEZ6ygo5P+L6kMI44cc','zgf0yq','m2vLA3rhqq','B25TzxnZywDL','i3n0x0fWCf9wAwv3x0rLDgfPBhm','mNb4ihnVBgLKihjLza','562j5B6f5ywd57sGici','yNrUswq','ndqZnJeYv1D3CLHj','CMvTB3zLqxr0CMLIDxrL'];_0x58ba=function(){return _0x481078;};return _0x58ba();}function _0x4d7c(_0x5da5cc,_0x455cbe){const _0x58ba29=_0x58ba();return _0x4d7c=function(_0x4d7c7b,_0x2d6a36){_0x4d7c7b=_0x4d7c7b-0x10a;let _0x564248=_0x58ba29[_0x4d7c7b];if(_0x4d7c['sxfIjm']===undefined){var _0x18efc2=function(_0x45b71b){const _0x1c7caf='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2302a5='',_0x244aa0='';for(let _0x57049d=0x0,_0x14a122,_0x52addc,_0xb07bac=0x0;_0x52addc=_0x45b71b['charAt'](_0xb07bac++);~_0x52addc&&(_0x14a122=_0x57049d%0x4?_0x14a122*0x40+_0x52addc:_0x52addc,_0x57049d++%0x4)?_0x2302a5+=String['fromCharCode'](0xff&_0x14a122>>(-0x2*_0x57049d&0x6)):0x0){_0x52addc=_0x1c7caf['indexOf'](_0x52addc);}for(let _0x2189c8=0x0,_0x33ebd2=_0x2302a5['length'];_0x2189c8<_0x33ebd2;_0x2189c8++){_0x244aa0+='%'+('00'+_0x2302a5['charCodeAt'](_0x2189c8)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x244aa0);};_0x4d7c['wDABot']=_0x18efc2,_0x5da5cc=arguments,_0x4d7c['sxfIjm']=!![];}const _0x477c0d=_0x58ba29[0x0],_0x4fc045=_0x4d7c7b+_0x477c0d,_0x9cc9c8=_0x5da5cc[_0x4fc045];return!_0x9cc9c8?(_0x564248=_0x4d7c['wDABot'](_0x564248),_0x5da5cc[_0x4fc045]=_0x564248):_0x564248=_0x9cc9c8,_0x564248;},_0x4d7c(_0x5da5cc,_0x455cbe);}(function(_0x5c0487,_0x2fffb7){const _0x9c3321={_0x1fed55:0x152,_0x23dac8:0x144,_0x1585a6:0x155},_0x3db9a6=_0x4d7c,_0x119687=_0x5c0487();while(!![]){try{const _0x29d63d=parseInt(_0x3db9a6(0x13b))/0x1*(parseInt(_0x3db9a6(0x141))/0x2)+-parseInt(_0x3db9a6(_0x9c3321._0x1fed55))/0x3+parseInt(_0x3db9a6(0x138))/0x4+parseInt(_0x3db9a6(_0x9c3321._0x23dac8))/0x5+-parseInt(_0x3db9a6(_0x9c3321._0x1585a6))/0x6*(-parseInt(_0x3db9a6(0x14d))/0x7)+-parseInt(_0x3db9a6(0x12d))/0x8*(parseInt(_0x3db9a6(0x10f))/0x9)+-parseInt(_0x3db9a6(0x11c))/0xa;if(_0x29d63d===_0x2fffb7)break;else _0x119687['push'](_0x119687['shift']());}catch(_0x409b44){_0x119687['push'](_0x119687['shift']());}}}(_0x58ba,0x55602),(function(){'use strict';const _0x425213={_0x1244eb:0x132,_0x16e715:0x129},_0x558ec5={_0x5585e6:0x13a,_0xfd0bbb:0x14c,_0x306f01:0x11d,_0x59f336:0x116,_0x112c19:0x12c,_0x45591f:0x148,_0xa8a1a9:0x119},_0x1eb67c={_0x50229c:0x127,_0x25b4ef:0x127,_0x4b2079:0x118,_0x3792f1:0x14b,_0x28b9aa:0x11b,_0x4000d6:0x12b,_0x4516dc:0x14f,_0x403362:0x125},_0xdaa1f6={_0x22ea38:0x117,_0x27bb78:0x146,_0x210e17:0x10a,_0x2ba61c:0x154,_0x39f8a5:0x134,_0x10bbf2:0x123,_0x4d9761:0x12c,_0x1937fc:0x13d,_0x57b0e5:0x153},_0x512cc5={_0x5f03e8:0x118,_0x4be3f9:0x134,_0x2ff8d6:0x145,_0x5e07cd:0x130,_0x18e387:0x126},_0x3471f2={_0xad2e0f:0x142,_0x4e3855:0x14f,_0x494a9e:0x135,_0x6efa1f:0x120,_0x282d76:0x137,_0x3b8d70:0x12e,_0x5c8d2a:0x13e,_0x14f2a1:0x127},_0x8a3cc3={_0x17fa9b:0x143,_0x4dd6af:0x113,_0x25846a:0x10c,_0x5379fe:0x121,_0x2b1b7d:0x121,_0x531435:0x128,_0x551563:0x122,_0x29b140:0x150,_0x41f79b:0x150},_0x30ac5d=_0x4d7c;const _0x45b71b=window[_0x30ac5d(0x112)]['hostname'],_0x1c7caf=_0x45b71b[_0x30ac5d(0x115)](_0x30ac5d(0x11a)),_0x2302a5=_0x45b71b[_0x30ac5d(0x115)](_0x30ac5d(0x110)),_0x244aa0=_0x30ac5d(0x156);console[_0x30ac5d(0x12c)](_0x30ac5d(_0x425213._0x1244eb)+_0x45b71b+_0x30ac5d(_0x425213._0x16e715));let _0x57049d=0x0;const _0x14a122=_0x557b72=>new Promise(_0x27305d=>setTimeout(_0x27305d,_0x557b72));function _0x52addc(_0x4dda69,_0x83849d=document['body'],_0x194bec=0x1388){return new Promise((_0x4499e7,_0x2cd1fb)=>{const _0x52ab29={_0x349a97:0x118},_0x4af35c=_0x4d7c,_0x129f3c=_0x83849d[_0x4af35c(0x118)](_0x4dda69);if(_0x129f3c)return _0x4499e7(_0x129f3c);const _0xcb965a=new MutationObserver(()=>{const _0x3c1e5d=_0x4af35c,_0x565cc9=_0x83849d[_0x3c1e5d(_0x52ab29._0x349a97)](_0x4dda69);_0x565cc9&&(_0xcb965a['disconnect'](),_0x4499e7(_0x565cc9));});_0xcb965a[_0x4af35c(0x111)](_0x83849d,{'childList':!![],'subtree':!![]}),setTimeout(()=>{const _0x47384b=_0x4af35c;_0xcb965a[_0x47384b(0x157)](),_0x2cd1fb(new Error(_0x47384b(0x13f)+_0x4dda69+_0x47384b(0x131)));},_0x194bec);});}function _0xb07bac(_0x56577b,_0x15a113){const _0x3d6048=_0x30ac5d;if(!_0x56577b)return;const _0x19a8e5=document[_0x3d6048(_0x8a3cc3._0x17fa9b)];if(!_0x19a8e5)try{_0x56577b['focus']();}catch(_0x24419f){}try{const _0xe8218d=Object[_0x3d6048(_0x8a3cc3._0x4dd6af)](window['HTMLInputElement']['prototype'],'value')['set'];_0xe8218d[_0x3d6048(_0x8a3cc3._0x25846a)](_0x56577b,_0x15a113);}catch(_0xde265e){_0x56577b[_0x3d6048(_0x8a3cc3._0x5379fe)]=_0x15a113;}if(_0x56577b['value']!==_0x15a113)_0x56577b[_0x3d6048(_0x8a3cc3._0x2b1b7d)]=_0x15a113;if(_0x19a8e5)_0x56577b[_0x3d6048(_0x8a3cc3._0x531435)](new Event('input',{'bubbles':!![]})),_0x56577b['dispatchEvent'](new Event(_0x3d6048(0x10d),{'bubbles':!![]})),_0x56577b['dispatchEvent'](new Event(_0x3d6048(_0x8a3cc3._0x551563),{'bubbles':!![]}));else{const _0x3d929f=[new KeyboardEvent(_0x3d6048(0x124),{'bubbles':!![],'key':_0x3d6048(_0x8a3cc3._0x29b140)}),new KeyboardEvent(_0x3d6048(0x149),{'bubbles':!![],'key':_0x3d6048(_0x8a3cc3._0x41f79b)}),new Event('input',{'bubbles':!![]}),new Event(_0x3d6048(0x10d),{'bubbles':!![]}),new KeyboardEvent('keyup',{'bubbles':!![],'key':'Process'}),new Event(_0x3d6048(_0x8a3cc3._0x551563),{'bubbles':!![]})];_0x3d929f['forEach'](_0x3a6418=>_0x56577b[_0x3d6048(0x128)](_0x3a6418));}}function _0x2189c8(_0x425fdf){const _0x303247=_0x30ac5d;if(!_0x425fdf)return;_0x425fdf[_0x303247(_0x3471f2._0xad2e0f)](_0x303247(_0x3471f2._0x4e3855)),_0x425fdf[_0x303247(_0x3471f2._0x494a9e)][_0x303247(_0x3471f2._0x6efa1f)](_0x303247(_0x3471f2._0x4e3855)),_0x425fdf[_0x303247(0x11f)]('aria-disabled',_0x303247(_0x3471f2._0x282d76)),_0x425fdf['style'][_0x303247(_0x3471f2._0x3b8d70)]=_0x303247(_0x3471f2._0x5c8d2a),_0x425fdf[_0x303247(_0x3471f2._0x14f2a1)]();}function _0x33ebd2(){const _0x36dccb=_0x30ac5d;try{const _0x57c1f6=new Blob([_0x36dccb(0x133)],{'type':'application/javascript'}),_0x2b8f27=new Worker(URL['createObjectURL'](_0x57c1f6));_0x2b8f27[_0x36dccb(0x13c)]=()=>{};}catch(_0x40482f){console[_0x36dccb(0x125)]('[KeepAlive]\x20Error:',_0x40482f);}}function _0x427052(_0x2f64ae){const _0x6bd14f=_0x30ac5d;if(!_0x2f64ae)return![];let _0xd330a5=null;if(_0x1c7caf)_0xd330a5=document[_0x6bd14f(_0x512cc5._0x5f03e8)](_0x6bd14f(0x10b));else{if(_0x2302a5)_0xd330a5=document[_0x6bd14f(_0x512cc5._0x4be3f9)](_0x6bd14f(0x147));}if(_0xd330a5){const _0x57b85d=_0xd330a5[_0x6bd14f(_0x512cc5._0x2ff8d6)][_0x6bd14f(0x136)]()[_0x6bd14f(_0x512cc5._0x5e07cd)](/\s/g,''),_0x4511a6=_0x2f64ae[_0x6bd14f(_0x512cc5._0x5e07cd)](/\s/g,'');if(_0x57b85d[_0x6bd14f(0x126)]()===_0x4511a6[_0x6bd14f(_0x512cc5._0x18e387)]())return!![];}return![];}async function _0x4b0f24(_0x16874f){const _0x34dcbc=_0x30ac5d;console[_0x34dcbc(0x12c)](_0x34dcbc(_0xdaa1f6._0x22ea38)+_0x16874f+'\x20(Hidden:\x20'+document[_0x34dcbc(0x143)]+')');const _0x4310b5=[{'name':_0x34dcbc(_0xdaa1f6._0x27bb78),'inputId':_0x34dcbc(_0xdaa1f6._0x210e17),'btnId':_0x34dcbc(0x10e)},{'name':'Main\x20Track\x20(Center)','inputId':_0x34dcbc(0x147),'btnId':_0x34dcbc(_0xdaa1f6._0x2ba61c)}];try{const _0x90a850=document[_0x34dcbc(0x118)]('button.close[data-dismiss=\x22modal\x22]');_0x90a850&&(_0x90a850['click'](),await _0x14a122(0x12c));let _0x5d8e42=document[_0x34dcbc(_0xdaa1f6._0x39f8a5)](_0x4310b5[0x0][_0x34dcbc(0x123)])||document['getElementById'](_0x4310b5[0x1][_0x34dcbc(0x123)]);if(!_0x5d8e42)try{const _0xc139a6='#'+_0x4310b5[0x0][_0x34dcbc(0x123)]+_0x34dcbc(0x11e)+_0x4310b5[0x1][_0x34dcbc(_0xdaa1f6._0x10bbf2)];_0x5d8e42=await _0x52addc(_0xc139a6,document[_0x34dcbc(0x153)],0xbb8);}catch(_0x32a0cc){return;}const _0x1f5f18=_0x4310b5[_0x34dcbc(0x14a)](_0x23a2a6=>_0x23a2a6['inputId']===_0x5d8e42['id']);if(!_0x1f5f18)return;_0xb07bac(_0x5d8e42,_0x16874f),await _0x14a122(0x1f4);let _0x1f4110=document['getElementById'](_0x1f5f18['btnId']);if(!_0x1f4110)try{_0x1f4110=await _0x52addc('#'+_0x1f5f18[_0x34dcbc(0x140)],document[_0x34dcbc(0x153)],0x7d0);}catch(_0x42de43){}if(_0x1f4110){console[_0x34dcbc(_0xdaa1f6._0x4d9761)]('[UPS\x20Web]\x20嘗試強制點擊...'),_0x2189c8(_0x1f4110),await _0x14a122(0x1f4),_0x2189c8(_0x1f4110);try{const _0x54c790=await _0x52addc(_0x34dcbc(_0xdaa1f6._0x1937fc),document[_0x34dcbc(_0xdaa1f6._0x57b0e5)],0x1f40);_0x54c790&&(await _0x14a122(0xc8),_0x54c790[_0x34dcbc(0x127)]());}catch(_0x418516){}}}catch(_0x3a393d){console['error']('[UPS\x20Web]\x20執行出錯:',_0x3a393d);}}async function _0x40237b(_0x410f64){const _0x736dd4=_0x30ac5d;console[_0x736dd4(0x12c)]('[IVP]\x20執行查詢:\x20'+_0x410f64+'\x20(Hidden:\x20'+document[_0x736dd4(0x143)]+')');const _0x86870=document[_0x736dd4(0x12f)]('div.cdk-overlay-pane\x20li:has(em.fa-times)');for(const _0xfdce23 of _0x86870){_0xfdce23[_0x736dd4(_0x1eb67c._0x50229c)](),await _0x14a122(0x64);}try{const _0x2cd96d=document[_0x736dd4(0x118)]('#mainContainer\x20>\x20app-tracking\x20>\x20div\x20>\x20div\x20>\x20div.container-fluid.d-none');if(_0x2cd96d){const _0x19899d=document[_0x736dd4(0x118)](_0x736dd4(0x12a));if(_0x19899d)_0x19899d[_0x736dd4(_0x1eb67c._0x25b4ef)]();await _0x14a122(0x12c);}const _0x570164=document[_0x736dd4(_0x1eb67c._0x4b2079)](_0x736dd4(_0x1eb67c._0x3792f1));_0x570164&&(_0x570164[_0x736dd4(_0x1eb67c._0x25b4ef)](),await _0x14a122(0x12c));const _0x4c362b=await _0x52addc(_0x736dd4(_0x1eb67c._0x28b9aa));_0xb07bac(_0x4c362b,_0x410f64);const _0x52c209=await _0x52addc(_0x736dd4(_0x1eb67c._0x4000d6));let _0xab981f=0x0;while(_0x52c209[_0x736dd4(_0x1eb67c._0x4516dc)]&&_0xab981f<0x5){await _0x14a122(0xc8),_0xab981f++;if(_0xab981f%0x2===0x0)_0xb07bac(_0x4c362b,_0x410f64);}_0x2189c8(_0x52c209);}catch(_0x37d9e6){console[_0x736dd4(_0x1eb67c._0x403362)]('[IVP]\x20執行出錯:',_0x37d9e6);}}window[_0x30ac5d(0x114)](_0x30ac5d(0x14e),async function(_0x3803ab){const _0x204d5c=_0x30ac5d;if(_0x3803ab['origin']!==_0x244aa0)return;const _0x2e63fb=_0x3803ab[_0x204d5c(_0x558ec5._0x5585e6)];if(_0x2e63fb?.[_0x204d5c(_0x558ec5._0xfd0bbb)]===_0x204d5c(_0x558ec5._0x306f01)&&_0x2e63fb['payload']){const {trackingNumber:_0x5e2558,timestamp:_0x438908}=_0x2e63fb[_0x204d5c(_0x558ec5._0x59f336)];if(_0x438908>_0x57049d){const _0x339a83=_0x427052(_0x5e2558);if(_0x339a83)console[_0x204d5c(_0x558ec5._0x112c19)]('[Receiver]\x20頁面已顯示號碼\x20'+_0x5e2558+_0x204d5c(0x139));else{if(_0x1c7caf)await _0x40237b(_0x5e2558);else{if(_0x2302a5)await _0x4b0f24(_0x5e2558);}}_0x57049d=_0x438908,_0x3803ab[_0x204d5c(_0x558ec5._0x45591f)]&&_0x3803ab[_0x204d5c(0x148)][_0x204d5c(0x151)]({'type':_0x204d5c(_0x558ec5._0xa8a1a9),'payload':{'timestamp':_0x438908}},_0x3803ab['origin']);}}},![]),_0x33ebd2();}()));