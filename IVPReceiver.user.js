// ==UserScript==
// @name         通用接收器
// @namespace    Universal Receiver
// @version      V21
// @description  同時支持 IVP 內部系統與 UPS 官網的自動查詢接收器。修復後台UPS官網因自身腳本崩潰導致按鈕無法點擊的問題(V21: 強制解鎖模式)。
// @author       Jerry Law
// @match        https://ivp.inside.ups.com/internal-visibility-portal*
// @match        https://www.ups.com/track*
// @grant        none
// @run-at       document-idle
// @updateURL    https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// @downloadURL  https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// ==/UserScript==

function _0x255f(){const _0x5747e6=['z2v0t3DUuhjVCgvYDhLezxnJCMLWDg9Y','y2HHBMDL','Bg9JyxrPB24','icHiAwrKzw46ia','i21HAw5dB250ywLUzxiGpIbHChaTDhjHy2TPBMCGpIbKAxyGpIbKAxyGpIbKAxyUy29UDgfPBMvYlwzSDwLKlMqTBM9Uzq','zgLZCgf0y2HfDMvUDa','mK5JCNn4sq','zMLUza','Aw5WDxrjza','odm0nZu5ounxtNzktG','w1vquYbxzwjDiowFT+IHJoAFPEIPOJOG','B2jZzxj2zq','iIdOTOxMMyi','Bg9N','oeXevMnuCq','q0vdx1nfqvjdsf9srvfvrvnu','w1vUAxzLCNnHBcbszwnLAxzLCIbwmJfDiowvN+wlLEAwVdOG','mtuYmdyZELPPq3bW','y2XPy2S','q0vdx1jfuvvfu1rFuKvdruLwruq','Aw5JBhvKzxm','uhjVy2vZCW','z2v0rwXLBwvUDej5swq','mZC3nZaYn2v1C3v2EG','C3rbChbFDhjHy2Tbz2fPBL90CMfJA2LUz051BuvUDhj5','DhjPBq','BwvZC2fNzq','C2v0sw50zxj2ywWOkcKGpt4GC2vSzI5WB3n0twvZC2fNzsGNDgLJAYCPlcaYntaPoW','A2v5Dxa','DMfSDwu','yM9YzgvY','CxvLCNLtzwXLy3rVCKfSBa','w1jLy2vPDMvYxsdPOihPNAlLT7lPOA/NPlROMz/NORWG','C2v0','AxzWlMLUC2LKzs51ChmUy29T','C2v0qxr0CMLIDxrL','mte0mJe4nwzVD2LYqW','CMvTB3zLqxr0CMLIDxrL','CMvTB3zL','Ag9ZDg5HBwu','A2v5ChjLC3m','zMfSC2u','odm0nZHdsgzZr1y','zgLZy29UBMvJDa','zgL2lMnKAY1VDMvYBgf5lxbHBMuGBgK6AgfZkgvTlMzHlxrPBwvZkq','w0Lwuf0G5z+36kgm5P+L6kMIoIa','ndbqzK5Pzhq','y2fSBa','B3jPz2LU','ndeZDfbiA3bu','yM9KEq','yxbWBgLJyxrPB24VAMf2yxnJCMLWDa','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLTHCMLHlwXHyMvSpsjdBgvHCIjD','zM9YrwfJAa','CxvLCNLtzwXLy3rVCG','ChjVDg90ExbL','DxbZlMnVBq','yNrUswq','ywrKrxzLBNrmAxn0zw5LCG','zgLZywjSzwq','zxjYB3i','mNb4ihnVBgLKihjLza','Aw5WDxrBAwq9iKvUDgvYifrYywnRAw5Nie51BwjLCIjD','A2v5zg93BG','sfrnteLUChv0rwXLBwvUDa','C3rbChbFDhjHy2Tbz2fPBL9NzxruCMfJAW','yMX1CG','Dgv4DenVBNrLBNq','C3rbChbFDhjHy2TPBMDoDw1Izxi','Dg9mB3DLCKnHC2u','mZCWote2n3fnEgPTtW','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLT0ExbLpsjZDwjTAxqIxq','yNv0Dg9UlMnSB3nLw2rHDgeTzgLZBwLZCZ0IBw9KywWIxq','yxjPys1KAxnHyMXLza','Aw5WDxq','mtu1odKYohPiEfnKua','Cgf5Bg9Hza','vhjHy2SGqwDHAw4GkfrVCcK','AgLKzgvU','C291CMnL','icJLVlFLIlBOP6pPJPBMQkhLVi8P','CMvWBgfJzq','DhLWzq'];_0x255f=function(){return _0x5747e6;};return _0x255f();}function _0x4756(_0x13bd01,_0x4f3354){const _0x255f53=_0x255f();return _0x4756=function(_0x4756e6,_0x83fb6f){_0x4756e6=_0x4756e6-0x1bf;let _0x9de222=_0x255f53[_0x4756e6];if(_0x4756['ffSYPk']===undefined){var _0x3c4390=function(_0x555125){const _0x264c55='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3ca15b='',_0x298ad8='';for(let _0x57cba4=0x0,_0x26c7d9,_0x22e154,_0x295132=0x0;_0x22e154=_0x555125['charAt'](_0x295132++);~_0x22e154&&(_0x26c7d9=_0x57cba4%0x4?_0x26c7d9*0x40+_0x22e154:_0x22e154,_0x57cba4++%0x4)?_0x3ca15b+=String['fromCharCode'](0xff&_0x26c7d9>>(-0x2*_0x57cba4&0x6)):0x0){_0x22e154=_0x264c55['indexOf'](_0x22e154);}for(let _0x2e1b5c=0x0,_0x49dde8=_0x3ca15b['length'];_0x2e1b5c<_0x49dde8;_0x2e1b5c++){_0x298ad8+='%'+('00'+_0x3ca15b['charCodeAt'](_0x2e1b5c)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x298ad8);};_0x4756['vtrSCV']=_0x3c4390,_0x13bd01=arguments,_0x4756['ffSYPk']=!![];}const _0x4725f9=_0x255f53[0x0],_0x543e02=_0x4756e6+_0x4725f9,_0x26f4a9=_0x13bd01[_0x543e02];return!_0x26f4a9?(_0x9de222=_0x4756['vtrSCV'](_0x9de222),_0x13bd01[_0x543e02]=_0x9de222):_0x9de222=_0x26f4a9,_0x9de222;},_0x4756(_0x13bd01,_0x4f3354);}(function(_0x37659f,_0x545454){const _0xed1025={_0x558947:0x1f6,_0x576688:0x1f1},_0x464fe9=_0x4756,_0x617ba1=_0x37659f();while(!![]){try{const _0x58a24f=-parseInt(_0x464fe9(0x1f9))/0x1+parseInt(_0x464fe9(0x1ee))/0x2*(parseInt(_0x464fe9(0x1ff))/0x3)+parseInt(_0x464fe9(0x1e0))/0x4+-parseInt(_0x464fe9(0x20c))/0x5+parseInt(_0x464fe9(0x1bf))/0x6*(-parseInt(_0x464fe9(0x1c6))/0x7)+-parseInt(_0x464fe9(_0xed1025._0x558947))/0x8*(parseInt(_0x464fe9(_0xed1025._0x576688))/0x9)+-parseInt(_0x464fe9(0x1c3))/0xa*(-parseInt(_0x464fe9(0x1db))/0xb);if(_0x58a24f===_0x545454)break;else _0x617ba1['push'](_0x617ba1['shift']());}catch(_0x584b1a){_0x617ba1['push'](_0x617ba1['shift']());}}}(_0x255f,0xd412b),(function(){'use strict';const _0x41eaf7={_0x3e8dbf:0x1ea,_0x1b8718:0x20a,_0xd2ee39:0x1cd,_0x5347d6:0x1f8,_0xa69764:0x1cf},_0x3cac8b={_0x28b9c8:0x1e7,_0xeb5418:0x1e1,_0x3b3efb:0x1e1,_0xd39bd6:0x1f5,_0x474176:0x208,_0xa258b8:0x1e4,_0x9aa4cb:0x1fb},_0x2190f1={_0x33031e:0x1c2,_0x41e886:0x207,_0x3821ac:0x1c1,_0x14aa25:0x1cb,_0x56533b:0x1cb,_0x2a3c2b:0x1c9,_0x8a250b:0x1d3,_0x1f0002:0x1d1},_0x3dc64d={_0xa85304:0x1f5,_0x4f6e44:0x1f2,_0x7eaf30:0x200,_0x7f7b3e:0x1d6,_0x5000ac:0x1dd,_0x275de3:0x1fe,_0x365f99:0x1ef,_0xf7055f:0x1fe,_0xe9baf6:0x1ce},_0x40d884={_0x5dc078:0x1d9,_0x4cc04d:0x1d8,_0x29d79b:0x1e6},_0x31c25d={_0x57ae3a:0x203,_0x246db1:0x1c8},_0x269428={_0x2edc0a:0x20d,_0x4f0c5b:0x1d0,_0x4b3791:0x20b,_0x42fe83:0x1de,_0x27acff:0x1d2,_0x1affe8:0x1fa},_0x15a6fc={_0x5095b3:0x1e8,_0x5899fb:0x1cc,_0x1324e7:0x205,_0xdcfa97:0x209,_0x16252c:0x1c4,_0x5d7723:0x205,_0x1ca88c:0x1ed,_0x2e6d2a:0x1d7,_0x2cfed4:0x210,_0x1dc2b0:0x1df,_0x4a4307:0x1e9,_0x302a78:0x204},_0x2ae77f=_0x4756;const _0x555125=window[_0x2ae77f(_0x41eaf7._0x3e8dbf)][_0x2ae77f(0x20f)],_0x264c55=_0x555125[_0x2ae77f(0x1fc)](_0x2ae77f(_0x41eaf7._0x1b8718)),_0x3ca15b=_0x555125[_0x2ae77f(0x1fc)](_0x2ae77f(_0x41eaf7._0xd2ee39)),_0x298ad8='https://upsdrive.lightning.force.com';console[_0x2ae77f(0x1f5)](_0x2ae77f(_0x41eaf7._0x5347d6)+_0x555125+_0x2ae77f(0x1e5));let _0x57cba4=0x0;const _0x26c7d9=_0x4a57f3=>new Promise(_0x538ec4=>setTimeout(_0x538ec4,_0x4a57f3));function _0x22e154(_0x1f59b1,_0x61736c=document['body'],_0x2bbbcd=0x1388){const _0x1ccfe5={_0x3929c2:0x1cb,_0x123890:0x1f3},_0x5b4c4d={_0x513bed:0x1f4};return new Promise((_0x3d3d4c,_0x54e261)=>{const _0x3820aa=_0x4756,_0x2c17c0=_0x61736c[_0x3820aa(_0x1ccfe5._0x3929c2)](_0x1f59b1);if(_0x2c17c0)return _0x3d3d4c(_0x2c17c0);const _0x3ddf8b=new MutationObserver(()=>{const _0x11e92e=_0x3820aa,_0x1f5032=_0x61736c[_0x11e92e(0x1cb)](_0x1f59b1);_0x1f5032&&(_0x3ddf8b[_0x11e92e(0x1c0)](),_0x3d3d4c(_0x1f5032));});_0x3ddf8b[_0x3820aa(_0x1ccfe5._0x123890)](_0x61736c,{'childList':!![],'subtree':!![]}),setTimeout(()=>{const _0x4b8de7=_0x3820aa;_0x3ddf8b['disconnect'](),_0x54e261(new Error('等待元素\x20\x22'+_0x1f59b1+_0x4b8de7(_0x5b4c4d._0x513bed)));},_0x2bbbcd);});}function _0x295132(_0x582b34,_0xd3ab9b){const _0x37fb9=_0x2ae77f;if(!_0x582b34)return;const _0x42d7ff=document['hidden'];if(!_0x42d7ff)try{_0x582b34['focus']();}catch(_0xd28cb5){}try{const _0x1fa7ea=Object[_0x37fb9(_0x15a6fc._0x5095b3)](window[_0x37fb9(0x1d5)][_0x37fb9(_0x15a6fc._0x5899fb)],_0x37fb9(_0x15a6fc._0x1324e7))[_0x37fb9(_0x15a6fc._0xdcfa97)];_0x1fa7ea[_0x37fb9(_0x15a6fc._0x16252c)](_0x582b34,_0xd3ab9b);}catch(_0x290978){_0x582b34[_0x37fb9(_0x15a6fc._0x5d7723)]=_0xd3ab9b;}if(_0x582b34[_0x37fb9(0x205)]!==_0xd3ab9b)_0x582b34[_0x37fb9(0x205)]=_0xd3ab9b;if(_0x42d7ff)_0x582b34[_0x37fb9(_0x15a6fc._0x1ca88c)](new Event(_0x37fb9(0x1df),{'bubbles':!![]})),_0x582b34[_0x37fb9(_0x15a6fc._0x1ca88c)](new Event(_0x37fb9(0x1e9),{'bubbles':!![]})),_0x582b34['dispatchEvent'](new Event(_0x37fb9(_0x15a6fc._0x2e6d2a),{'bubbles':!![]}));else{const _0x27c713=[new KeyboardEvent(_0x37fb9(0x1d4),{'bubbles':!![],'key':'Process'}),new KeyboardEvent(_0x37fb9(_0x15a6fc._0x2cfed4),{'bubbles':!![],'key':_0x37fb9(0x1fd)}),new Event(_0x37fb9(_0x15a6fc._0x1dc2b0),{'bubbles':!![]}),new Event(_0x37fb9(_0x15a6fc._0x4a4307),{'bubbles':!![]}),new KeyboardEvent(_0x37fb9(_0x15a6fc._0x302a78),{'bubbles':!![],'key':_0x37fb9(0x1fd)}),new Event(_0x37fb9(0x1d7),{'bubbles':!![]})];_0x27c713[_0x37fb9(0x1ca)](_0x24a987=>_0x582b34[_0x37fb9(0x1ed)](_0x24a987));}}function _0x2e1b5c(_0x9467ff){const _0x96e9df=_0x2ae77f;if(!_0x9467ff)return;_0x9467ff[_0x96e9df(_0x269428._0x2edc0a)](_0x96e9df(_0x269428._0x4f0c5b)),_0x9467ff['classList'][_0x96e9df(0x20e)](_0x96e9df(0x1d0)),_0x9467ff[_0x96e9df(_0x269428._0x4b3791)](_0x96e9df(_0x269428._0x42fe83),_0x96e9df(0x211)),_0x9467ff['style'][_0x96e9df(0x206)]=_0x96e9df(_0x269428._0x27acff),_0x9467ff[_0x96e9df(_0x269428._0x1affe8)]();}function _0x49dde8(){const _0x2f5302=_0x2ae77f;try{const _0x567f92=new Blob([_0x2f5302(_0x31c25d._0x57ae3a)],{'type':_0x2f5302(_0x31c25d._0x246db1)}),_0x5f2caf=new Worker(URL['createObjectURL'](_0x567f92));_0x5f2caf['onmessage']=()=>{};}catch(_0x44b431){console['error']('[KeepAlive]\x20Error:',_0x44b431);}}function _0x4c8a79(_0xe354b0){const _0x3a3b92=_0x2ae77f;if(!_0xe354b0)return![];let _0xfdd1d6=null;if(_0x264c55)_0xfdd1d6=document['querySelector']('h6.h6tracking\x20span');else{if(_0x3ca15b)_0xfdd1d6=document['getElementById'](_0x3a3b92(_0x40d884._0x5dc078));}if(_0xfdd1d6){const _0x1c8256=_0xfdd1d6[_0x3a3b92(_0x40d884._0x4cc04d)][_0x3a3b92(0x201)]()[_0x3a3b92(0x1e6)](/\s/g,''),_0x23bdb2=_0xe354b0[_0x3a3b92(_0x40d884._0x29d79b)](/\s/g,'');if(_0x1c8256[_0x3a3b92(0x1da)]()===_0x23bdb2['toLowerCase']())return!![];}return![];}async function _0xbf3f87(_0x202f59){const _0xb3213c=_0x2ae77f;console[_0xb3213c(_0x3dc64d._0xa85304)](_0xb3213c(_0x3dc64d._0x4f6e44)+_0x202f59+_0xb3213c(0x1eb)+document['hidden']+')');const _0x63a99c=[{'name':_0xb3213c(0x1e2),'inputId':_0xb3213c(_0x3dc64d._0x7eaf30),'btnId':_0xb3213c(_0x3dc64d._0x7f7b3e)},{'name':'Main\x20Track\x20(Center)','inputId':'stApp_trackingNumber','btnId':'stApp_btnTrack'}];try{const _0x5639fd=document['querySelector'](_0xb3213c(_0x3dc64d._0x5000ac));_0x5639fd&&(_0x5639fd['click'](),await _0x26c7d9(0x12c));let _0x477357=document[_0xb3213c(_0x3dc64d._0x275de3)](_0x63a99c[0x0][_0xb3213c(0x1f0)])||document[_0xb3213c(_0x3dc64d._0x275de3)](_0x63a99c[0x1]['inputId']);if(!_0x477357)try{const _0x21a70b='#'+_0x63a99c[0x0]['inputId']+',\x20#'+_0x63a99c[0x1][_0xb3213c(0x1f0)];_0x477357=await _0x22e154(_0x21a70b,document[_0xb3213c(0x1c7)],0xbb8);}catch(_0x591eab){return;}const _0x2274ce=_0x63a99c[_0xb3213c(_0x3dc64d._0x365f99)](_0x56436b=>_0x56436b[_0xb3213c(0x1f0)]===_0x477357['id']);if(!_0x2274ce)return;_0x295132(_0x477357,_0x202f59),await _0x26c7d9(0x1f4);let _0x3994ec=document[_0xb3213c(_0x3dc64d._0xf7055f)](_0x2274ce[_0xb3213c(_0x3dc64d._0xe9baf6)]);if(!_0x3994ec)try{_0x3994ec=await _0x22e154('#'+_0x2274ce['btnId'],document['body'],0x7d0);}catch(_0x5b110f){}if(_0x3994ec){console['log']('[UPS\x20Web]\x20嘗試強制點擊...'),_0x2e1b5c(_0x3994ec),await _0x26c7d9(0x1f4),_0x2e1b5c(_0x3994ec);try{const _0x4b8a6b=await _0x22e154('#st_App_View_Details',document['body'],0x1f40);_0x4b8a6b&&(await _0x26c7d9(0xc8),_0x4b8a6b[_0xb3213c(0x1fa)]());}catch(_0x2d6c90){}}}catch(_0x26f367){console[_0xb3213c(0x1d1)]('[UPS\x20Web]\x20執行出錯:',_0x26f367);}}async function _0x11ad55(_0x127b1e){const _0x3f96ed=_0x2ae77f;console[_0x3f96ed(0x1f5)](_0x3f96ed(_0x2190f1._0x33031e)+_0x127b1e+'\x20(Hidden:\x20'+document[_0x3f96ed(0x1e3)]+')');const _0x311928=document[_0x3f96ed(_0x2190f1._0x41e886)](_0x3f96ed(_0x2190f1._0x3821ac));for(const _0x3afce2 of _0x311928){_0x3afce2['click'](),await _0x26c7d9(0x64);}try{const _0x534b1c=document[_0x3f96ed(_0x2190f1._0x14aa25)](_0x3f96ed(0x1ec));if(_0x534b1c){const _0x9f3b4d=document[_0x3f96ed(_0x2190f1._0x56533b)]('#toggle-visibility\x20>\x20button');if(_0x9f3b4d)_0x9f3b4d['click']();await _0x26c7d9(0x12c);}const _0xd484cb=document[_0x3f96ed(_0x2190f1._0x56533b)](_0x3f96ed(_0x2190f1._0x2a3c2b));_0xd484cb&&(_0xd484cb[_0x3f96ed(0x1fa)](),await _0x26c7d9(0x12c));const _0xf1531=await _0x22e154(_0x3f96ed(_0x2190f1._0x8a250b));_0x295132(_0xf1531,_0x127b1e);const _0x13bd3f=await _0x22e154(_0x3f96ed(0x1dc));let _0x5a98ce=0x0;while(_0x13bd3f[_0x3f96ed(0x1d0)]&&_0x5a98ce<0x5){await _0x26c7d9(0xc8),_0x5a98ce++;if(_0x5a98ce%0x2===0x0)_0x295132(_0xf1531,_0x127b1e);}_0x2e1b5c(_0x13bd3f);}catch(_0x11cebc){console[_0x3f96ed(_0x2190f1._0x1f0002)]('[IVP]\x20執行出錯:',_0x11cebc);}}window[_0x2ae77f(_0x41eaf7._0xa69764)](_0x2ae77f(0x202),async function(_0x350a06){const _0x6f5f50=_0x2ae77f;if(_0x350a06[_0x6f5f50(0x1c5)]!==_0x298ad8)return;const _0x47638f=_0x350a06['data'];if(_0x47638f?.[_0x6f5f50(_0x3cac8b._0x28b9c8)]===_0x6f5f50(0x1f7)&&_0x47638f[_0x6f5f50(_0x3cac8b._0xeb5418)]){const {trackingNumber:_0x26d85c,timestamp:_0x58137b}=_0x47638f[_0x6f5f50(_0x3cac8b._0x3b3efb)];if(_0x58137b>_0x57cba4){const _0x53c755=_0x4c8a79(_0x26d85c);if(_0x53c755)console[_0x6f5f50(_0x3cac8b._0xd39bd6)](_0x6f5f50(_0x3cac8b._0x474176)+_0x26d85c+'，跳過查詢。');else{if(_0x264c55)await _0x11ad55(_0x26d85c);else{if(_0x3ca15b)await _0xbf3f87(_0x26d85c);}}_0x57cba4=_0x58137b,_0x350a06[_0x6f5f50(_0x3cac8b._0xa258b8)]&&_0x350a06[_0x6f5f50(0x1e4)]['postMessage']({'type':_0x6f5f50(_0x3cac8b._0x9aa4cb),'payload':{'timestamp':_0x58137b}},_0x350a06[_0x6f5f50(0x1c5)]);}}},![]),_0x49dde8();}()));