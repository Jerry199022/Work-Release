// ==UserScript==
// @name         通用接收器
// @namespace    Universal Receiver
// @version      V15
// @description  同時支持 IVP 內部系統與 UPS 官網的自動查詢接收器。後臺保活功能。
// @author       Jerry Law
// @match        https://ivp.inside.ups.com/internal-visibility-portal*
// @match        https://www.ups.com/track*
// @grant        none
// @run-at       document-idle
// @updateURL    https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// @downloadURL  https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// ==/UserScript==

(function(_0x1d43f2,_0x128b92){const _0x309e79={_0x49b741:0x1b3,_0x364e18:0x1c0,_0x555857:0x1bd,_0x1268be:0x1a5},_0x1e7d84=_0x31ea,_0x467190=_0x1d43f2();while(!![]){try{const _0x519e72=parseInt(_0x1e7d84(0x1be))/0x1+parseInt(_0x1e7d84(0x1b5))/0x2*(-parseInt(_0x1e7d84(0x1d9))/0x3)+-parseInt(_0x1e7d84(_0x309e79._0x49b741))/0x4+-parseInt(_0x1e7d84(_0x309e79._0x364e18))/0x5+-parseInt(_0x1e7d84(_0x309e79._0x555857))/0x6*(-parseInt(_0x1e7d84(0x1b2))/0x7)+parseInt(_0x1e7d84(0x1a4))/0x8*(-parseInt(_0x1e7d84(_0x309e79._0x1268be))/0x9)+parseInt(_0x1e7d84(0x1cb))/0xa;if(_0x519e72===_0x128b92)break;else _0x467190['push'](_0x467190['shift']());}catch(_0x14f70d){_0x467190['push'](_0x467190['shift']());}}}(_0x310b,0x8b625),(function(){'use strict';const _0x500dec={_0x5b7230:0x1b4,_0x52c729:0x1aa,_0xca863b:0x1da,_0x569d10:0x1a8,_0x85789f:0x1b7},_0x4bc011={_0x43ebf9:0x1a3,_0x2db203:0x1ad,_0x561f03:0x1a9,_0x395023:0x1d8,_0x433731:0x1c4,_0x12a397:0x1d1},_0x31132c={_0x1f2eda:0x1cd,_0x9a4ee9:0x1b9,_0x2564e0:0x1d5,_0xa3e5e9:0x1b0,_0x250a9b:0x1c8,_0x17739d:0x1c3},_0x869eb0={_0x29cba4:0x1c5,_0x5210e2:0x1ae,_0x2aca01:0x1c1,_0x350487:0x1a0,_0x142d3d:0x1c6,_0x494e1b:0x19e,_0x38a2f0:0x1bc,_0x4ed426:0x1d2,_0x73e98:0x1c7,_0x338160:0x19f,_0x1c848d:0x1dc,_0x508ff3:0x1d5,_0x1b6111:0x1c2,_0x112f4f:0x19e,_0x5dfa88:0x1d3,_0x417735:0x1c8,_0x105d0d:0x1d6},_0x57b30f={_0xfa62dd:0x1c1,_0x2f9f19:0x19e,_0x42ae6b:0x1db,_0x321e1f:0x1ac},_0x2eb68e={_0x36afc2:0x1ce,_0x17bd85:0x19c},_0x12d767=_0x31ea;const _0x4f16e2=window[_0x12d767(_0x500dec._0x5b7230)]['hostname'],_0x1e1a23=_0x4f16e2[_0x12d767(0x19d)]('ivp.inside.ups.com'),_0x3d0440=_0x4f16e2[_0x12d767(0x19d)]('ups.com'),_0x1d5563='https://upsdrive.lightning.force.com';console['log'](_0x12d767(0x1bf)+_0x4f16e2),console['log'](_0x12d767(_0x500dec._0x52c729)+(_0x1e1a23?_0x12d767(0x1ab):_0x3d0440?_0x12d767(_0x500dec._0xca863b):_0x12d767(_0x500dec._0x569d10)));let _0x39f530=0x0;const _0x5a7f0f=_0xf5f79=>new Promise(_0x3a63e1=>setTimeout(_0x3a63e1,_0xf5f79));function _0x22774d(_0xa236f4,_0x75783f=document['body'],_0x555a92=0x1388){const _0x56af61={_0x13f64a:0x1c1},_0x4c1998={_0x799881:0x1dd};return new Promise((_0x2f35b6,_0x989662)=>{const _0x389a2d=_0x31ea,_0x3eb9a0=_0x75783f[_0x389a2d(_0x56af61._0x13f64a)](_0xa236f4);if(_0x3eb9a0)return _0x2f35b6(_0x3eb9a0);const _0x113222=new MutationObserver(()=>{const _0x35af59=_0x389a2d,_0x518236=_0x75783f[_0x35af59(0x1c1)](_0xa236f4);_0x518236&&(_0x113222[_0x35af59(0x1b8)](),_0x2f35b6(_0x518236));});_0x113222['observe'](_0x75783f,{'childList':!![],'subtree':!![]}),setTimeout(()=>{const _0x29ceb0=_0x389a2d;_0x113222[_0x29ceb0(0x1b8)](),_0x989662(new Error(_0x29ceb0(_0x4c1998._0x799881)+_0xa236f4+'\x22\x20超時'));},_0x555a92);});}function _0x4c3ff0(){const _0x9a9a6a=_0x12d767;try{const _0x5633da=new Blob(['\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20setInterval(()\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20self.postMessage(\x27tick\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20},\x2060000);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'],{'type':_0x9a9a6a(_0x2eb68e._0x36afc2)}),_0x3984b6=new Worker(URL['createObjectURL'](_0x5633da));_0x3984b6[_0x9a9a6a(0x1b1)]=()=>{},console['log'](_0x9a9a6a(_0x2eb68e._0x17bd85));}catch(_0x1bd0a2){console['error']('[KeepAlive]\x20啟動失敗:',_0x1bd0a2);}}function _0x3dba4c(_0x112aa3){const _0x3c2474=_0x12d767;if(!_0x112aa3)return![];let _0x1f570c=null,_0x589de8='';if(_0x1e1a23)_0x1f570c=document[_0x3c2474(_0x57b30f._0xfa62dd)](_0x3c2474(0x1ca));else _0x3d0440&&(_0x1f570c=document[_0x3c2474(_0x57b30f._0x2f9f19)](_0x3c2474(_0x57b30f._0x42ae6b)));if(_0x1f570c){_0x589de8=_0x1f570c[_0x3c2474(0x1af)]['trim']();const _0x345a02=_0x589de8['replace'](/\s/g,''),_0x3fe104=_0x112aa3[_0x3c2474(_0x57b30f._0x321e1f)](/\s/g,'');if(_0x345a02['toLowerCase']()===_0x3fe104[_0x3c2474(0x1ba)]())return!![];}return![];}async function _0x3dbef0(_0x32e039){const _0x588a78=_0x12d767;console['log'](_0x588a78(_0x869eb0._0x29cba4)+_0x32e039);const _0x455fac=[{'name':_0x588a78(0x1bb),'inputId':_0x588a78(0x1b6),'btnId':_0x588a78(0x1cc)},{'name':'Main\x20Track\x20(Center)','inputId':_0x588a78(0x1db),'btnId':_0x588a78(_0x869eb0._0x5210e2)}];try{const _0x40a8cd=document[_0x588a78(_0x869eb0._0x2aca01)](_0x588a78(_0x869eb0._0x350487));_0x40a8cd&&(console[_0x588a78(_0x869eb0._0x142d3d)]('[UPS\x20Web]\x20檢測到彈窗關閉按鈕，正在點擊...'),_0x40a8cd['click'](),await _0x5a7f0f(0x12c));let _0x4e0dca=document[_0x588a78(0x19e)](_0x455fac[0x0]['inputId'])||document[_0x588a78(_0x869eb0._0x494e1b)](_0x455fac[0x1][_0x588a78(0x1bc)]);if(!_0x4e0dca)try{const _0x13b9d0='#'+_0x455fac[0x0][_0x588a78(_0x869eb0._0x38a2f0)]+_0x588a78(_0x869eb0._0x4ed426)+_0x455fac[0x1][_0x588a78(_0x869eb0._0x38a2f0)];_0x4e0dca=await _0x22774d(_0x13b9d0,document['body'],0xbb8);}catch(_0x5a00fe){console[_0x588a78(0x1cf)](_0x588a78(0x1a1));return;}const _0x22616e=_0x455fac['find'](_0xfc8edd=>_0xfc8edd[_0x588a78(0x1bc)]===_0x4e0dca['id']);if(!_0x22616e)return;_0x4e0dca[_0x588a78(_0x869eb0._0x73e98)](),_0x4e0dca['value']='',_0x4e0dca[_0x588a78(0x1b9)]=_0x32e039,_0x4e0dca['dispatchEvent'](new Event(_0x588a78(_0x869eb0._0x338160),{'bubbles':!![]})),_0x4e0dca[_0x588a78(0x1d5)](new Event(_0x588a78(_0x869eb0._0x1c848d),{'bubbles':!![]})),_0x4e0dca[_0x588a78(_0x869eb0._0x508ff3)](new Event(_0x588a78(_0x869eb0._0x1b6111),{'bubbles':!![]})),await _0x5a7f0f(0xc8);let _0xf48d0=document[_0x588a78(_0x869eb0._0x112f4f)](_0x22616e[_0x588a78(_0x869eb0._0x5dfa88)]);if(!_0xf48d0)try{_0xf48d0=await _0x22774d('#'+_0x22616e['btnId'],document['body'],0x7d0);}catch(_0x23bab1){}if(_0xf48d0){_0xf48d0[_0x588a78(_0x869eb0._0x417735)]();try{const _0x1ac16d=await _0x22774d(_0x588a78(0x1c9),document[_0x588a78(0x1a2)],0x2710);_0x1ac16d&&(await _0x5a7f0f(0x64),_0x1ac16d['click']());}catch(_0x2bd9d9){}}}catch(_0x592774){console[_0x588a78(0x1cf)](_0x588a78(_0x869eb0._0x105d0d),_0x592774);}}async function _0xec9221(_0x13fb41){const _0x3664d9=_0x12d767;console[_0x3664d9(0x1c6)]('[IVP]\x20執行查詢:\x20'+_0x13fb41);const _0xb4da4=document[_0x3664d9(_0x31132c._0x1f2eda)]('div.cdk-overlay-pane\x20li:has(em.fa-times)');for(const _0x11acfd of _0xb4da4){_0x11acfd[_0x3664d9(0x1c8)](),await _0x5a7f0f(0x64);}try{const _0x11b1f4=document['querySelector'](_0x3664d9(0x1d0));if(_0x11b1f4){const _0x2c4015=document['querySelector'](_0x3664d9(0x1d4));if(_0x2c4015)_0x2c4015['click']();await _0x5a7f0f(0xc8);}const _0x437938=document[_0x3664d9(0x1c1)]('div.action-buttons\x20button[aria-label=\x22Clear\x22]');_0x437938&&(_0x437938[_0x3664d9(0x1c8)](),await _0x5a7f0f(0xc8));const _0x549d88=await _0x22774d(_0x3664d9(0x1d7));_0x549d88[_0x3664d9(_0x31132c._0x9a4ee9)]=_0x13fb41,_0x549d88[_0x3664d9(_0x31132c._0x2564e0)](new Event(_0x3664d9(0x19f),{'bubbles':!![]}));const _0x105d73=await _0x22774d(_0x3664d9(_0x31132c._0xa3e5e9));if(_0x105d73[_0x3664d9(0x1a6)])await _0x5a7f0f(0xc8);!_0x105d73[_0x3664d9(0x1a6)]?_0x105d73[_0x3664d9(_0x31132c._0x250a9b)]():console['warn'](_0x3664d9(_0x31132c._0x17739d));}catch(_0x21b36c){console['error']('[IVP]\x20執行出錯:',_0x21b36c);}}window[_0x12d767(_0x500dec._0x85789f)]('message',async function(_0x394df7){const _0x1ececb=_0x12d767;if(_0x394df7[_0x1ececb(_0x4bc011._0x43ebf9)]!==_0x1d5563)return;const _0x424019=_0x394df7[_0x1ececb(_0x4bc011._0x2db203)];if(_0x424019?.[_0x1ececb(_0x4bc011._0x561f03)]===_0x1ececb(_0x4bc011._0x395023)&&_0x424019[_0x1ececb(_0x4bc011._0x433731)]){const {trackingNumber:_0x5818b5,timestamp:_0x3bdb40}=_0x424019[_0x1ececb(_0x4bc011._0x433731)];if(_0x3bdb40>_0x39f530){const _0x334984=_0x3dba4c(_0x5818b5);if(_0x334984)console[_0x1ececb(0x1c6)]('[Receiver]\x20頁面已顯示號碼\x20'+_0x5818b5+'，跳過查詢。');else{if(_0x1e1a23)await _0xec9221(_0x5818b5);else _0x3d0440&&await _0x3dbef0(_0x5818b5);}_0x39f530=_0x3bdb40,_0x394df7[_0x1ececb(0x1d1)]&&_0x394df7[_0x1ececb(_0x4bc011._0x12a397)][_0x1ececb(0x1a7)]({'type':'CEC_REQUEST_RECEIVED','payload':{'timestamp':_0x3bdb40}},_0x394df7[_0x1ececb(_0x4bc011._0x43ebf9)]);}}},![]),_0x4c3ff0();}()));function _0x31ea(_0x15aa39,_0x40f243){const _0x310b2e=_0x310b();return _0x31ea=function(_0x31eabe,_0x338e6d){_0x31eabe=_0x31eabe-0x19c;let _0x39304f=_0x310b2e[_0x31eabe];if(_0x31ea['impOMu']===undefined){var _0x5a1920=function(_0x4f16e2){const _0x1e1a23='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3d0440='',_0x1d5563='';for(let _0x39f530=0x0,_0x5a7f0f,_0x22774d,_0x4c3ff0=0x0;_0x22774d=_0x4f16e2['charAt'](_0x4c3ff0++);~_0x22774d&&(_0x5a7f0f=_0x39f530%0x4?_0x5a7f0f*0x40+_0x22774d:_0x22774d,_0x39f530++%0x4)?_0x3d0440+=String['fromCharCode'](0xff&_0x5a7f0f>>(-0x2*_0x39f530&0x6)):0x0){_0x22774d=_0x1e1a23['indexOf'](_0x22774d);}for(let _0x3dba4c=0x0,_0x3dbef0=_0x3d0440['length'];_0x3dba4c<_0x3dbef0;_0x3dba4c++){_0x1d5563+='%'+('00'+_0x3d0440['charCodeAt'](_0x3dba4c)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x1d5563);};_0x31ea['HGmbvM']=_0x5a1920,_0x15aa39=arguments,_0x31ea['impOMu']=!![];}const _0x309f84=_0x310b2e[0x0],_0x3bc25b=_0x31eabe+_0x309f84,_0x837dac=_0x15aa39[_0x3bc25b];return!_0x837dac?(_0x39304f=_0x31ea['HGmbvM'](_0x39304f),_0x15aa39[_0x3bc25b]=_0x39304f):_0x39304f=_0x837dac,_0x39304f;},_0x31ea(_0x15aa39,_0x40f243);}function _0x310b(){const _0x578a80=['mtuYvxrbr0PK','mJy1mZy1Bxz5wNfL','zgLZywjSzwq','Cg9ZDe1LC3nHz2u','vw5RBM93BIbnB2rL','DhLWzq','w01VzgvDia','svzqie1Vzgu','CMvWBgfJzq','zgf0yq','C3rbChbFyNrUvhjHy2S','Dgv4DenVBNrLBNq','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLT0ExbLpsjZDwjTAxqIxq','B25TzxnZywDL','mJC3ntu0oxDKwevWtG','mJK4nZmWnermzLPWBG','Bg9JyxrPB24','mLvUDfH3sG','C3rbChbFDhjHy2Tbz2fPBL90CMfJA2LUz051BuvUDhj5','ywrKrxzLBNrmAxn0zw5LCG','zgLZy29UBMvJDa','DMfSDwu','Dg9mB3DLCKnHC2u','vhjHy2SGqwDHAw4GkfrVCcK','Aw5WDxrjza','nKLuCwjXBq','mJG1mtm0tfPUAuX0','w1vUAxzLCNnHBcbszwnLAxzLCIbwmtrDiowvN+wlLEAwVdOG','mZKZmJuXnw9tELjXEq','CxvLCNLtzwXLy3rVCG','yMX1CG','w0Lwuf0G5O+q5lQK5OYj6yIv5lUn6jMv5PA856Ab55sO54Ua5Owl44cc','Cgf5Bg9Hza','w1vquYbxzwjDiowFT+IHJoAFPEIPOJOG','Bg9N','zM9JDxm','y2XPy2S','i3n0x0fWCf9wAwv3x0rLDgfPBhm','AdyUAdz0CMfJA2LUzYbZCgfU','mJi2nta2mtbIrhjPEuu','C3rbChbFDhjHy2Tbz2fPBL9NzxruCMfJAW','CxvLCNLtzwXLy3rVCKfSBa','yxbWBgLJyxrPB24VAMf2yxnJCMLWDa','zxjYB3i','i21HAw5dB250ywLUzxiGpIbHChaTDhjHy2TPBMCGpIbKAxyGpIbKAxyGpIbKAxyUy29UDgfPBMvYlwzSDwLKlMqTBM9Uzq','C291CMnL','lcaJ','yNrUswq','i3rVz2DSzs12AxnPyMLSAxr5id4GyNv0Dg9U','zgLZCgf0y2HfDMvUDa','w1vquYbxzwjDiowFT+IHJowhUUMmRZO','Aw5WDxrBAwq9iKvUDgvYifrYywnRAw5Nie51BwjLCIjD','q0vdx1nfqvjdsf9srvfvrvnu','odq2nZiZA0nqDNnV','vvbtifDLyIbnB2rL','C3rbChbFDhjHy2TPBMDoDw1Izxi','y2HHBMDL','562j5B6f5ywd57sGici','w0TLzxbbBgL2zv0G5l+D5Rs75QMF5yI25BEY5zwF5yUvic0G6Ac7546hoIaX5yIg6zcyl+ASOq','Aw5JBhvKzxm','z2v0rwXLBwvUDej5swq','Aw5WDxq','yNv0Dg9UlMnSB3nLw2rHDgeTzgLZBwLZCZ0IBw9KywWIxq','w1vquYbxzwjDioACQUAjVUwiSos7U+s9LEwpR+EuQoEAHoI8UowfPEAHHUoaGG','yM9KEq','B3jPz2LU'];_0x310b=function(){return _0x578a80;};return _0x310b();}