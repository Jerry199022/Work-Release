// ==UserScript==
// @name         通用接收器
// @namespace    Universal Receiver
// @version      V21
// @description  同時支持 IVP 內部系統與 UPS 官網的自動查詢接收器。修復後台UPS官網因自身腳本崩潰導致按鈕無法點擊的問題(V21: 強制解鎖模式)。
// @author       Jerry Law
// @match        https://ivp.inside.ups.com/internal-visibility-portal*
// @match        https://www.ups.com/track*
// @grant        none
// @run-at       document-idle
// @updateURL    https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// @downloadURL  https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// ==/UserScript==

(function(_0xb62881,_0x4d5bc6){const _0x4a343a={_0x3f2e3f:0x1bc,_0x2d3c10:0x1dd,_0x35d84f:0x1b3,_0x4c6148:0x1d2},_0x365e65=_0x4c1d,_0x329c77=_0xb62881();while(!![]){try{const _0x49a1d0=parseInt(_0x365e65(_0x4a343a._0x3f2e3f))/0x1*(parseInt(_0x365e65(0x1d1))/0x2)+parseInt(_0x365e65(0x1d7))/0x3+-parseInt(_0x365e65(_0x4a343a._0x2d3c10))/0x4+parseInt(_0x365e65(_0x4a343a._0x35d84f))/0x5+-parseInt(_0x365e65(0x1b2))/0x6+-parseInt(_0x365e65(0x1c3))/0x7*(parseInt(_0x365e65(0x1b1))/0x8)+-parseInt(_0x365e65(0x1b9))/0x9*(-parseInt(_0x365e65(_0x4a343a._0x4c6148))/0xa);if(_0x49a1d0===_0x4d5bc6)break;else _0x329c77['push'](_0x329c77['shift']());}catch(_0x454c3d){_0x329c77['push'](_0x329c77['shift']());}}}(_0x33d9,0xd9b4c),(function(){'use strict';const _0x253059={_0x214c89:0x1a2,_0x1d7e67:0x1c1,_0x5bd3d9:0x1cb,_0x38e5c3:0x1ba},_0x4d21c5={_0x468ecf:0x1d0,_0x90c901:0x19e,_0x94e696:0x1c8,_0x3950c5:0x1b7,_0x435374:0x1b0},_0x3ac064={_0x5b4919:0x199,_0x2ce34d:0x1ad,_0x266ad6:0x1a7,_0x2b481e:0x1a9,_0x297bdb:0x1a3,_0x56922b:0x1a8},_0x21b323={_0x3ba48a:0x1b8,_0x3e2997:0x1c7,_0x4e2ce0:0x1d4,_0x5edb10:0x1ae,_0x366c26:0x197,_0x1e07bf:0x1bb},_0x52ece9={_0x100347:0x1ab,_0x178a47:0x1ab},_0x58871f={_0x18c1bb:0x1b4,_0x14b42a:0x198},_0x169c6d={_0x49ee55:0x1c6,_0xb766c1:0x1d9,_0x421e4f:0x1dc,_0x1d420a:0x1cf},_0x41652e={_0x319a48:0x1de,_0x53fdaf:0x1d5,_0x30929a:0x1d3,_0x5cd214:0x1db,_0x4c3856:0x1c4},_0xf171ec=_0x4c1d;const _0x2cea37=window[_0xf171ec(_0x253059._0x214c89)][_0xf171ec(_0x253059._0x1d7e67)],_0x5deeb4=_0x2cea37[_0xf171ec(0x1cb)](_0xf171ec(0x1aa)),_0x53b169=_0x2cea37[_0xf171ec(_0x253059._0x5bd3d9)](_0xf171ec(0x19d)),_0x4fe376='https://upsdrive.lightning.force.com';console[_0xf171ec(0x1d0)]('[Universal\x20Receiver\x20V21]\x20啟動於:\x20'+_0x2cea37+_0xf171ec(0x1cc));let _0x5568bd=0x0;const _0x3b6fbe=_0x35a369=>new Promise(_0x454b85=>setTimeout(_0x454b85,_0x35a369));function _0x2cc521(_0x48431f,_0x5a3fb8=document[_0xf171ec(0x1bb)],_0x5d7fbe=0x1388){const _0x394a4f={_0x5a63d9:0x1a5};return new Promise((_0x1b6865,_0x395bc7)=>{const _0x3f96b2={_0x5b1607:0x19a},_0x21b520=_0x4c1d,_0x195bf3=_0x5a3fb8[_0x21b520(0x1ae)](_0x48431f);if(_0x195bf3)return _0x1b6865(_0x195bf3);const _0x240a4e=new MutationObserver(()=>{const _0x17d5bc=_0x21b520,_0xc70931=_0x5a3fb8[_0x17d5bc(0x1ae)](_0x48431f);_0xc70931&&(_0x240a4e[_0x17d5bc(_0x3f96b2._0x5b1607)](),_0x1b6865(_0xc70931));});_0x240a4e[_0x21b520(_0x394a4f._0x5a63d9)](_0x5a3fb8,{'childList':!![],'subtree':!![]}),setTimeout(()=>{const _0x3dbe1f=_0x21b520;_0x240a4e['disconnect'](),_0x395bc7(new Error(_0x3dbe1f(0x1c5)+_0x48431f+'\x22\x20超時'));},_0x5d7fbe);});}function _0x18da84(_0x3b1cc5,_0x293b60){const _0x5f17c2=_0xf171ec;if(!_0x3b1cc5)return;const _0x540094=document['hidden'];if(!_0x540094)try{_0x3b1cc5[_0x5f17c2(_0x41652e._0x319a48)]();}catch(_0x1ae623){}try{const _0x58b9d2=Object['getOwnPropertyDescriptor'](window[_0x5f17c2(0x1ac)]['prototype'],'value')[_0x5f17c2(_0x41652e._0x53fdaf)];_0x58b9d2['call'](_0x3b1cc5,_0x293b60);}catch(_0x98a71){_0x3b1cc5[_0x5f17c2(0x19c)]=_0x293b60;}if(_0x3b1cc5[_0x5f17c2(0x19c)]!==_0x293b60)_0x3b1cc5['value']=_0x293b60;if(_0x540094)_0x3b1cc5[_0x5f17c2(0x1a0)](new Event('input',{'bubbles':!![]})),_0x3b1cc5[_0x5f17c2(0x1a0)](new Event(_0x5f17c2(_0x41652e._0x30929a),{'bubbles':!![]})),_0x3b1cc5['dispatchEvent'](new Event(_0x5f17c2(0x1af),{'bubbles':!![]}));else{const _0x4f0fac=[new KeyboardEvent(_0x5f17c2(_0x41652e._0x5cd214),{'bubbles':!![],'key':'Process'}),new KeyboardEvent('keypress',{'bubbles':!![],'key':'Process'}),new Event('input',{'bubbles':!![]}),new Event(_0x5f17c2(0x1d3),{'bubbles':!![]}),new KeyboardEvent(_0x5f17c2(_0x41652e._0x4c3856),{'bubbles':!![],'key':_0x5f17c2(0x19b)}),new Event(_0x5f17c2(0x1af),{'bubbles':!![]})];_0x4f0fac[_0x5f17c2(0x19f)](_0x40a285=>_0x3b1cc5[_0x5f17c2(0x1a0)](_0x40a285));}}function _0x4acfb6(_0x550f18){const _0x23bd6d=_0xf171ec;if(!_0x550f18)return;_0x550f18[_0x23bd6d(_0x169c6d._0x49ee55)]('disabled'),_0x550f18[_0x23bd6d(_0x169c6d._0xb766c1)][_0x23bd6d(0x1bd)](_0x23bd6d(0x1d8)),_0x550f18['setAttribute']('aria-disabled','false'),_0x550f18[_0x23bd6d(_0x169c6d._0x421e4f)]['border']=_0x23bd6d(_0x169c6d._0x1d420a),_0x550f18[_0x23bd6d(0x1a3)]();}function _0x275a6d(){const _0x56ba65=_0xf171ec;try{const _0x24c2f6=new Blob(['setInterval(()\x20=>\x20self.postMessage(\x27tick\x27),\x20250);'],{'type':_0x56ba65(_0x58871f._0x18c1bb)}),_0x2e9192=new Worker(URL[_0x56ba65(0x1a4)](_0x24c2f6));_0x2e9192[_0x56ba65(0x1ca)]=()=>{};}catch(_0x2bf9ac){console[_0x56ba65(_0x58871f._0x14b42a)]('[KeepAlive]\x20Error:',_0x2bf9ac);}}function _0x412e1f(_0x5394ac){const _0x5d2d0a=_0xf171ec;if(!_0x5394ac)return![];let _0x2a52a2=null;if(_0x5deeb4)_0x2a52a2=document[_0x5d2d0a(0x1ae)](_0x5d2d0a(0x1b6));else{if(_0x53b169)_0x2a52a2=document[_0x5d2d0a(0x197)]('stApp_trackingNumber');}if(_0x2a52a2){const _0x48a396=_0x2a52a2['textContent']['trim']()[_0x5d2d0a(_0x52ece9._0x100347)](/\s/g,''),_0x4b1492=_0x5394ac[_0x5d2d0a(_0x52ece9._0x178a47)](/\s/g,'');if(_0x48a396[_0x5d2d0a(0x1df)]()===_0x4b1492['toLowerCase']())return!![];}return![];}async function _0x275b9f(_0x4bcc97){const _0x2ec6ca=_0xf171ec;console[_0x2ec6ca(0x1d0)]('[UPS\x20Web]\x20執行查詢:\x20'+_0x4bcc97+_0x2ec6ca(0x199)+document[_0x2ec6ca(0x1ad)]+')');const _0x311833=[{'name':_0x2ec6ca(0x1a1),'inputId':_0x2ec6ca(_0x21b323._0x3ba48a),'btnId':_0x2ec6ca(_0x21b323._0x3e2997)},{'name':_0x2ec6ca(_0x21b323._0x4e2ce0),'inputId':'stApp_trackingNumber','btnId':'stApp_btnTrack'}];try{const _0x484ad0=document[_0x2ec6ca(_0x21b323._0x5edb10)]('button.close[data-dismiss=\x22modal\x22]');_0x484ad0&&(_0x484ad0[_0x2ec6ca(0x1a3)](),await _0x3b6fbe(0x12c));let _0xe09338=document[_0x2ec6ca(_0x21b323._0x366c26)](_0x311833[0x0][_0x2ec6ca(0x1b5)])||document['getElementById'](_0x311833[0x1]['inputId']);if(!_0xe09338)try{const _0x18b8a6='#'+_0x311833[0x0][_0x2ec6ca(0x1b5)]+',\x20#'+_0x311833[0x1]['inputId'];_0xe09338=await _0x2cc521(_0x18b8a6,document['body'],0xbb8);}catch(_0x2404fa){return;}const _0x1bbce9=_0x311833[_0x2ec6ca(0x1d6)](_0x31e376=>_0x31e376['inputId']===_0xe09338['id']);if(!_0x1bbce9)return;_0x18da84(_0xe09338,_0x4bcc97),await _0x3b6fbe(0x1f4);let _0x31ed6e=document['getElementById'](_0x1bbce9[_0x2ec6ca(0x1cd)]);if(!_0x31ed6e)try{_0x31ed6e=await _0x2cc521('#'+_0x1bbce9[_0x2ec6ca(0x1cd)],document[_0x2ec6ca(0x1bb)],0x7d0);}catch(_0x4a55c4){}if(_0x31ed6e){console['log']('[UPS\x20Web]\x20嘗試強制點擊...'),_0x4acfb6(_0x31ed6e),await _0x3b6fbe(0x1f4),_0x4acfb6(_0x31ed6e);try{const _0x3a60ae=await _0x2cc521(_0x2ec6ca(0x1a6),document[_0x2ec6ca(_0x21b323._0x1e07bf)],0x1f40);_0x3a60ae&&(await _0x3b6fbe(0xc8),_0x3a60ae['click']());}catch(_0x51044d){}}}catch(_0x5f5da5){console[_0x2ec6ca(0x198)]('[UPS\x20Web]\x20執行出錯:',_0x5f5da5);}}async function _0x4d501f(_0x4bbedc){const _0x1548ea=_0xf171ec;console[_0x1548ea(0x1d0)]('[IVP]\x20執行查詢:\x20'+_0x4bbedc+_0x1548ea(_0x3ac064._0x5b4919)+document[_0x1548ea(_0x3ac064._0x2ce34d)]+')');const _0x552773=document[_0x1548ea(_0x3ac064._0x266ad6)]('div.cdk-overlay-pane\x20li:has(em.fa-times)');for(const _0x14b3b8 of _0x552773){_0x14b3b8[_0x1548ea(0x1a3)](),await _0x3b6fbe(0x64);}try{const _0x569962=document['querySelector'](_0x1548ea(_0x3ac064._0x2b481e));if(_0x569962){const _0x415ed7=document[_0x1548ea(0x1ae)]('#toggle-visibility\x20>\x20button');if(_0x415ed7)_0x415ed7[_0x1548ea(_0x3ac064._0x297bdb)]();await _0x3b6fbe(0x12c);}const _0x2b3bf3=document['querySelector'](_0x1548ea(0x1da));_0x2b3bf3&&(_0x2b3bf3['click'](),await _0x3b6fbe(0x12c));const _0x1e9e3c=await _0x2cc521('input[id=\x22Enter\x20Tracking\x20Number\x22]');_0x18da84(_0x1e9e3c,_0x4bbedc);const _0x13729b=await _0x2cc521(_0x1548ea(_0x3ac064._0x56922b));let _0x491b37=0x0;while(_0x13729b['disabled']&&_0x491b37<0x5){await _0x3b6fbe(0xc8),_0x491b37++;if(_0x491b37%0x2===0x0)_0x18da84(_0x1e9e3c,_0x4bbedc);}_0x4acfb6(_0x13729b);}catch(_0x1c74a0){console[_0x1548ea(0x198)](_0x1548ea(0x1c0),_0x1c74a0);}}window[_0xf171ec(_0x253059._0x38e5c3)]('message',async function(_0x32b66d){const _0x46abb7=_0xf171ec;if(_0x32b66d[_0x46abb7(0x1ce)]!==_0x4fe376)return;const _0x4ecc4b=_0x32b66d[_0x46abb7(0x1c9)];if(_0x4ecc4b?.['type']===_0x46abb7(0x1be)&&_0x4ecc4b[_0x46abb7(0x1bf)]){const {trackingNumber:_0x217b3e,timestamp:_0x59ae16}=_0x4ecc4b[_0x46abb7(0x1bf)];if(_0x59ae16>_0x5568bd){const _0x5e4c02=_0x412e1f(_0x217b3e);if(_0x5e4c02)console[_0x46abb7(_0x4d21c5._0x468ecf)](_0x46abb7(_0x4d21c5._0x90c901)+_0x217b3e+_0x46abb7(0x1c2));else{if(_0x5deeb4)await _0x4d501f(_0x217b3e);else{if(_0x53b169)await _0x275b9f(_0x217b3e);}}_0x5568bd=_0x59ae16,_0x32b66d[_0x46abb7(_0x4d21c5._0x94e696)]&&_0x32b66d[_0x46abb7(0x1c8)][_0x46abb7(_0x4d21c5._0x3950c5)]({'type':_0x46abb7(_0x4d21c5._0x435374),'payload':{'timestamp':_0x59ae16}},_0x32b66d[_0x46abb7(0x1ce)]);}}},![]),_0x275a6d();}()));function _0x4c1d(_0x101ac8,_0x2ad330){const _0x33d9e2=_0x33d9();return _0x4c1d=function(_0x4c1d1c,_0x450e17){_0x4c1d1c=_0x4c1d1c-0x197;let _0x349e21=_0x33d9e2[_0x4c1d1c];if(_0x4c1d['SVwlGt']===undefined){var _0x432cf6=function(_0x2cea37){const _0x5deeb4='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x53b169='',_0x4fe376='';for(let _0x5568bd=0x0,_0x3b6fbe,_0x2cc521,_0x18da84=0x0;_0x2cc521=_0x2cea37['charAt'](_0x18da84++);~_0x2cc521&&(_0x3b6fbe=_0x5568bd%0x4?_0x3b6fbe*0x40+_0x2cc521:_0x2cc521,_0x5568bd++%0x4)?_0x53b169+=String['fromCharCode'](0xff&_0x3b6fbe>>(-0x2*_0x5568bd&0x6)):0x0){_0x2cc521=_0x5deeb4['indexOf'](_0x2cc521);}for(let _0x4acfb6=0x0,_0x275a6d=_0x53b169['length'];_0x4acfb6<_0x275a6d;_0x4acfb6++){_0x4fe376+='%'+('00'+_0x53b169['charCodeAt'](_0x4acfb6)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x4fe376);};_0x4c1d['MtDkci']=_0x432cf6,_0x101ac8=arguments,_0x4c1d['SVwlGt']=!![];}const _0x2d6606=_0x33d9e2[0x0],_0x212c76=_0x4c1d1c+_0x2d6606,_0x37ee83=_0x101ac8[_0x212c76];return!_0x37ee83?(_0x349e21=_0x4c1d['MtDkci'](_0x349e21),_0x101ac8[_0x212c76]=_0x349e21):_0x349e21=_0x37ee83,_0x349e21;},_0x4c1d(_0x101ac8,_0x2ad330);}function _0x33d9(){const _0x5c618a=['q0vdx1jfuvvfu1rFuKvdruLwruq','nZG0BfrithLU','ntu3nta1nKjKDNDXBq','ntu1ntCWnurhzxzjzG','yxbWBgLJyxrPB24VAMf2yxnJCMLWDa','Aw5WDxrjza','AdyUAdz0CMfJA2LUzYbZCgfU','Cg9ZDe1LC3nHz2u','C3rbChbFDhjHy2Tbz2fPBL90CMfJA2LUz051BuvUDhj5','ow9YqxbZwa','ywrKrxzLBNrmAxn0zw5LCG','yM9KEq','ndCWmZK4q1LnyLvb','CMvTB3zL','q0vdx1nfqvjdsf9srvfvrvnu','Cgf5Bg9Hza','w0Lwuf0G5z+36kgm5yE66yYVoG','Ag9ZDg5HBwu','77Ym6lEZ6ygo5P+L6kMI44cc','mtq2mJnoz2LhqNe','A2v5Dxa','562j5B6f5ywd57sGici','CMvTB3zLqxr0CMLIDxrL','C3rbChbFDhjHy2Tbz2fPBL9NzxruCMfJAW','C291CMnL','zgf0yq','B25TzxnZywDL','Aw5JBhvKzxm','icJLVlFLIlBOP6pPJPBMQkhLVi8P','yNrUswq','B3jPz2LU','mNb4ihnVBgLKihjLza','Bg9N','nevzCKP4sW','nJuZnJqXmhHdshnZsq','y2HHBMDL','twfPBIbuCMfJAYaOq2vUDgvYkq','C2v0','zMLUza','ndq5nZiXBfbMze1i','zgLZywjSzwq','y2XHC3nmAxn0','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLTHCMLHlwXHyMvSpsjdBgvHCIjD','A2v5zg93BG','C3r5Bgu','mZmXotq1mMfhwfHwAW','zM9JDxm','Dg9mB3DLCKnHC2u','z2v0rwXLBwvUDej5swq','zxjYB3i','icHiAwrKzw46ia','zgLZy29UBMvJDa','uhjVy2vZCW','DMfSDwu','DxbZlMnVBq','w1jLy2vPDMvYxsdPOihPNAlLT7lPOA/NPlROMz/NORWG','zM9YrwfJAa','zgLZCgf0y2HfDMvUDa','vhjHy2SGqwDHAw4GkfrVCcK','Bg9JyxrPB24','y2XPy2S','y3jLyxrLt2jQzwn0vvjm','B2jZzxj2zq','i3n0x0fWCf9wAwv3x0rLDgfPBhm','CxvLCNLtzwXLy3rVCKfSBa','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLT0ExbLpsjZDwjTAxqIxq','i21HAw5dB250ywLUzxiGpIbHChaTDhjHy2TPBMCGpIbKAxyGpIbKAxyGpIbKAxyUy29UDgfPBMvYlwzSDwLKlMqTBM9Uzq','AxzWlMLUC2LKzs51ChmUy29T','CMvWBgfJzq','sfrnteLUChv0rwXLBwvUDa','AgLKzgvU','CxvLCNLtzwXLy3rVCG','yMX1CG'];_0x33d9=function(){return _0x5c618a;};return _0x33d9();}