// ==UserScript==
// @name         通用接收器
// @namespace    Universal Receiver
// @version      V21
// @description  同時支持 IVP 內部系統與 UPS 官網的自動查詢接收器。修復後台UPS官網因自身腳本崩潰導致按鈕無法點擊的問題(V21: 強制解鎖模式)。
// @author       Jerry Law
// @match        https://ivp.inside.ups.com/internal-visibility-portal*
// @match        https://www.ups.com/track*
// @grant        none
// @run-at       document-idle
// @updateURL    https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// @downloadURL  https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// ==/UserScript==

(function(_0x5877b6,_0x2bb3f1){const _0x37cf56={_0xe6d6e:0x15a,_0x530c35:0x146,_0x253755:0x159},_0x2521cc=_0x515c,_0x478503=_0x5877b6();while(!![]){try{const _0x4f4280=parseInt(_0x2521cc(_0x37cf56._0xe6d6e))/0x1+-parseInt(_0x2521cc(0x15b))/0x2*(parseInt(_0x2521cc(0x144))/0x3)+-parseInt(_0x2521cc(0x125))/0x4+parseInt(_0x2521cc(_0x37cf56._0x530c35))/0x5*(-parseInt(_0x2521cc(0x155))/0x6)+-parseInt(_0x2521cc(0x136))/0x7+-parseInt(_0x2521cc(_0x37cf56._0x253755))/0x8*(-parseInt(_0x2521cc(0x14b))/0x9)+parseInt(_0x2521cc(0x140))/0xa;if(_0x4f4280===_0x2bb3f1)break;else _0x478503['push'](_0x478503['shift']());}catch(_0x465a9a){_0x478503['push'](_0x478503['shift']());}}}(_0x438c,0xbd0a9),(function(){'use strict';const _0x132c3d={_0x2e300a:0x14f,_0x526072:0x130,_0x4aca6b:0x162,_0x3ca198:0x139,_0x55cebf:0x173},_0x46abf4={_0x10873c:0x124,_0x1a20fa:0x13a,_0xd3e244:0x12e,_0x4a2fb0:0x12e,_0x56c3a5:0x162,_0x3d5ee8:0x135},_0x5e5b8c={_0xa339b5:0x153,_0xb5c899:0x16b,_0x3cc065:0x174,_0x2e30f2:0x14a,_0x2f5f63:0x12c,_0x35193e:0x13b,_0x347c59:0x138},_0x7ad453={_0x207f5a:0x153,_0x1b6d6f:0x152,_0x2c5edf:0x151,_0x25bd26:0x150,_0x2edd0c:0x175,_0x265a98:0x15f},_0x3d6c07={_0x494f5d:0x164,_0x55b01a:0x12b},_0x331d81={_0x31e82e:0x171,_0x3d429a:0x16c,_0x66143b:0x13d},_0x1a1623={_0x11a5e8:0x15d,_0x3a8040:0x154,_0x54fdca:0x14d,_0x1588f4:0x168,_0x16e4bf:0x16f,_0x20956c:0x165,_0x157fd9:0x158},_0xfaca5e={_0x25f851:0x132,_0x5eb049:0x141,_0xaae4ad:0x161,_0x4e7911:0x16e,_0x1a39b3:0x13c,_0x5b601e:0x13c,_0x175880:0x13c,_0x1fc473:0x147,_0x114265:0x133,_0x1f9811:0x145},_0x4de6d3=_0x515c;const _0xe2f78a=window['location'][_0x4de6d3(0x157)],_0x4efc71=_0xe2f78a['includes'](_0x4de6d3(_0x132c3d._0x2e300a)),_0x47ed1e=_0xe2f78a[_0x4de6d3(0x126)](_0x4de6d3(_0x132c3d._0x526072)),_0x38ef55='https://upsdrive.lightning.force.com';console[_0x4de6d3(_0x132c3d._0x4aca6b)](_0x4de6d3(0x14e)+_0xe2f78a+_0x4de6d3(_0x132c3d._0x3ca198));let _0x35a3b1=0x0;const _0x443111=_0x164a6c=>new Promise(_0x2f767b=>setTimeout(_0x2f767b,_0x164a6c));function _0x3aba84(_0x314260,_0x1ed1a9=document[_0x4de6d3(0x137)],_0x5aedf6=0x1388){const _0x3e6cee={_0x16cc09:0x16a};return new Promise((_0x3363aa,_0x5c4e8c)=>{const _0x30e557=_0x515c,_0x22f68d=_0x1ed1a9[_0x30e557(0x150)](_0x314260);if(_0x22f68d)return _0x3363aa(_0x22f68d);const _0x3e9fd8=new MutationObserver(()=>{const _0x43d5e3=_0x1ed1a9['querySelector'](_0x314260);_0x43d5e3&&(_0x3e9fd8['disconnect'](),_0x3363aa(_0x43d5e3));});_0x3e9fd8[_0x30e557(0x129)](_0x1ed1a9,{'childList':!![],'subtree':!![]}),setTimeout(()=>{const _0x5c2498=_0x30e557;_0x3e9fd8['disconnect'](),_0x5c4e8c(new Error(_0x5c2498(0x172)+_0x314260+_0x5c2498(_0x3e6cee._0x16cc09)));},_0x5aedf6);});}function _0x515401(_0x5be9ee,_0x19d137){const _0x24e278=_0x4de6d3;if(!_0x5be9ee)return;const _0x328a90=document['hidden'];if(!_0x328a90)try{_0x5be9ee[_0x24e278(_0xfaca5e._0x25f851)]();}catch(_0x516fac){}try{const _0x195c3d=Object['getOwnPropertyDescriptor'](window[_0x24e278(_0xfaca5e._0x5eb049)][_0x24e278(0x12a)],_0x24e278(0x16e))[_0x24e278(0x127)];_0x195c3d[_0x24e278(_0xfaca5e._0xaae4ad)](_0x5be9ee,_0x19d137);}catch(_0x435912){_0x5be9ee['value']=_0x19d137;}if(_0x5be9ee[_0x24e278(_0xfaca5e._0x4e7911)]!==_0x19d137)_0x5be9ee['value']=_0x19d137;if(_0x328a90)_0x5be9ee[_0x24e278(_0xfaca5e._0x1a39b3)](new Event('input',{'bubbles':!![]})),_0x5be9ee[_0x24e278(_0xfaca5e._0x5b601e)](new Event(_0x24e278(0x166),{'bubbles':!![]})),_0x5be9ee[_0x24e278(_0xfaca5e._0x175880)](new Event(_0x24e278(0x148),{'bubbles':!![]}));else{const _0x10adf8=[new KeyboardEvent('keydown',{'bubbles':!![],'key':'Process'}),new KeyboardEvent(_0x24e278(_0xfaca5e._0x1fc473),{'bubbles':!![],'key':_0x24e278(0x145)}),new Event(_0x24e278(0x15e),{'bubbles':!![]}),new Event('change',{'bubbles':!![]}),new KeyboardEvent(_0x24e278(_0xfaca5e._0x114265),{'bubbles':!![],'key':_0x24e278(_0xfaca5e._0x1f9811)}),new Event(_0x24e278(0x148),{'bubbles':!![]})];_0x10adf8['forEach'](_0x4ab4de=>_0x5be9ee[_0x24e278(0x13c)](_0x4ab4de));}}function _0x1a2d99(_0x32e070){const _0x3e8af7=_0x4de6d3;if(!_0x32e070)return;_0x32e070['removeAttribute'](_0x3e8af7(0x138)),_0x32e070[_0x3e8af7(_0x1a1623._0x11a5e8)][_0x3e8af7(_0x1a1623._0x3a8040)]('disabled'),_0x32e070[_0x3e8af7(_0x1a1623._0x54fdca)](_0x3e8af7(_0x1a1623._0x1588f4),_0x3e8af7(0x12f)),_0x32e070[_0x3e8af7(_0x1a1623._0x16e4bf)][_0x3e8af7(_0x1a1623._0x20956c)]=_0x3e8af7(_0x1a1623._0x157fd9),_0x32e070['click']();}function _0x218501(){const _0x3eb952=_0x4de6d3;try{const _0x38993d=new Blob([_0x3eb952(_0x331d81._0x31e82e)],{'type':'application/javascript'}),_0x46d0f6=new Worker(URL[_0x3eb952(0x14c)](_0x38993d));_0x46d0f6[_0x3eb952(_0x331d81._0x3d429a)]=()=>{};}catch(_0x479efe){console[_0x3eb952(_0x331d81._0x66143b)]('[KeepAlive]\x20Error:',_0x479efe);}}function _0x1be22e(_0x130850){const _0x32b62a=_0x4de6d3;if(!_0x130850)return![];let _0x2b3216=null;if(_0x4efc71)_0x2b3216=document['querySelector']('h6.h6tracking\x20span');else{if(_0x47ed1e)_0x2b3216=document[_0x32b62a(0x13f)](_0x32b62a(_0x3d6c07._0x494f5d));}if(_0x2b3216){const _0x59da11=_0x2b3216[_0x32b62a(0x12d)]['trim']()[_0x32b62a(0x13e)](/\s/g,''),_0x31788c=_0x130850['replace'](/\s/g,'');if(_0x59da11[_0x32b62a(_0x3d6c07._0x55b01a)]()===_0x31788c['toLowerCase']())return!![];}return![];}async function _0x270575(_0x3ffbb){const _0x2860d8=_0x4de6d3;console[_0x2860d8(0x162)]('[UPS\x20Web]\x20執行查詢:\x20'+_0x3ffbb+_0x2860d8(_0x7ad453._0x207f5a)+document['hidden']+')');const _0x5916ce=[{'name':'Track\x20Again\x20(Top)','inputId':_0x2860d8(_0x7ad453._0x1b6d6f),'btnId':_0x2860d8(_0x7ad453._0x2c5edf)},{'name':'Main\x20Track\x20(Center)','inputId':_0x2860d8(0x164),'btnId':_0x2860d8(0x131)}];try{const _0x33fd68=document[_0x2860d8(_0x7ad453._0x25bd26)]('button.close[data-dismiss=\x22modal\x22]');_0x33fd68&&(_0x33fd68[_0x2860d8(0x15f)](),await _0x443111(0x12c));let _0x577e45=document[_0x2860d8(0x13f)](_0x5916ce[0x0][_0x2860d8(0x169)])||document[_0x2860d8(0x13f)](_0x5916ce[0x1][_0x2860d8(0x169)]);if(!_0x577e45)try{const _0x2b7f61='#'+_0x5916ce[0x0][_0x2860d8(0x169)]+_0x2860d8(_0x7ad453._0x2edd0c)+_0x5916ce[0x1]['inputId'];_0x577e45=await _0x3aba84(_0x2b7f61,document[_0x2860d8(0x137)],0xbb8);}catch(_0x18deb1){return;}const _0x139662=_0x5916ce[_0x2860d8(0x149)](_0x2c834b=>_0x2c834b[_0x2860d8(0x169)]===_0x577e45['id']);if(!_0x139662)return;_0x515401(_0x577e45,_0x3ffbb),await _0x443111(0x1f4);let _0x7469c8=document['getElementById'](_0x139662[_0x2860d8(0x143)]);if(!_0x7469c8)try{_0x7469c8=await _0x3aba84('#'+_0x139662['btnId'],document[_0x2860d8(0x137)],0x7d0);}catch(_0x379de7){}if(_0x7469c8){console['log'](_0x2860d8(0x142)),_0x1a2d99(_0x7469c8),await _0x443111(0x1f4),_0x1a2d99(_0x7469c8);try{const _0x1efed8=await _0x3aba84(_0x2860d8(0x16d),document[_0x2860d8(0x137)],0x1f40);_0x1efed8&&(await _0x443111(0xc8),_0x1efed8[_0x2860d8(_0x7ad453._0x265a98)]());}catch(_0x5bef7d){}}}catch(_0x54a77f){console['error'](_0x2860d8(0x15c),_0x54a77f);}}async function _0x4e15b1(_0x2f710a){const _0x3502f8=_0x4de6d3;console['log']('[IVP]\x20執行查詢:\x20'+_0x2f710a+_0x3502f8(_0x5e5b8c._0xa339b5)+document[_0x3502f8(_0x5e5b8c._0xb5c899)]+')');const _0x48cda2=document[_0x3502f8(0x134)](_0x3502f8(_0x5e5b8c._0x3cc065));for(const _0x5900c9 of _0x48cda2){_0x5900c9['click'](),await _0x443111(0x64);}try{const _0x2903e8=document[_0x3502f8(0x150)](_0x3502f8(0x167));if(_0x2903e8){const _0x169469=document['querySelector'](_0x3502f8(_0x5e5b8c._0x2e30f2));if(_0x169469)_0x169469[_0x3502f8(0x15f)]();await _0x443111(0x12c);}const _0x212822=document[_0x3502f8(0x150)](_0x3502f8(_0x5e5b8c._0x2f5f63));_0x212822&&(_0x212822['click'](),await _0x443111(0x12c));const _0x5e4f25=await _0x3aba84(_0x3502f8(0x156));_0x515401(_0x5e4f25,_0x2f710a);const _0x39438d=await _0x3aba84(_0x3502f8(_0x5e5b8c._0x35193e));let _0x1ca8ef=0x0;while(_0x39438d[_0x3502f8(_0x5e5b8c._0x347c59)]&&_0x1ca8ef<0x5){await _0x443111(0xc8),_0x1ca8ef++;if(_0x1ca8ef%0x2===0x0)_0x515401(_0x5e4f25,_0x2f710a);}_0x1a2d99(_0x39438d);}catch(_0x27145f){console['error'](_0x3502f8(0x163),_0x27145f);}}window[_0x4de6d3(_0x132c3d._0x55cebf)]('message',async function(_0x1a08c0){const _0x562f31=_0x4de6d3;if(_0x1a08c0['origin']!==_0x38ef55)return;const _0x3d6b2c=_0x1a08c0[_0x562f31(0x170)];if(_0x3d6b2c?.[_0x562f31(_0x46abf4._0x10873c)]===_0x562f31(_0x46abf4._0x1a20fa)&&_0x3d6b2c[_0x562f31(_0x46abf4._0xd3e244)]){const {trackingNumber:_0x489e0c,timestamp:_0x50d5b7}=_0x3d6b2c[_0x562f31(_0x46abf4._0x4a2fb0)];if(_0x50d5b7>_0x35a3b1){const _0x27ec1b=_0x1be22e(_0x489e0c);if(_0x27ec1b)console[_0x562f31(_0x46abf4._0x56c3a5)](_0x562f31(_0x46abf4._0x3d5ee8)+_0x489e0c+'，跳過查詢。');else{if(_0x4efc71)await _0x4e15b1(_0x489e0c);else{if(_0x47ed1e)await _0x270575(_0x489e0c);}}_0x35a3b1=_0x50d5b7,_0x1a08c0[_0x562f31(0x160)]&&_0x1a08c0[_0x562f31(0x160)]['postMessage']({'type':'CEC_REQUEST_RECEIVED','payload':{'timestamp':_0x50d5b7}},_0x1a08c0[_0x562f31(0x128)]);}}},![]),_0x218501();}()));function _0x515c(_0x23e80a,_0x31045b){const _0x438cbc=_0x438c();return _0x515c=function(_0x515cb2,_0x164edd){_0x515cb2=_0x515cb2-0x124;let _0x14063f=_0x438cbc[_0x515cb2];if(_0x515c['xulBnb']===undefined){var _0x4d7c63=function(_0xe2f78a){const _0x4efc71='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x47ed1e='',_0x38ef55='';for(let _0x35a3b1=0x0,_0x443111,_0x3aba84,_0x515401=0x0;_0x3aba84=_0xe2f78a['charAt'](_0x515401++);~_0x3aba84&&(_0x443111=_0x35a3b1%0x4?_0x443111*0x40+_0x3aba84:_0x3aba84,_0x35a3b1++%0x4)?_0x47ed1e+=String['fromCharCode'](0xff&_0x443111>>(-0x2*_0x35a3b1&0x6)):0x0){_0x3aba84=_0x4efc71['indexOf'](_0x3aba84);}for(let _0x1a2d99=0x0,_0x218501=_0x47ed1e['length'];_0x1a2d99<_0x218501;_0x1a2d99++){_0x38ef55+='%'+('00'+_0x47ed1e['charCodeAt'](_0x1a2d99)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x38ef55);};_0x515c['iqowoC']=_0x4d7c63,_0x23e80a=arguments,_0x515c['xulBnb']=!![];}const _0x2cea91=_0x438cbc[0x0],_0x12def7=_0x515cb2+_0x2cea91,_0x55d57b=_0x23e80a[_0x12def7];return!_0x55d57b?(_0x14063f=_0x515c['iqowoC'](_0x14063f),_0x23e80a[_0x12def7]=_0x14063f):_0x14063f=_0x55d57b,_0x14063f;},_0x515c(_0x23e80a,_0x31045b);}function _0x438c(){const _0x1009cb=['C3rbChbFyNrUvhjHy2S','zM9JDxm','A2v5Dxa','CxvLCNLtzwXLy3rVCKfSBa','w1jLy2vPDMvYxsdPOihPNAlLT7lPOA/NPlROMz/NORWG','nty1mtC0neDoAMf2qq','yM9KEq','zgLZywjSzwq','icJLVlFLIlBOP6pPJPBMQkhLVi8P','q0vdx1nfqvjdsf9srvfvrvnu','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLT0ExbLpsjZDwjTAxqIxq','zgLZCgf0y2HfDMvUDa','zxjYB3i','CMvWBgfJzq','z2v0rwXLBwvUDej5swq','mtm0nJiXodbZu1b5yu8','sfrnteLUChv0rwXLBwvUDa','w1vquYbxzwjDiowyL+IPPUw8T+wiTUM7NUAtII4UlG','yNrUswq','nJC4mZKZuwzyuuLY','uhjVy2vZCW','ndC4mJqXmg5tBenWwG','A2v5ChjLC3m','yMX1CG','zMLUza','i3rVz2DSzs12AxnPyMLSAxr5id4GyNv0Dg9U','mte0nJa4odHIAMrArgW','y3jLyxrLt2jQzwn0vvjm','C2v0qxr0CMLIDxrL','w1vUAxzLCNnHBcbszwnLAxzLCIbwmJfDiowvN+wlLEAwVdOG','AxzWlMLUC2LKzs51ChmUy29T','CxvLCNLtzwXLy3rVCG','C3rbChbFDhjHy2Tbz2fPBL9NzxruCMfJAW','C3rbChbFDhjHy2Tbz2fPBL90CMfJA2LUz051BuvUDhj5','icHiAwrKzw46ia','CMvTB3zL','nLvKuxHpzq','Aw5WDxrBAwq9iKvUDgvYifrYywnRAw5Nie51BwjLCIjD','Ag9ZDg5HBwu','mNb4ihnVBgLKihjLza','ogP0z2fZtW','nJKZmti2uLzAvNfx','ngLdrejqvW','w1vquYbxzwjDiowFT+IHJowhUUMmRZO','y2XHC3nmAxn0','Aw5WDxq','y2XPy2S','C291CMnL','y2fSBa','Bg9N','w0Lwuf0G5z+36kgm5yE66yYVoG','C3rbChbFDhjHy2TPBMDoDw1Izxi','yM9YzgvY','y2HHBMDL','i21HAw5dB250ywLUzxiGpIbHChaTDhjHy2TPBMCGpIbKAxyGpIbKAxyGpIbKAxyUy29UDgfPBMvYlwzSDwLKlMqTBM9Uzq','yxjPys1KAxnHyMXLza','Aw5WDxrjza','iIdOTOxMMyi','AgLKzgvU','B25TzxnZywDL','i3n0x0fWCf9wAwv3x0rLDgfPBhm','DMfSDwu','C3r5Bgu','zgf0yq','C2v0sw50zxj2ywWOkcKGpt4GC2vSzI5WB3n0twvZC2fNzsGNDgLJAYCPlcaYntaPoW','562j5B6f5ywd57sGici','ywrKrxzLBNrmAxn0zw5LCG','zgL2lMnKAY1VDMvYBgf5lxbHBMuGBgK6AgfZkgvTlMzHlxrPBwvZkq','lcaJ','DhLWzq','mti4otmWoenJz2XcrW','Aw5JBhvKzxm','C2v0','B3jPz2LU','B2jZzxj2zq','ChjVDg90ExbL','Dg9mB3DLCKnHC2u','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLTHCMLHlwXHyMvSpsjdBgvHCIjD','Dgv4DenVBNrLBNq','Cgf5Bg9Hza','zMfSC2u','DxbZlMnVBq'];_0x438c=function(){return _0x1009cb;};return _0x438c();}