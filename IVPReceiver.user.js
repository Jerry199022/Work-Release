// ==UserScript==
// @name         通用接收器
// @namespace    Universal Receiver
// @version      V21
// @description  同時支持 IVP 內部系統與 UPS 官網的自動查詢接收器。修復後台UPS官網因自身腳本崩潰導致按鈕無法點擊的問題(V21: 強制解鎖模式)。
// @author       Jerry Law
// @match        https://ivp.inside.ups.com/internal-visibility-portal*
// @match        https://www.ups.com/track*
// @grant        none
// @run-at       document-idle
// @updateURL    https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// @downloadURL  https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// ==/UserScript==

(function(_0x1f3fd5,_0x2550f8){const _0x26fb30={_0x3e8be8:0x1f6,_0x31a528:0x1fd,_0x57ac5b:0x20d,_0x169bce:0x20b},_0x3339f6=_0x5b0f,_0x5e87ab=_0x1f3fd5();while(!![]){try{const _0x3bb16a=-parseInt(_0x3339f6(0x211))/0x1*(-parseInt(_0x3339f6(0x21f))/0x2)+parseInt(_0x3339f6(_0x26fb30._0x3e8be8))/0x3+-parseInt(_0x3339f6(_0x26fb30._0x31a528))/0x4+parseInt(_0x3339f6(0x1d4))/0x5+-parseInt(_0x3339f6(0x1ed))/0x6+-parseInt(_0x3339f6(_0x26fb30._0x57ac5b))/0x7*(-parseInt(_0x3339f6(0x218))/0x8)+parseInt(_0x3339f6(_0x26fb30._0x169bce))/0x9*(-parseInt(_0x3339f6(0x219))/0xa);if(_0x3bb16a===_0x2550f8)break;else _0x5e87ab['push'](_0x5e87ab['shift']());}catch(_0x16fed4){_0x5e87ab['push'](_0x5e87ab['shift']());}}}(_0x18ef,0xec3b0),(function(){'use strict';const _0x343a34={_0x108266:0x20e,_0x444501:0x1e9,_0x262a9a:0x200},_0x50bd0c={_0x49dc2d:0x20f,_0x2e1ca8:0x202,_0x2eafd1:0x1d5},_0x3f09bd={_0x4f5d7e:0x1f0,_0xa87d4e:0x213,_0x1c3482:0x212,_0x2c12f4:0x213,_0x5ea565:0x21c,_0x5325b9:0x1ee,_0x319163:0x1e6,_0xec4e3e:0x1f3},_0x27dfcf={_0x341198:0x1d8,_0x11421a:0x21e,_0x4ffacb:0x1d9,_0x249c00:0x21c,_0x255d3e:0x213,_0x2fbec1:0x1e7,_0x1614e4:0x1e7,_0x2f53f6:0x210,_0x4f8e4a:0x204,_0x4b38a9:0x1ea,_0x5850c2:0x1f4,_0x41f175:0x203,_0x2c05d1:0x213},_0x1537af={_0x873420:0x21b,_0x47b8da:0x21b},_0x4e9668={_0x3b4f92:0x1dc},_0x44ed06={_0x16c4ea:0x207,_0x483547:0x1fc,_0x5cc668:0x1f5,_0x52eb7b:0x1ef,_0x5c3efa:0x213},_0x1f971b={_0x313bd2:0x216,_0x3282ae:0x21d,_0x5204a4:0x21d,_0x26a722:0x20c,_0x11da5c:0x1dd,_0x4c3eda:0x1fa,_0x575d4f:0x1f7,_0x44b26b:0x1e8},_0x28edab=_0x5b0f;const _0x2d0082=window[_0x28edab(0x1f1)]['hostname'],_0x2c4f47=_0x2d0082['includes'](_0x28edab(_0x343a34._0x108266)),_0x4bcde8=_0x2d0082[_0x28edab(0x1d2)]('ups.com'),_0xf301c2=_0x28edab(_0x343a34._0x444501);console[_0x28edab(_0x343a34._0x262a9a)]('[Universal\x20Receiver\x20V21]\x20啟動於:\x20'+_0x2d0082+_0x28edab(0x1fb));let _0xc7606e=0x0;const _0x2d17fd=_0x3b5873=>new Promise(_0x4216c7=>setTimeout(_0x4216c7,_0x3b5873));function _0x2bc8f4(_0x79a3c,_0xbf0de1=document[_0x28edab(0x1f4)],_0x495bf4=0x1388){return new Promise((_0x5d2b24,_0xac8bdd)=>{const _0x1ee5e7={_0x5c5058:0x1df},_0x4536c3=_0x5b0f,_0x52ebe8=_0xbf0de1['querySelector'](_0x79a3c);if(_0x52ebe8)return _0x5d2b24(_0x52ebe8);const _0xd767d9=new MutationObserver(()=>{const _0x54702c=_0xbf0de1['querySelector'](_0x79a3c);_0x54702c&&(_0xd767d9['disconnect'](),_0x5d2b24(_0x54702c));});_0xd767d9[_0x4536c3(0x1e4)](_0xbf0de1,{'childList':!![],'subtree':!![]}),setTimeout(()=>{const _0xba77d0=_0x4536c3;_0xd767d9[_0xba77d0(_0x1ee5e7._0x5c5058)](),_0xac8bdd(new Error(_0xba77d0(0x1f2)+_0x79a3c+'\x22\x20超時'));},_0x495bf4);});}function _0x31cc24(_0x3c4f45,_0x561e78){const _0x3174f3=_0x28edab;if(!_0x3c4f45)return;const _0x136e36=document['hidden'];if(!_0x136e36)try{_0x3c4f45[_0x3174f3(0x1f8)]();}catch(_0x2f91a2){}try{const _0x4f2e4a=Object[_0x3174f3(0x214)](window[_0x3174f3(0x208)][_0x3174f3(_0x1f971b._0x313bd2)],'value')[_0x3174f3(0x1e2)];_0x4f2e4a['call'](_0x3c4f45,_0x561e78);}catch(_0x3be627){_0x3c4f45[_0x3174f3(_0x1f971b._0x3282ae)]=_0x561e78;}if(_0x3c4f45['value']!==_0x561e78)_0x3c4f45[_0x3174f3(_0x1f971b._0x5204a4)]=_0x561e78;if(_0x136e36)_0x3c4f45['dispatchEvent'](new Event(_0x3174f3(_0x1f971b._0x26a722),{'bubbles':!![]})),_0x3c4f45['dispatchEvent'](new Event(_0x3174f3(0x1fa),{'bubbles':!![]})),_0x3c4f45[_0x3174f3(_0x1f971b._0x11da5c)](new Event('blur',{'bubbles':!![]}));else{const _0x4e3e91=[new KeyboardEvent('keydown',{'bubbles':!![],'key':_0x3174f3(0x1eb)}),new KeyboardEvent(_0x3174f3(0x215),{'bubbles':!![],'key':'Process'}),new Event(_0x3174f3(0x20c),{'bubbles':!![]}),new Event(_0x3174f3(_0x1f971b._0x4c3eda),{'bubbles':!![]}),new KeyboardEvent(_0x3174f3(_0x1f971b._0x575d4f),{'bubbles':!![],'key':'Process'}),new Event(_0x3174f3(0x1d3),{'bubbles':!![]})];_0x4e3e91[_0x3174f3(_0x1f971b._0x44b26b)](_0x3cefea=>_0x3c4f45[_0x3174f3(0x1dd)](_0x3cefea));}}function _0x2aacfc(_0x193fb5){const _0x17ca7c=_0x28edab;if(!_0x193fb5)return;_0x193fb5['removeAttribute'](_0x17ca7c(_0x44ed06._0x16c4ea)),_0x193fb5[_0x17ca7c(_0x44ed06._0x483547)][_0x17ca7c(_0x44ed06._0x5cc668)]('disabled'),_0x193fb5[_0x17ca7c(0x1e0)](_0x17ca7c(0x1e5),'false'),_0x193fb5[_0x17ca7c(0x1d1)][_0x17ca7c(0x1e3)]=_0x17ca7c(_0x44ed06._0x52eb7b),_0x193fb5[_0x17ca7c(_0x44ed06._0x5c3efa)]();}function _0x37a2ff(){const _0x47b6ab=_0x28edab;try{const _0x2543b7=new Blob([_0x47b6ab(_0x4e9668._0x3b4f92)],{'type':_0x47b6ab(0x1fe)}),_0x9e1b61=new Worker(URL['createObjectURL'](_0x2543b7));_0x9e1b61['onmessage']=()=>{};}catch(_0x427dbb){console[_0x47b6ab(0x217)]('[KeepAlive]\x20Error:',_0x427dbb);}}function _0x37d3ea(_0x23987a){const _0x55efae=_0x28edab;if(!_0x23987a)return![];let _0x4584ec=null;if(_0x2c4f47)_0x4584ec=document[_0x55efae(0x21c)]('h6.h6tracking\x20span');else{if(_0x4bcde8)_0x4584ec=document['getElementById'](_0x55efae(0x1ec));}if(_0x4584ec){const _0x562732=_0x4584ec['textContent'][_0x55efae(0x201)]()[_0x55efae(_0x1537af._0x873420)](/\s/g,''),_0x14b9e7=_0x23987a[_0x55efae(_0x1537af._0x47b8da)](/\s/g,'');if(_0x562732[_0x55efae(0x21a)]()===_0x14b9e7[_0x55efae(0x21a)]())return!![];}return![];}async function _0x421f90(_0x3ed028){const _0x55e7c4=_0x28edab;console[_0x55e7c4(0x200)]('[UPS\x20Web]\x20執行查詢:\x20'+_0x3ed028+_0x55e7c4(0x1d6)+document[_0x55e7c4(0x1d7)]+')');const _0x1e095f=[{'name':_0x55e7c4(_0x27dfcf._0x341198),'inputId':'stApp_trackAgain_trackingNumEntry','btnId':_0x55e7c4(0x1da)},{'name':_0x55e7c4(_0x27dfcf._0x11421a),'inputId':_0x55e7c4(0x1ec),'btnId':_0x55e7c4(_0x27dfcf._0x4ffacb)}];try{const _0x986fbd=document[_0x55e7c4(_0x27dfcf._0x249c00)](_0x55e7c4(0x1ff));_0x986fbd&&(_0x986fbd[_0x55e7c4(_0x27dfcf._0x255d3e)](),await _0x2d17fd(0x12c));let _0x1d7ff9=document[_0x55e7c4(0x204)](_0x1e095f[0x0][_0x55e7c4(0x1e7)])||document['getElementById'](_0x1e095f[0x1][_0x55e7c4(_0x27dfcf._0x2fbec1)]);if(!_0x1d7ff9)try{const _0x3910f7='#'+_0x1e095f[0x0][_0x55e7c4(_0x27dfcf._0x1614e4)]+_0x55e7c4(0x20a)+_0x1e095f[0x1][_0x55e7c4(0x1e7)];_0x1d7ff9=await _0x2bc8f4(_0x3910f7,document['body'],0xbb8);}catch(_0xb6abe7){return;}const _0x13085d=_0x1e095f[_0x55e7c4(_0x27dfcf._0x2f53f6)](_0xee9987=>_0xee9987[_0x55e7c4(0x1e7)]===_0x1d7ff9['id']);if(!_0x13085d)return;_0x31cc24(_0x1d7ff9,_0x3ed028),await _0x2d17fd(0x1f4);let _0x54d249=document[_0x55e7c4(_0x27dfcf._0x4f8e4a)](_0x13085d[_0x55e7c4(_0x27dfcf._0x4b38a9)]);if(!_0x54d249)try{_0x54d249=await _0x2bc8f4('#'+_0x13085d[_0x55e7c4(0x1ea)],document[_0x55e7c4(_0x27dfcf._0x5850c2)],0x7d0);}catch(_0x953be0){}if(_0x54d249){console['log']('[UPS\x20Web]\x20嘗試強制點擊...'),_0x2aacfc(_0x54d249),await _0x2d17fd(0x1f4),_0x2aacfc(_0x54d249);try{const _0x102de2=await _0x2bc8f4(_0x55e7c4(_0x27dfcf._0x41f175),document[_0x55e7c4(0x1f4)],0x1f40);_0x102de2&&(await _0x2d17fd(0xc8),_0x102de2[_0x55e7c4(_0x27dfcf._0x2c05d1)]());}catch(_0x245f1d){}}}catch(_0x52398c){console['error'](_0x55e7c4(0x1de),_0x52398c);}}async function _0x13680e(_0x4ddc49){const _0x457b46=_0x28edab;console[_0x457b46(0x200)]('[IVP]\x20執行查詢:\x20'+_0x4ddc49+_0x457b46(0x1d6)+document['hidden']+')');const _0x56d17d=document['querySelectorAll'](_0x457b46(_0x3f09bd._0x4f5d7e));for(const _0x17bf97 of _0x56d17d){_0x17bf97[_0x457b46(_0x3f09bd._0xa87d4e)](),await _0x2d17fd(0x64);}try{const _0x36ccb9=document['querySelector'](_0x457b46(_0x3f09bd._0x1c3482));if(_0x36ccb9){const _0x3b7ee9=document[_0x457b46(0x21c)](_0x457b46(0x1f9));if(_0x3b7ee9)_0x3b7ee9[_0x457b46(_0x3f09bd._0x2c12f4)]();await _0x2d17fd(0x12c);}const _0x4b680b=document[_0x457b46(_0x3f09bd._0x5ea565)](_0x457b46(_0x3f09bd._0x5325b9));_0x4b680b&&(_0x4b680b['click'](),await _0x2d17fd(0x12c));const _0x5e4379=await _0x2bc8f4('input[id=\x22Enter\x20Tracking\x20Number\x22]');_0x31cc24(_0x5e4379,_0x4ddc49);const _0x550f05=await _0x2bc8f4(_0x457b46(_0x3f09bd._0x319163));let _0x175f29=0x0;while(_0x550f05[_0x457b46(0x207)]&&_0x175f29<0x5){await _0x2d17fd(0xc8),_0x175f29++;if(_0x175f29%0x2===0x0)_0x31cc24(_0x5e4379,_0x4ddc49);}_0x2aacfc(_0x550f05);}catch(_0x4989fc){console[_0x457b46(0x217)](_0x457b46(_0x3f09bd._0xec4e3e),_0x4989fc);}}window['addEventListener']('message',async function(_0x354eaa){const _0x4168a8=_0x28edab;if(_0x354eaa['origin']!==_0xf301c2)return;const _0x374504=_0x354eaa[_0x4168a8(_0x50bd0c._0x49dc2d)];if(_0x374504?.[_0x4168a8(0x209)]===_0x4168a8(0x205)&&_0x374504['payload']){const {trackingNumber:_0x1977e0,timestamp:_0x67dd6f}=_0x374504['payload'];if(_0x67dd6f>_0xc7606e){const _0x50af6c=_0x37d3ea(_0x1977e0);if(_0x50af6c)console[_0x4168a8(0x200)](_0x4168a8(_0x50bd0c._0x2e1ca8)+_0x1977e0+_0x4168a8(0x1e1));else{if(_0x2c4f47)await _0x13680e(_0x1977e0);else{if(_0x4bcde8)await _0x421f90(_0x1977e0);}}_0xc7606e=_0x67dd6f,_0x354eaa[_0x4168a8(_0x50bd0c._0x2eafd1)]&&_0x354eaa[_0x4168a8(0x1d5)]['postMessage']({'type':_0x4168a8(0x1db),'payload':{'timestamp':_0x67dd6f}},_0x354eaa[_0x4168a8(0x206)]);}}},![]),_0x37a2ff();}()));function _0x5b0f(_0x4b10b8,_0x12d8bf){const _0x18ef3=_0x18ef();return _0x5b0f=function(_0x5b0f7c,_0x1b1456){_0x5b0f7c=_0x5b0f7c-0x1d1;let _0x125374=_0x18ef3[_0x5b0f7c];if(_0x5b0f['xAJkiI']===undefined){var _0x4b79a8=function(_0x2d0082){const _0x2c4f47='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4bcde8='',_0xf301c2='';for(let _0xc7606e=0x0,_0x2d17fd,_0x2bc8f4,_0x31cc24=0x0;_0x2bc8f4=_0x2d0082['charAt'](_0x31cc24++);~_0x2bc8f4&&(_0x2d17fd=_0xc7606e%0x4?_0x2d17fd*0x40+_0x2bc8f4:_0x2bc8f4,_0xc7606e++%0x4)?_0x4bcde8+=String['fromCharCode'](0xff&_0x2d17fd>>(-0x2*_0xc7606e&0x6)):0x0){_0x2bc8f4=_0x2c4f47['indexOf'](_0x2bc8f4);}for(let _0x2aacfc=0x0,_0x37a2ff=_0x4bcde8['length'];_0x2aacfc<_0x37a2ff;_0x2aacfc++){_0xf301c2+='%'+('00'+_0x4bcde8['charCodeAt'](_0x2aacfc)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xf301c2);};_0x5b0f['PGGROO']=_0x4b79a8,_0x4b10b8=arguments,_0x5b0f['xAJkiI']=!![];}const _0x5e8839=_0x18ef3[0x0],_0x408911=_0x5b0f7c+_0x5e8839,_0x238430=_0x4b10b8[_0x408911];return!_0x238430?(_0x125374=_0x5b0f['PGGROO'](_0x125374),_0x4b10b8[_0x408911]=_0x125374):_0x125374=_0x238430,_0x125374;},_0x5b0f(_0x4b10b8,_0x12d8bf);}function _0x18ef(){const _0x58369d=['w1jLy2vPDMvYxsdPOihPNAlLT7lPOA/NPlROMz/NORWG','i3n0x0fWCf9wAwv3x0rLDgfPBhm','z2v0rwXLBwvUDej5swq','q0vdx1nfqvjdsf9srvfvrvnu','B3jPz2LU','zgLZywjSzwq','sfrnteLUChv0rwXLBwvUDa','DhLWzq','lcaJ','mJC1nZzjwNDdBNy','Aw5WDxq','nZa0ou9mtxreAq','AxzWlMLUC2LKzs51ChmUy29T','zgf0yq','zMLUza','murWAvHOta','i21HAw5dB250ywLUzxiGpIbHChaTDhjHy2TPBMCGpIbKAxyGpIbKAxyGpIbKAxyUy29UDgfPBMvYlwzSDwLKlMqTBM9Uzq','y2XPy2S','z2v0t3DUuhjVCgvYDhLezxnJCMLWDg9Y','A2v5ChjLC3m','ChjVDg90ExbL','zxjYB3i','mtm4nJr2AKPuvKe','nZe5mhrLD1P5rq','Dg9mB3DLCKnHC2u','CMvWBgfJzq','CxvLCNLtzwXLy3rVCG','DMfSDwu','twfPBIbuCMfJAYaOq2vUDgvYkq','mJy0mdm4mNrwshPTuq','C3r5Bgu','Aw5JBhvKzxm','yMX1CG','nJy4mZi0meDPqxrvBW','C291CMnL','icHiAwrKzw46ia','AgLKzgvU','vhjHy2SGqwDHAw4GkfrVCcK','C3rbChbFyNrUvhjHy2S','C3rbChbFDhjHy2Tbz2fPBL9NzxruCMfJAW','q0vdx1jfuvvfu1rFuKvdruLwruq','C2v0sw50zxj2ywWOkcKGpt4GC2vSzI5WB3n0twvZC2fNzsGNDgLJAYCPlcaYntaPoW','zgLZCgf0y2HfDMvUDa','w1vquYbxzwjDiowFT+IHJowhUUMmRZO','zgLZy29UBMvJDa','C2v0qxr0CMLIDxrL','77Ym6lEZ6ygo5P+L6kMI44cc','C2v0','yM9YzgvY','B2jZzxj2zq','yxjPys1KAxnHyMXLza','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLT0ExbLpsjZDwjTAxqIxq','Aw5WDxrjza','zM9YrwfJAa','Ahr0Chm6lY91ChnKCML2zs5SAwDODg5PBMCUzM9Yy2uUy29T','yNrUswq','uhjVy2vZCW','C3rbChbFDhjHy2TPBMDoDw1Izxi','nJy1ntmWmMvoAfLxza','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLTHCMLHlwXHyMvSpsjdBgvHCIjD','mNb4ihnVBgLKihjLza','zgL2lMnKAY1VDMvYBgf5lxbHBMuGBgK6AgfZkgvTlMzHlxrPBwvZkq','Bg9JyxrPB24','562j5B6f5ywd57sGici','w0Lwuf0G5z+36kgm5yE66yYVoG','yM9KEq','CMvTB3zL','ndm5ndi2mK1zu3nQsG','A2v5Dxa','zM9JDxm','i3rVz2DSzs12AxnPyMLSAxr5id4GyNv0Dg9U','y2HHBMDL','icJLVlFLIlBOP6pPJPBMQkhLVi8P','y2XHC3nmAxn0','nJm0nZu2ngj0qw1VBG','yxbWBgLJyxrPB24VAMf2yxnJCMLWDa','yNv0Dg9UlMnSB3nLw2rHDgeTzgLZBwLZCZ0IBw9KywWIxq','Bg9N','DhjPBq'];_0x18ef=function(){return _0x58369d;};return _0x18ef();}