// ==UserScript==
// @name         通用接收器
// @namespace    Universal Receiver
// @version      V21
// @description  同時支持 IVP 內部系統與 UPS 官網的自動查詢接收器。修復後台UPS官網因自身腳本崩潰導致按鈕無法點擊的問題(V21: 強制解鎖模式)。
// @author       Jerry Law
// @match        https://ivp.inside.ups.com/internal-visibility-portal*
// @match        https://www.ups.com/track*
// @grant        none
// @run-at       document-idle
// @updateURL    https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// @downloadURL  https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// ==/UserScript==

function _0x3205(_0x5342c8,_0x29499b){const _0x3dc5f9=_0x3dc5();return _0x3205=function(_0x3205c9,_0x5a5f83){_0x3205c9=_0x3205c9-0xd4;let _0x5570b4=_0x3dc5f9[_0x3205c9];if(_0x3205['MvYQao']===undefined){var _0x592e0d=function(_0x1eb912){const _0xdc1615='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x59a2ff='',_0xd51178='';for(let _0x4d728a=0x0,_0x232bd9,_0x28a143,_0x49f5a4=0x0;_0x28a143=_0x1eb912['charAt'](_0x49f5a4++);~_0x28a143&&(_0x232bd9=_0x4d728a%0x4?_0x232bd9*0x40+_0x28a143:_0x28a143,_0x4d728a++%0x4)?_0x59a2ff+=String['fromCharCode'](0xff&_0x232bd9>>(-0x2*_0x4d728a&0x6)):0x0){_0x28a143=_0xdc1615['indexOf'](_0x28a143);}for(let _0x4ba951=0x0,_0x4b5ce3=_0x59a2ff['length'];_0x4ba951<_0x4b5ce3;_0x4ba951++){_0xd51178+='%'+('00'+_0x59a2ff['charCodeAt'](_0x4ba951)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xd51178);};_0x3205['HdemjY']=_0x592e0d,_0x5342c8=arguments,_0x3205['MvYQao']=!![];}const _0x55db26=_0x3dc5f9[0x0],_0xf86b8d=_0x3205c9+_0x55db26,_0x541726=_0x5342c8[_0xf86b8d];return!_0x541726?(_0x5570b4=_0x3205['HdemjY'](_0x5570b4),_0x5342c8[_0xf86b8d]=_0x5570b4):_0x5570b4=_0x541726,_0x5570b4;},_0x3205(_0x5342c8,_0x29499b);}function _0x3dc5(){const _0x5498e9=['Bg9N','q0vdx1jfuvvfu1rFuKvdruLwruq','mtqYmtCYmtbyserVDfC','yM9KEq','lcaJ','Aw5JBhvKzxm','w1vquYbxzwjDiowFT+IHJoAFPEIPOJOG','icJLVlFLIlBOP6pPJPBMQkhLVi8P','mtzvsxb2Evm','mJaYota3ndb0rgrStKW','y2fSBa','icHiAwrKzw46ia','uhjVy2vZCW','BwvZC2fNzq','w0Lwuf0G5z+36kgm5P+L6kMIoIa','q0vdx1nfqvjdsf9srvfvrvnu','zgLZywjSzwq','C3rbChbFDhjHy2TPBMDoDw1Izxi','Bg9JyxrPB24','yNv0Dg9UlMnSB3nLw2rHDgeTzgLZBwLZCZ0IBw9KywWIxq','A2v5Dxa','ChjVDg90ExbL','Cgf5Bg9Hza','AxzWlMLUC2LKzs51ChmUy29T','zM9YrwfJAa','AgLKzgvU','C291CMnL','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLTHCMLHlwXHyMvSpsjdBgvHCIjD','zM9JDxm','w1vquYbxzwjDiowyL+IPPUw8T+wiTUM7NUAtII4UlG','C3rbChbFDhjHy2Tbz2fPBL9NzxruCMfJAW','y2HHBMDL','CMvWBgfJzq','DhjPBq','y2XHC3nmAxn0','w1jLy2vPDMvYxsdPOihPNAlLT7lPOA/NPlROMz/NORWG','mZCXnJiXnu5KD2foCq','y2XPy2S','77Ym6lEZ6ygo5P+L6kMI44cc','DMfSDwu','DhLWzq','CxvLCNLtzwXLy3rVCG','Dg9mB3DLCKnHC2u','Aw5WDxq','ndy5mtG3mKLtCujmvG','mZuYmJq5munNrerssq','B3jPz2LU','Aw5WDxrjza','zxjYB3i','Cg9ZDe1LC3nHz2u','yM9YzgvY','ywrKrxzLBNrmAxn0zw5LCG','yxbWBgLJyxrPB24VAMf2yxnJCMLWDa','zgLZy29UBMvJDa','i3n0x0fWCf9wAwv3x0rLDgfPBhm','w0TLzxbbBgL2zv0GrxjYB3i6','Dgv4DenVBNrLBNq','z2v0rwXLBwvUDej5swq','CxvLCNLtzwXLy3rVCKfSBa','nKPuse15vq','562j5B6f5ywd57sGici','nJm5nZm0quzOwgPI','mtH4A2vizu0','CMvTB3zLqxr0CMLIDxrL','yMX1CG','C2v0','CMvTB3zL','B2jZzxj2zq','A2v5zg93BG','zgLZCgf0y2HfDMvUDa','mtu1ody4mwXsBgHXvW','C3rbChbFDhjHy2Tbz2fPBL90CMfJA2LUz051BuvUDhj5'];_0x3dc5=function(){return _0x5498e9;};return _0x3dc5();}(function(_0xff3dca,_0x3ff704){const _0x243352={_0x2d61db:0x11a,_0x4e2679:0x109,_0x434cc3:0xe5,_0x465d9a:0xdf},_0x2e9c2d=_0x3205,_0xa48ef2=_0xff3dca();while(!![]){try{const _0x49c246=parseInt(_0x2e9c2d(0xdb))/0x1+-parseInt(_0x2e9c2d(_0x243352._0x2d61db))/0x2*(parseInt(_0x2e9c2d(0x11b))/0x3)+parseInt(_0x2e9c2d(_0x243352._0x4e2679))/0x4+parseInt(_0x2e9c2d(0x101))/0x5*(parseInt(_0x2e9c2d(0x118))/0x6)+-parseInt(_0x2e9c2d(0x10a))/0x7*(parseInt(_0x2e9c2d(_0x243352._0x434cc3))/0x8)+-parseInt(_0x2e9c2d(_0x243352._0x465d9a))/0x9+parseInt(_0x2e9c2d(0xe6))/0xa;if(_0x49c246===_0x3ff704)break;else _0xa48ef2['push'](_0xa48ef2['shift']());}catch(_0x4a667f){_0xa48ef2['push'](_0xa48ef2['shift']());}}}(_0x3dc5,0xf3cf8),(function(){'use strict';const _0x268620={_0x2bd2a9:0xea},_0x3e2bbf={_0x321bc4:0x10b,_0x199bf0:0x105,_0x2afd57:0xf3,_0x3a19c5:0x103,_0x195f2d:0xf7,_0x1a2ee1:0xf7,_0x188caf:0x10e,_0x5f3e70:0xde},_0x1606bb={_0x2417a7:0xeb,_0x363785:0x106,_0x1111de:0x102},_0x5216da={_0x44511a:0xf6,_0x49e0a2:0xdc,_0x2945b3:0x106,_0x3006d7:0xf0,_0x400aab:0xe0,_0x281cfa:0x116,_0x5656d0:0xfa},_0x137c00={_0xa44e6d:0xee,_0x3d6b77:0x115,_0x57d1bc:0xfd,_0x13985c:0xfd},_0x41c949={_0x153a6d:0x111,_0x189d59:0x114},_0x2e066b={_0x2e6276:0xed,_0x49f530:0xff,_0x3755fd:0xd7,_0x31c546:0x10f},_0x539d97={_0x8f2297:0xf6,_0x9d6129:0xf9,_0x2f74eb:0xf2,_0xd2c78a:0xd6,_0x82237a:0xe7,_0x5f2a9a:0x104,_0x4c0785:0xda,_0x54945b:0xd9,_0x1d9b7d:0xfc,_0x553190:0xe9,_0xa2b14a:0xd5,_0x2f41b2:0xf5},_0x1f761d={_0x1ba579:0xd8},_0x31958f=_0x3205;const _0x1eb912=window[_0x31958f(0xef)]['hostname'],_0xdc1615=_0x1eb912[_0x31958f(0xe2)](_0x31958f(0xf4)),_0x59a2ff=_0x1eb912[_0x31958f(0xe2)]('ups.com'),_0xd51178='https://upsdrive.lightning.force.com';console['log']('[Universal\x20Receiver\x20V21]\x20啟動於:\x20'+_0x1eb912+_0x31958f(0xe4));let _0x4d728a=0x0;const _0x232bd9=_0xc9f8a2=>new Promise(_0x1aff5e=>setTimeout(_0x1aff5e,_0xc9f8a2));function _0x28a143(_0xd7edff,_0x17f275=document['body'],_0x5cd765=0x1388){const _0x24d835={_0x23c000:0x119},_0xe5f14f={_0x183e40:0x112};return new Promise((_0x114152,_0x453961)=>{const _0x418594=_0x3205,_0x225a61=_0x17f275[_0x418594(0x106)](_0xd7edff);if(_0x225a61)return _0x114152(_0x225a61);const _0x2ccaaf=new MutationObserver(()=>{const _0xf3db05=_0x418594,_0x114638=_0x17f275[_0xf3db05(0x106)](_0xd7edff);_0x114638&&(_0x2ccaaf[_0xf3db05(_0xe5f14f._0x183e40)](),_0x114152(_0x114638));});_0x2ccaaf[_0x418594(_0x1f761d._0x1ba579)](_0x17f275,{'childList':!![],'subtree':!![]}),setTimeout(()=>{const _0x559882=_0x418594;_0x2ccaaf['disconnect'](),_0x453961(new Error(_0x559882(_0x24d835._0x23c000)+_0xd7edff+'\x22\x20超時'));},_0x5cd765);});}function _0x49f5a4(_0x31cb19,_0x323dc7){const _0x585813=_0x31958f;if(!_0x31cb19)return;const _0x28a123=document[_0x585813(_0x539d97._0x8f2297)];if(!_0x28a123)try{_0x31cb19[_0x585813(_0x539d97._0x9d6129)]();}catch(_0x55a8e6){}try{const _0x59254e=Object['getOwnPropertyDescriptor'](window['HTMLInputElement'][_0x585813(_0x539d97._0x2f74eb)],'value')[_0x585813(_0x539d97._0xd2c78a)];_0x59254e[_0x585813(_0x539d97._0x82237a)](_0x31cb19,_0x323dc7);}catch(_0x1ced3d){_0x31cb19[_0x585813(_0x539d97._0x5f2a9a)]=_0x323dc7;}if(_0x31cb19['value']!==_0x323dc7)_0x31cb19[_0x585813(_0x539d97._0x5f2a9a)]=_0x323dc7;if(_0x28a123)_0x31cb19['dispatchEvent'](new Event(_0x585813(0x108),{'bubbles':!![]})),_0x31cb19['dispatchEvent'](new Event('change',{'bubbles':!![]})),_0x31cb19[_0x585813(_0x539d97._0x4c0785)](new Event(_0x585813(0xd5),{'bubbles':!![]}));else{const _0x1b9713=[new KeyboardEvent(_0x585813(_0x539d97._0x54945b),{'bubbles':!![],'key':'Process'}),new KeyboardEvent('keypress',{'bubbles':!![],'key':_0x585813(0xe9)}),new Event(_0x585813(0x108),{'bubbles':!![]}),new Event(_0x585813(_0x539d97._0x1d9b7d),{'bubbles':!![]}),new KeyboardEvent(_0x585813(0xf1),{'bubbles':!![],'key':_0x585813(_0x539d97._0x553190)}),new Event(_0x585813(_0x539d97._0xa2b14a),{'bubbles':!![]})];_0x1b9713[_0x585813(_0x539d97._0x2f41b2)](_0x3a466c=>_0x31cb19[_0x585813(0xda)](_0x3a466c));}}function _0x4ba951(_0x44b5d3){const _0xb242cc=_0x31958f;if(!_0x44b5d3)return;_0x44b5d3[_0xb242cc(0xd4)](_0xb242cc(_0x2e066b._0x2e6276)),_0x44b5d3[_0xb242cc(_0x2e066b._0x49f530)][_0xb242cc(_0x2e066b._0x3755fd)](_0xb242cc(0xed)),_0x44b5d3['setAttribute']('aria-disabled','false'),_0x44b5d3['style'][_0xb242cc(_0x2e066b._0x31c546)]='2px\x20solid\x20red',_0x44b5d3['click']();}function _0x4b5ce3(){const _0x930ec8=_0x31958f;try{const _0x1c27e1=new Blob(['setInterval(()\x20=>\x20self.postMessage(\x27tick\x27),\x20250);'],{'type':_0x930ec8(_0x41c949._0x153a6d)}),_0x4c190f=new Worker(URL['createObjectURL'](_0x1c27e1));_0x4c190f['onmessage']=()=>{};}catch(_0x200e15){console[_0x930ec8(0x10d)](_0x930ec8(_0x41c949._0x189d59),_0x200e15);}}function _0x12f344(_0x3fbb4e){const _0x2885f8=_0x31958f;if(!_0x3fbb4e)return![];let _0x198ec2=null;if(_0xdc1615)_0x198ec2=document[_0x2885f8(0x106)]('h6.h6tracking\x20span');else{if(_0x59a2ff)_0x198ec2=document['getElementById'](_0x2885f8(_0x137c00._0xa44e6d));}if(_0x198ec2){const _0x34f3eb=_0x198ec2[_0x2885f8(_0x137c00._0x3d6b77)][_0x2885f8(0xfe)]()[_0x2885f8(_0x137c00._0x57d1bc)](/\s/g,''),_0x1e27d6=_0x3fbb4e[_0x2885f8(_0x137c00._0x13985c)](/\s/g,'');if(_0x34f3eb[_0x2885f8(0x107)]()===_0x1e27d6['toLowerCase']())return!![];}return![];}async function _0x5c97a3(_0x5aa44a){const _0x55f5a0=_0x31958f;console['log'](_0x55f5a0(0xe3)+_0x5aa44a+'\x20(Hidden:\x20'+document[_0x55f5a0(_0x5216da._0x44511a)]+')');const _0x35328e=[{'name':'Track\x20Again\x20(Top)','inputId':_0x55f5a0(_0x5216da._0x49e0a2),'btnId':_0x55f5a0(0xfb)},{'name':'Main\x20Track\x20(Center)','inputId':'stApp_trackingNumber','btnId':'stApp_btnTrack'}];try{const _0x6ad484=document[_0x55f5a0(_0x5216da._0x2945b3)](_0x55f5a0(_0x5216da._0x3006d7));_0x6ad484&&(_0x6ad484[_0x55f5a0(0x102)](),await _0x232bd9(0x12c));let _0x42c23e=document[_0x55f5a0(0x116)](_0x35328e[0x0]['inputId'])||document['getElementById'](_0x35328e[0x1][_0x55f5a0(0x10c)]);if(!_0x42c23e)try{const _0x42336a='#'+_0x35328e[0x0]['inputId']+_0x55f5a0(0xe1)+_0x35328e[0x1][_0x55f5a0(0x10c)];_0x42c23e=await _0x28a143(_0x42336a,document[_0x55f5a0(_0x5216da._0x400aab)],0xbb8);}catch(_0x5c0454){return;}const _0x15b13a=_0x35328e['find'](_0x3b37b6=>_0x3b37b6[_0x55f5a0(0x10c)]===_0x42c23e['id']);if(!_0x15b13a)return;_0x49f5a4(_0x42c23e,_0x5aa44a),await _0x232bd9(0x1f4);let _0xc1305=document[_0x55f5a0(_0x5216da._0x281cfa)](_0x15b13a['btnId']);if(!_0xc1305)try{_0xc1305=await _0x28a143('#'+_0x15b13a['btnId'],document[_0x55f5a0(0xe0)],0x7d0);}catch(_0x2d5801){}if(_0xc1305){console[_0x55f5a0(0xdd)](_0x55f5a0(_0x5216da._0x5656d0)),_0x4ba951(_0xc1305),await _0x232bd9(0x1f4),_0x4ba951(_0xc1305);try{const _0x3c073d=await _0x28a143(_0x55f5a0(0x113),document[_0x55f5a0(0xe0)],0x1f40);_0x3c073d&&(await _0x232bd9(0xc8),_0x3c073d['click']());}catch(_0x5441d0){}}}catch(_0x1f1b25){console[_0x55f5a0(0x10d)]('[UPS\x20Web]\x20執行出錯:',_0x1f1b25);}}async function _0x1343e8(_0x8bdacd){const _0x2425cc=_0x31958f;console[_0x2425cc(0xdd)](_0x2425cc(_0x1606bb._0x2417a7)+_0x8bdacd+_0x2425cc(0xe8)+document[_0x2425cc(0xf6)]+')');const _0x2b3f1b=document[_0x2425cc(0x117)]('div.cdk-overlay-pane\x20li:has(em.fa-times)');for(const _0x372b14 of _0x2b3f1b){_0x372b14[_0x2425cc(0x102)](),await _0x232bd9(0x64);}try{const _0x2ddf19=document['querySelector']('#mainContainer\x20>\x20app-tracking\x20>\x20div\x20>\x20div\x20>\x20div.container-fluid.d-none');if(_0x2ddf19){const _0x1c88d4=document['querySelector']('#toggle-visibility\x20>\x20button');if(_0x1c88d4)_0x1c88d4['click']();await _0x232bd9(0x12c);}const _0x19cd3b=document[_0x2425cc(_0x1606bb._0x363785)](_0x2425cc(0xf8));_0x19cd3b&&(_0x19cd3b[_0x2425cc(_0x1606bb._0x1111de)](),await _0x232bd9(0x12c));const _0x2d5c97=await _0x28a143('input[id=\x22Enter\x20Tracking\x20Number\x22]');_0x49f5a4(_0x2d5c97,_0x8bdacd);const _0x3c0885=await _0x28a143('div.action-buttons\x20button[type=\x22submit\x22]');let _0x284fe0=0x0;while(_0x3c0885[_0x2425cc(0xed)]&&_0x284fe0<0x5){await _0x232bd9(0xc8),_0x284fe0++;if(_0x284fe0%0x2===0x0)_0x49f5a4(_0x2d5c97,_0x8bdacd);}_0x4ba951(_0x3c0885);}catch(_0x389ca7){console[_0x2425cc(0x10d)]('[IVP]\x20執行出錯:',_0x389ca7);}}window[_0x31958f(0x110)](_0x31958f(_0x268620._0x2bd2a9),async function(_0x25d86a){const _0x1f0baf=_0x31958f;if(_0x25d86a[_0x1f0baf(_0x3e2bbf._0x321bc4)]!==_0xd51178)return;const _0x118ec8=_0x25d86a['data'];if(_0x118ec8?.[_0x1f0baf(_0x3e2bbf._0x199bf0)]===_0x1f0baf(0xec)&&_0x118ec8[_0x1f0baf(0xf3)]){const {trackingNumber:_0x383613,timestamp:_0x27292f}=_0x118ec8[_0x1f0baf(_0x3e2bbf._0x2afd57)];if(_0x27292f>_0x4d728a){const _0x3aa16c=_0x12f344(_0x383613);if(_0x3aa16c)console[_0x1f0baf(0xdd)](_0x1f0baf(0x100)+_0x383613+_0x1f0baf(_0x3e2bbf._0x3a19c5));else{if(_0xdc1615)await _0x1343e8(_0x383613);else{if(_0x59a2ff)await _0x5c97a3(_0x383613);}}_0x4d728a=_0x27292f,_0x25d86a[_0x1f0baf(_0x3e2bbf._0x195f2d)]&&_0x25d86a[_0x1f0baf(_0x3e2bbf._0x1a2ee1)][_0x1f0baf(_0x3e2bbf._0x188caf)]({'type':_0x1f0baf(_0x3e2bbf._0x5f3e70),'payload':{'timestamp':_0x27292f}},_0x25d86a['origin']);}}},![]),_0x4b5ce3();}()));