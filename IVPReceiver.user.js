// ==UserScript==
// @name         通用接收器
// @namespace    Universal Receiver
// @version      V21
// @description  同時支持 IVP 內部系統與 UPS 官網的自動查詢接收器。修復後台UPS官網因自身腳本崩潰導致按鈕無法點擊的問題(V21: 強制解鎖模式)。
// @author       Jerry Law
// @match        https://ivp.inside.ups.com/internal-visibility-portal*
// @match        https://www.ups.com/track*
// @grant        none
// @run-at       document-idle
// @updateURL    https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// @downloadURL  https://github.com/Jerry199022/Work-Release/raw/refs/heads/main/IVPReceiver.user.js
// ==/UserScript==

function _0x4fbb(_0x47ef6c,_0x28543f){const _0x5228f8=_0x5228();return _0x4fbb=function(_0x4fbb55,_0x384de1){_0x4fbb55=_0x4fbb55-0x1e7;let _0x4f8ed2=_0x5228f8[_0x4fbb55];if(_0x4fbb['xiWkFt']===undefined){var _0x2a9228=function(_0x36ff7a){const _0x533b17='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x16674c='',_0x958390='';for(let _0x2dcd1d=0x0,_0x91064e,_0x309143,_0x525ef8=0x0;_0x309143=_0x36ff7a['charAt'](_0x525ef8++);~_0x309143&&(_0x91064e=_0x2dcd1d%0x4?_0x91064e*0x40+_0x309143:_0x309143,_0x2dcd1d++%0x4)?_0x16674c+=String['fromCharCode'](0xff&_0x91064e>>(-0x2*_0x2dcd1d&0x6)):0x0){_0x309143=_0x533b17['indexOf'](_0x309143);}for(let _0x2ac12a=0x0,_0x49b1f1=_0x16674c['length'];_0x2ac12a<_0x49b1f1;_0x2ac12a++){_0x958390+='%'+('00'+_0x16674c['charCodeAt'](_0x2ac12a)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x958390);};_0x4fbb['UTqCRQ']=_0x2a9228,_0x47ef6c=arguments,_0x4fbb['xiWkFt']=!![];}const _0x1c2fee=_0x5228f8[0x0],_0x2357bf=_0x4fbb55+_0x1c2fee,_0x278fa2=_0x47ef6c[_0x2357bf];return!_0x278fa2?(_0x4f8ed2=_0x4fbb['UTqCRQ'](_0x4f8ed2),_0x47ef6c[_0x2357bf]=_0x4f8ed2):_0x4f8ed2=_0x278fa2,_0x4f8ed2;},_0x4fbb(_0x47ef6c,_0x28543f);}function _0x5228(){const _0x17ec9b=['yNrUswq','ChjVDg90ExbL','A2v5Dxa','zM9JDxm','zgLZCgf0y2HfDMvUDa','AgLKzgvU','zgf0yq','m3fJExPiBG','A2v5ChjLC3m','Ahr0Chm6lY91ChnKCML2zs5SAwDODg5PBMCUzM9Yy2uUy29T','z2v0rwXLBwvUDej5swq','DMfSDwu','i3rVz2DSzs12AxnPyMLSAxr5id4GyNv0Dg9U','w1vUAxzLCNnHBcbszwnLAxzLCIbwmJfDiowvN+wlLEAwVdOG','yxbWBgLJyxrPB24VAMf2yxnJCMLWDa','Dg9mB3DLCKnHC2u','y3jLyxrLt2jQzwn0vvjm','Dgv4DenVBNrLBNq','C3rbChbFyNrUvhjHy2S','mJe0ndrjEKTwu08','CxvLCNLtzwXLy3rVCG','mte3oteWne5LCM5AAa','icHiAwrKzw46ia','CMvTB3zL','iIdOTOxMMyi','zgLZy29UBMvJDa','AdyUAdz0CMfJA2LUzYbZCgfU','Aw5WDxrjza','mJG3ndbsuevjA1u','mtyXodbIALvrzxm','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLTHCMLHlwXHyMvSpsjdBgvHCIjD','mJm3odG0ouXwtuLYBq','mtC4mMzHEeL2Eq','Bg9JyxrPB24','zMLUza','Aw5WDxrBAwq9iKvUDgvYifrYywnRAw5Nie51BwjLCIjD','twfPBIbuCMfJAYaOq2vUDgvYkq','yxjPys1KAxnHyMXLza','y2fSBa','zM9YrwfJAa','w0Lwuf0G5z+36kgm5P+L6kMIoIa','CxvLCNLtzwXLy3rVCKfSBa','zMfSC2u','B25TzxnZywDL','mZy0mNDyv01Wra','C3rbChbFDhjHy2TPBMDoDw1Izxi','C3rbChbFDhjHy2Tbz2fPBL90CMfJA2LUz051BuvUDhj5','yNv0Dg9UlMnSB3nLw2rHDgeTzgLZBwLZCZ0IBw9KywWIxq','mty1mJG2uNzIu3LM','w1vquYbxzwjDiowyL+IPPUw8T+wiTUM7NUAtII4UlG','mNb4ihnVBgLKihjLza','yMX1CG','B3jPz2LU','y2XPy2S','lcaJ','Bg9N','w0Lwuf0G5z+36kgm5yE66yYVoG','CMvTB3zLqxr0CMLIDxrL','nZqXDM1QExDA','CMvWBgfJzq','C3r5Bgu','DhLWzq','Aw5WDxq','y2XHC3nmAxn0','zgL2lMfJDgLVBI1IDxr0B25Zigj1DhrVBLT0ExbLpsjZDwjTAxqIxq','ndqWmfDnvhjmvG','ywrKrxzLBNrmAxn0zw5LCG','yM9KEq','DxbZlMnVBq','uhjVy2vZCW','w1jLy2vPDMvYxsdPOihPNAlLT7lPOA/NPlROMz/NORWG','A2v5zg93BG','n3PbuKTUDG','C2v0qxr0CMLIDxrL','zxjYB3i','y2HHBMDL','AxzWlMLUC2LKzs51ChmUy29T','zgLZywjSzwq','i3n0x0fWCf9wAwv3x0rLDgfPBhm','sfrnteLUChv0rwXLBwvUDa','zgL2lMnKAY1VDMvYBgf5lxbHBMuGBgK6AgfZkgvTlMzHlxrPBwvZkq','77Ym6lEZ6ygo5P+L6kMI44cc','ngrfr1bqBW','Ag9ZDg5HBwu','yM9YzgvY'];_0x5228=function(){return _0x17ec9b;};return _0x5228();}(function(_0x1ee1a1,_0x5426c6){const _0x1470fa={_0xc919ac:0x21f,_0x5dc77f:0x1f9,_0x13f9b4:0x1ea,_0x3fcca5:0x207},_0x440be9=_0x4fbb,_0x2c3c13=_0x1ee1a1();while(!![]){try{const _0x44c5ca=parseInt(_0x440be9(0x1fd))/0x1*(parseInt(_0x440be9(_0x1470fa._0xc919ac))/0x2)+-parseInt(_0x440be9(0x229))/0x3*(-parseInt(_0x440be9(0x1e9))/0x4)+-parseInt(_0x440be9(0x20e))/0x5*(-parseInt(_0x440be9(_0x1470fa._0x5dc77f))/0x6)+parseInt(_0x440be9(0x215))/0x7*(-parseInt(_0x440be9(0x237))/0x8)+-parseInt(_0x440be9(0x1ed))/0x9*(parseInt(_0x440be9(_0x1470fa._0x13f9b4))/0xa)+-parseInt(_0x440be9(0x1ec))/0xb+-parseInt(_0x440be9(0x235))/0xc*(-parseInt(_0x440be9(_0x1470fa._0x3fcca5))/0xd);if(_0x44c5ca===_0x5426c6)break;else _0x2c3c13['push'](_0x2c3c13['shift']());}catch(_0x532be9){_0x2c3c13['push'](_0x2c3c13['shift']());}}}(_0x5228,0x46be5),(function(){'use strict';const _0x137daa={_0x9a7d48:0x1ee,_0x108007:0x219,_0x71db96:0x204,_0x561e45:0x22f},_0x32b2c5={_0x365419:0x213,_0x347e84:0x21e,_0x453221:0x201},_0x5e8576={_0x3bac77:0x238,_0x31eb87:0x227,_0x39ed47:0x22e,_0x54476a:0x1eb,_0x2d0867:0x1f0,_0x9d8009:0x20d,_0x86782e:0x21a,_0x22874e:0x205},_0x1df649={_0x1debf1:0x204,_0x54cdd9:0x238,_0x2884aa:0x227,_0x23f70c:0x1fa,_0x929231:0x1fc,_0x585b53:0x22c,_0x1989ee:0x1e8,_0x38d6b7:0x1e8,_0x2853ee:0x1ef,_0x3b1067:0x222,_0x5418ef:0x21b},_0x2820ab={_0x4b0ab2:0x22c},_0x48c84f={_0x4f628a:0x232,_0x28a30d:0x1f8},_0x3b38e2={_0x5b0cd4:0x239,_0x17ce3d:0x1f2,_0x2e04f3:0x1f7,_0x1becc2:0x209,_0x25ed33:0x221,_0x2f7295:0x1ff},_0x134486={_0x18f460:0x21c,_0x352c1a:0x22d,_0x433b86:0x22d,_0x598999:0x226,_0x2860a2:0x218,_0x2ac4fc:0x224},_0xc83554=_0x4fbb;const _0x36ff7a=window[_0xc83554(_0x137daa._0x9a7d48)][_0xc83554(0x220)],_0x533b17=_0x36ff7a['includes'](_0xc83554(_0x137daa._0x108007)),_0x16674c=_0x36ff7a['includes'](_0xc83554(0x211)),_0x958390=_0xc83554(0x22b);console[_0xc83554(_0x137daa._0x71db96)](_0xc83554(_0x137daa._0x561e45)+_0x36ff7a+'\x20(強制解鎖模式)');let _0x2dcd1d=0x0;const _0x91064e=_0x5a465f=>new Promise(_0x1f243c=>setTimeout(_0x1f243c,_0x5a465f));function _0x309143(_0x496573,_0x3b8d8f=document[_0xc83554(0x210)],_0xd270cd=0x1388){const _0xafbb9c={_0x40a850:0x236};return new Promise((_0x5abd90,_0x366d47)=>{const _0x48db6f={_0x13789d:0x23b},_0x46cc81=_0x4fbb,_0x474b8a=_0x3b8d8f[_0x46cc81(_0xafbb9c._0x40a850)](_0x496573);if(_0x474b8a)return _0x5abd90(_0x474b8a);const _0x3507e4=new MutationObserver(()=>{const _0x537727=_0x46cc81,_0x59cf08=_0x3b8d8f[_0x537727(0x236)](_0x496573);_0x59cf08&&(_0x3507e4[_0x537727(0x23b)](),_0x5abd90(_0x59cf08));});_0x3507e4['observe'](_0x3b8d8f,{'childList':!![],'subtree':!![]}),setTimeout(()=>{const _0x2f493b=_0x46cc81;_0x3507e4[_0x2f493b(_0x48db6f._0x13789d)](),_0x366d47(new Error('等待元素\x20\x22'+_0x496573+_0x2f493b(0x23a)));},_0xd270cd);});}function _0x525ef8(_0x38c980,_0x1dd441){const _0x54c86b=_0xc83554;if(!_0x38c980)return;const _0xb167cc=document['hidden'];if(!_0xb167cc)try{_0x38c980[_0x54c86b(0x225)]();}catch(_0x392115){}try{const _0x8c9a2e=Object['getOwnPropertyDescriptor'](window[_0x54c86b(_0x134486._0x18f460)][_0x54c86b(0x223)],'value')['set'];_0x8c9a2e[_0x54c86b(0x1f3)](_0x38c980,_0x1dd441);}catch(_0x7deb2){_0x38c980['value']=_0x1dd441;}if(_0x38c980[_0x54c86b(_0x134486._0x352c1a)]!==_0x1dd441)_0x38c980[_0x54c86b(_0x134486._0x433b86)]=_0x1dd441;if(_0xb167cc)_0x38c980[_0x54c86b(0x226)](new Event(_0x54c86b(0x20b),{'bubbles':!![]})),_0x38c980[_0x54c86b(_0x134486._0x598999)](new Event('change',{'bubbles':!![]})),_0x38c980[_0x54c86b(0x226)](new Event(_0x54c86b(0x200),{'bubbles':!![]}));else{const _0x5a900d=[new KeyboardEvent(_0x54c86b(0x214),{'bubbles':!![],'key':_0x54c86b(0x212)}),new KeyboardEvent(_0x54c86b(0x22a),{'bubbles':!![],'key':_0x54c86b(0x212)}),new Event('input',{'bubbles':!![]}),new Event(_0x54c86b(_0x134486._0x2860a2),{'bubbles':!![]}),new KeyboardEvent(_0x54c86b(_0x134486._0x2ac4fc),{'bubbles':!![],'key':'Process'}),new Event('blur',{'bubbles':!![]})];_0x5a900d[_0x54c86b(0x1f4)](_0x391d73=>_0x38c980[_0x54c86b(0x226)](_0x391d73));}}function _0x2ac12a(_0x5274ef){const _0x2b5a8a=_0xc83554;if(!_0x5274ef)return;_0x5274ef[_0x2b5a8a(0x206)](_0x2b5a8a(0x21a)),_0x5274ef[_0x2b5a8a(0x20c)][_0x2b5a8a(_0x3b38e2._0x5b0cd4)](_0x2b5a8a(0x21a)),_0x5274ef[_0x2b5a8a(0x216)](_0x2b5a8a(_0x3b38e2._0x17ce3d),_0x2b5a8a(_0x3b38e2._0x2e04f3)),_0x5274ef[_0x2b5a8a(_0x3b38e2._0x1becc2)][_0x2b5a8a(_0x3b38e2._0x25ed33)]=_0x2b5a8a(_0x3b38e2._0x2f7295),_0x5274ef['click']();}function _0x49b1f1(){const _0x5ef913=_0xc83554;try{const _0x2497b5=new Blob(['setInterval(()\x20=>\x20self.postMessage(\x27tick\x27),\x20250);'],{'type':_0x5ef913(0x230)}),_0x123a5f=new Worker(URL[_0x5ef913(_0x48c84f._0x4f628a)](_0x2497b5));_0x123a5f[_0x5ef913(_0x48c84f._0x28a30d)]=()=>{};}catch(_0x5f2d66){console['error']('[KeepAlive]\x20Error:',_0x5f2d66);}}function _0x1ea146(_0x5c2aed){const _0x1f735b=_0xc83554;if(!_0x5c2aed)return![];let _0x592ebf=null;if(_0x533b17)_0x592ebf=document['querySelector'](_0x1f735b(0x1e7));else{if(_0x16674c)_0x592ebf=document[_0x1f735b(_0x2820ab._0x4b0ab2)]('stApp_trackingNumber');}if(_0x592ebf){const _0xc01f7b=_0x592ebf[_0x1f735b(0x233)]['trim']()[_0x1f735b(0x208)](/\s/g,''),_0x3c7c4f=_0x5c2aed['replace'](/\s/g,'');if(_0xc01f7b['toLowerCase']()===_0x3c7c4f[_0x1f735b(0x231)]())return!![];}return![];}async function _0x373c04(_0x154992){const _0x1325d1=_0xc83554;console[_0x1325d1(_0x1df649._0x1debf1)]('[UPS\x20Web]\x20執行查詢:\x20'+_0x154992+_0x1325d1(_0x1df649._0x54cdd9)+document[_0x1325d1(_0x1df649._0x2884aa)]+')');const _0x45703c=[{'name':'Track\x20Again\x20(Top)','inputId':_0x1325d1(0x1fb),'btnId':'stApp_trackAgain_getTrack'},{'name':_0x1325d1(0x1f1),'inputId':_0x1325d1(_0x1df649._0x23f70c),'btnId':_0x1325d1(0x234)}];try{const _0x25ef03=document['querySelector'](_0x1325d1(_0x1df649._0x929231));_0x25ef03&&(_0x25ef03[_0x1325d1(0x202)](),await _0x91064e(0x12c));let _0x8e79d9=document[_0x1325d1(_0x1df649._0x585b53)](_0x45703c[0x0][_0x1325d1(_0x1df649._0x1989ee)])||document['getElementById'](_0x45703c[0x1]['inputId']);if(!_0x8e79d9)try{const _0x270106='#'+_0x45703c[0x0][_0x1325d1(_0x1df649._0x38d6b7)]+_0x1325d1(0x203)+_0x45703c[0x1][_0x1325d1(_0x1df649._0x38d6b7)];_0x8e79d9=await _0x309143(_0x270106,document['body'],0xbb8);}catch(_0x214b9c){return;}const _0x3111a3=_0x45703c[_0x1325d1(_0x1df649._0x2853ee)](_0x3cf454=>_0x3cf454['inputId']===_0x8e79d9['id']);if(!_0x3111a3)return;_0x525ef8(_0x8e79d9,_0x154992),await _0x91064e(0x1f4);let _0x5aa165=document['getElementById'](_0x3111a3[_0x1325d1(0x222)]);if(!_0x5aa165)try{_0x5aa165=await _0x309143('#'+_0x3111a3[_0x1325d1(_0x1df649._0x3b1067)],document['body'],0x7d0);}catch(_0x33d0ea){}if(_0x5aa165){console[_0x1325d1(0x204)](_0x1325d1(0x1fe)),_0x2ac12a(_0x5aa165),await _0x91064e(0x1f4),_0x2ac12a(_0x5aa165);try{const _0x5274e3=await _0x309143(_0x1325d1(_0x1df649._0x5418ef),document['body'],0x1f40);_0x5274e3&&(await _0x91064e(0xc8),_0x5274e3['click']());}catch(_0x30b7c1){}}}catch(_0x2826c5){console['error']('[UPS\x20Web]\x20執行出錯:',_0x2826c5);}}async function _0x197992(_0x198224){const _0x45ac71=_0xc83554;console['log'](_0x45ac71(0x1f5)+_0x198224+_0x45ac71(_0x5e8576._0x3bac77)+document[_0x45ac71(_0x5e8576._0x31eb87)]+')');const _0x3e4faf=document[_0x45ac71(0x1f6)](_0x45ac71(0x21d));for(const _0x19f37b of _0x3e4faf){_0x19f37b['click'](),await _0x91064e(0x64);}try{const _0x335a64=document['querySelector']('#mainContainer\x20>\x20app-tracking\x20>\x20div\x20>\x20div\x20>\x20div.container-fluid.d-none');if(_0x335a64){const _0x56565b=document[_0x45ac71(0x236)](_0x45ac71(_0x5e8576._0x39ed47));if(_0x56565b)_0x56565b[_0x45ac71(0x202)]();await _0x91064e(0x12c);}const _0x36d152=document[_0x45ac71(0x236)](_0x45ac71(_0x5e8576._0x54476a));_0x36d152&&(_0x36d152['click'](),await _0x91064e(0x12c));const _0x57f617=await _0x309143(_0x45ac71(_0x5e8576._0x2d0867));_0x525ef8(_0x57f617,_0x198224);const _0x35a98a=await _0x309143(_0x45ac71(_0x5e8576._0x9d8009));let _0x5d0120=0x0;while(_0x35a98a[_0x45ac71(_0x5e8576._0x86782e)]&&_0x5d0120<0x5){await _0x91064e(0xc8),_0x5d0120++;if(_0x5d0120%0x2===0x0)_0x525ef8(_0x57f617,_0x198224);}_0x2ac12a(_0x35a98a);}catch(_0x10ad31){console[_0x45ac71(0x217)](_0x45ac71(_0x5e8576._0x22874e),_0x10ad31);}}window[_0xc83554(0x20f)]('message',async function(_0x55cf58){const _0xed52ba=_0xc83554;if(_0x55cf58['origin']!==_0x958390)return;const _0x350562=_0x55cf58[_0xed52ba(0x228)];if(_0x350562?.[_0xed52ba(0x20a)]==='CEC_SEARCH_REQUEST'&&_0x350562['payload']){const {trackingNumber:_0x2250fe,timestamp:_0x5ed113}=_0x350562['payload'];if(_0x5ed113>_0x2dcd1d){const _0x2b860b=_0x1ea146(_0x2250fe);if(_0x2b860b)console[_0xed52ba(0x204)](_0xed52ba(_0x32b2c5._0x365419)+_0x2250fe+_0xed52ba(_0x32b2c5._0x347e84));else{if(_0x533b17)await _0x197992(_0x2250fe);else{if(_0x16674c)await _0x373c04(_0x2250fe);}}_0x2dcd1d=_0x5ed113,_0x55cf58['source']&&_0x55cf58['source']['postMessage']({'type':'CEC_REQUEST_RECEIVED','payload':{'timestamp':_0x5ed113}},_0x55cf58[_0xed52ba(_0x32b2c5._0x453221)]);}}},![]),_0x49b1f1();}()));